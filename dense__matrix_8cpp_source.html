<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SymEngine C++ API: /home/runner/work/symengine/symengine/symengine/dense_matrix.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
  loader: { load: ["[tex]/unicode", "[tex]/ams"] },
  tex: {
    packages: { "[+]": ["unicode", "ams"] },
    tags: "ams",
  },
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<!-- <link href="doxygen.css" rel="stylesheet" type="text/css" /> -->
<link href="doxyYoda.min.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" >
$(document).ready(function() {
     $(".fragment").wrap("<details class='code-details'></details>");
     $(".code-details").append("<summary>Code</summary>");
 }
)
</script>
</head>
<body>
<div class="grid-contents">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<nav class="title_area">
<span class="project_info">SymEngine C++ API </span>
</nav>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5f3c0b4b33d21f966cb3219df2063971.html">symengine</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">dense_matrix.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;symengine/matrix.h&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="number_8h.html">symengine/number.h</a>&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="add_8h.html">symengine/add.h</a>&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="functions_8h.html">symengine/functions.h</a>&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="pow_8h.html">symengine/pow.h</a>&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;symengine/subs.h&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;symengine/symengine_exception.h&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;symengine/polys/uexprpoly.h&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="solve_8h.html">symengine/solve.h</a>&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;symengine/test_visitors.h&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#if HAVE_SYMENGINE_RTTI</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;symengine/serialize-cereal.h&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceSymEngine.html">SymEngine</a></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;{</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// Constructors</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;DenseMatrix::DenseMatrix() {}</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;DenseMatrix::DenseMatrix(<span class="keywordtype">unsigned</span> row, <span class="keywordtype">unsigned</span> col) : row_(row), col_(col)</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;{</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    m_ = <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;RCP&lt;const Basic&gt;</a>&gt;(row * col);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;}</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;DenseMatrix::DenseMatrix(<span class="keywordtype">unsigned</span> row, <span class="keywordtype">unsigned</span> col, <span class="keyword">const</span> vec_basic &amp;l)</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    : m_{l}, row_(row), col_(col){SYMENGINE_ASSERT(m_.size() == row * col)}</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;      DenseMatrix::DenseMatrix(<span class="keyword">const</span> vec_basic &amp;column_elements)</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    : m_(column_elements), row_(static_cast&lt;unsigned&gt;(column_elements.size())),</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;      col_(1)</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;{</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;}</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">// Resize the Matrix</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keywordtype">void</span> DenseMatrix::resize(<span class="keywordtype">unsigned</span> row, <span class="keywordtype">unsigned</span> col)</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;{</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    row_ = row;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    col_ = col;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    m_.resize(row * col);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;}</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">// Get and set elements</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;RCP&lt;const Basic&gt; DenseMatrix::get(<span class="keywordtype">unsigned</span> i, <span class="keywordtype">unsigned</span> j)<span class="keyword"> const</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    SYMENGINE_ASSERT(i &lt; row_ and j &lt; col_);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">return</span> m_[i * col_ + j];</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keywordtype">void</span> DenseMatrix::set(<span class="keywordtype">unsigned</span> i, <span class="keywordtype">unsigned</span> j, <span class="keyword">const</span> RCP&lt;const Basic&gt; &amp;e)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    SYMENGINE_ASSERT(i &lt; row_ and j &lt; col_);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    m_[i * col_ + j] = e;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">// Flat (row major) view of Matrix</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;vec_basic DenseMatrix::as_vec_basic()<span class="keyword"> const</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">return</span> m_;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;}</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;RCP&lt;const Basic&gt; DenseMatrix::trace()<span class="keyword"> const</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    SYMENGINE_ASSERT(row_ == col_);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordtype">unsigned</span> offset = 0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    vec_basic diag;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; row_; i++) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        diag.push_back(m_[offset]);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        offset += row_ + 1;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    }</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">auto</span> sum = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(diag);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">return</span> sum;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;}</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="keywordtype">unsigned</span> DenseMatrix::rank()<span class="keyword"> const</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">throw</span> NotImplementedError(<span class="stringliteral">&quot;Not Implemented&quot;</span>);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;}</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="keywordtype">bool</span> DenseMatrix::is_lower()<span class="keyword"> const</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keyword">auto</span> A = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">unsigned</span> n = A.nrows();</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 1; i &lt; n; ++i) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; i; ++j) {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <span class="keywordflow">if</span> (not <a class="code" href="namespaceSymEngine.html#a1998df939d1b28e0356a43f33433d9d3">is_number_and_zero</a>(*A.get(i, j))) {</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        }</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="keywordtype">bool</span> DenseMatrix::is_upper()<span class="keyword"> const</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keyword">auto</span> A = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordtype">unsigned</span> n = A.nrows();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; n - 1; ++i) {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = i + 1; j &lt; n; ++j) {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;            <span class="keywordflow">if</span> (not <a class="code" href="namespaceSymEngine.html#a1998df939d1b28e0356a43f33433d9d3">is_number_and_zero</a>(*A.get(i, j))) {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;tribool <a class="code" href="namespaceSymEngine.html#ab930e860c8b1ff6cd03daff9c60c819a">DenseMatrix::is_zero</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keyword">auto</span> A = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    tribool cur = tribool::tritrue;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;e : m_) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        cur = and_tribool(cur, SymEngine::is_zero(*e));</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <span class="keywordflow">if</span> (is_false(cur)) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <span class="keywordflow">return</span> cur;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">return</span> cur;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;}</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;tribool DenseMatrix::is_diagonal()<span class="keyword"> const</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keyword">auto</span> A = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">if</span> (not A.is_square()) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">return</span> tribool::trifalse;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordtype">unsigned</span> ncols = A.ncols();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordtype">unsigned</span> offset;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    tribool cur = tribool::tritrue;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; ncols; i++) {</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        offset = i * ncols;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; ncols; j++) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            <span class="keywordflow">if</span> (j != i) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <span class="keyword">auto</span> &amp;e = m_[offset];</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                cur = and_tribool(cur, SymEngine::is_zero(*e));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <span class="keywordflow">if</span> (is_false(cur)) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                    <span class="keywordflow">return</span> cur;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            offset++;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">return</span> cur;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;}</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;tribool DenseMatrix::is_real(<span class="keyword">const</span> Assumptions *assumptions)<span class="keyword"> const</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    RealVisitor visitor(assumptions);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    tribool cur = tribool::tritrue;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;e : m_) {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        cur = and_tribool(cur, visitor.apply(*e));</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">if</span> (is_false(cur)) {</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            <span class="keywordflow">return</span> cur;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">return</span> cur;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;tribool DenseMatrix::is_symmetric()<span class="keyword"> const</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keyword">auto</span> A = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span> (not A.is_square()) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">return</span> tribool::trifalse;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordtype">unsigned</span> ncols = A.ncols();</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    tribool cur = tribool::tritrue;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; ncols; i++) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt;= i; j++) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordflow">if</span> (j != i) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                <span class="keyword">auto</span> &amp;e = m_[i * ncols + j];</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <span class="keyword">auto</span> &amp;e2 = m_[j * ncols + i];</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                cur = and_tribool(cur, SymEngine::is_zero(*<a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(e, e2)));</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="keywordflow">if</span> (is_false(cur)) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                <span class="keywordflow">return</span> cur;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">return</span> cur;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;}</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;tribool DenseMatrix::is_hermitian()<span class="keyword"> const</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">auto</span> A = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (not A.is_square()) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keywordflow">return</span> tribool::trifalse;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordtype">unsigned</span> ncols = A.ncols();</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    tribool cur = tribool::tritrue;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; ncols; i++) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt;= i; j++) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keyword">auto</span> &amp;e = m_[i * ncols + j];</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="keywordflow">if</span> (j != i) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                <span class="keyword">auto</span> &amp;e2 = m_[j * ncols + i];</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                cur = and_tribool(</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                    cur, SymEngine::is_zero(*<a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(e, <a class="code" href="namespaceSymEngine.html#af02f97d82354b66c939ae206f0057edd">SymEngine::conjugate</a>(e2))));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                cur = and_tribool(cur, SymEngine::is_real(*e));</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            <span class="keywordflow">if</span> (is_false(cur)) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                <span class="keywordflow">return</span> cur;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">return</span> cur;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;tribool DenseMatrix::is_weakly_diagonally_dominant()<span class="keyword"> const</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keyword">auto</span> A = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span> (not A.is_square()) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">return</span> tribool::trifalse;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordtype">unsigned</span> ncols = A.ncols();</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    RCP&lt;const Basic&gt; diag;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    RCP&lt;const Basic&gt; sum;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    tribool diagdom = tribool::tritrue;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; ncols; i++) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        sum = zero;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; ncols; j++) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <span class="keyword">auto</span> &amp;e = m_[i * ncols + j];</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keywordflow">if</span> (i == j) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                diag = <a class="code" href="namespaceSymEngine.html#a3deecb23288ff261b9534dbe7291cf7b">abs</a>(e);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                sum = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(sum, <a class="code" href="namespaceSymEngine.html#a3deecb23288ff261b9534dbe7291cf7b">abs</a>(e));</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        diagdom = and_tribool(diagdom, is_nonnegative(*<a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(diag, sum)));</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">if</span> (is_false(diagdom)) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="keywordflow">return</span> diagdom;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">return</span> diagdom;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;tribool DenseMatrix::is_strictly_diagonally_dominant()<span class="keyword"> const</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keyword">auto</span> A = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span> (not A.is_square()) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">return</span> tribool::trifalse;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="keywordtype">unsigned</span> ncols = A.ncols();</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    RCP&lt;const Basic&gt; diag;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    RCP&lt;const Basic&gt; sum;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    tribool diagdom = tribool::tritrue;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; ncols; i++) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        sum = zero;</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; ncols; j++) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="keyword">auto</span> &amp;e = m_[i * ncols + j];</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="keywordflow">if</span> (i == j) {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                diag = <a class="code" href="namespaceSymEngine.html#a3deecb23288ff261b9534dbe7291cf7b">abs</a>(e);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                sum = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(sum, <a class="code" href="namespaceSymEngine.html#a3deecb23288ff261b9534dbe7291cf7b">abs</a>(e));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        }</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        diagdom = and_tribool(diagdom, is_positive(*<a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(diag, sum)));</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">if</span> (is_false(diagdom)) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="keywordflow">return</span> diagdom;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keywordflow">return</span> diagdom;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;tribool DenseMatrix::shortcut_to_posdef()<span class="keyword"> const</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    tribool is_diagonal_positive = tribool::tritrue;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordtype">unsigned</span> offset = 0;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; row_; i++) {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        is_diagonal_positive</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            = and_tribool(is_diagonal_positive, is_positive(*m_[offset]));</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">if</span> (is_false(is_diagonal_positive))</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">return</span> is_diagonal_positive;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        offset += row_ + 1;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keywordflow">if</span> (is_true(and_tribool(is_diagonal_positive,</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                            this-&gt;is_strictly_diagonally_dominant())))</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">return</span> tribool::tritrue;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">return</span> tribool::indeterminate;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;tribool DenseMatrix::is_positive_definite_GE()</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;{</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keyword">auto</span> size = row_;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; size; i++) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keyword">auto</span> ispos = is_positive(*m_[i * size + i]);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">if</span> (!is_true(ispos))</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keywordflow">return</span> ispos;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = i + 1; j &lt; size; j++) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = i + 1; k &lt; size; k++) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                m_[j * size + k] = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(m_[i * size + i], m_[j * size + k]),</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                       <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(m_[j * size + i], m_[i * size + k]));</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">return</span> tribool::tritrue;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;}</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;tribool DenseMatrix::is_positive_definite()<span class="keyword"> const</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keyword">auto</span> A = *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/memory/unique_ptr.html">std::unique_ptr&lt;DenseMatrix&gt;</a> B;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keyword">const</span> DenseMatrix *H;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">if</span> (!is_true(A.is_hermitian())) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">if</span> (!A.is_square())</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            <span class="keywordflow">return</span> tribool::trifalse;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        DenseMatrix tmp1 = DenseMatrix(A.row_, A.col_);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        B = <a class="codeRef" href="http://en.cppreference.com/w/cpp/memory/unique_ptr.html">std::unique_ptr&lt;DenseMatrix&gt;</a>(<span class="keyword">new</span> DenseMatrix(A.row_, A.col_));</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        A.conjugate_transpose(tmp1);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        add_dense_dense(A, tmp1, *B.<a class="codeRef" href="http://en.cppreference.com/w/cpp/memory/unique_ptr/get.html">get</a>());</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        H = B.<a class="codeRef" href="http://en.cppreference.com/w/cpp/memory/unique_ptr/get.html">get</a>();</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        H = <span class="keyword">this</span>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    }</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    tribool shortcut = H-&gt;shortcut_to_posdef();</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">if</span> (!is_indeterminate(shortcut))</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordflow">return</span> shortcut;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordflow">if</span> (!B) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        B = <a class="codeRef" href="http://en.cppreference.com/w/cpp/memory/unique_ptr.html">std::unique_ptr&lt;DenseMatrix&gt;</a>(<span class="keyword">new</span> DenseMatrix(A));</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">return</span> B-&gt;is_positive_definite_GE();</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;}</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;tribool DenseMatrix::is_negative_definite()<span class="keyword"> const</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keyword">auto</span> res = DenseMatrix(row_, col_);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    mul_dense_scalar(*<span class="keyword">this</span>, <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(-1), res);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">return</span> res.is_positive_definite();</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;}</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;RCP&lt;const Basic&gt; DenseMatrix::det()<span class="keyword"> const</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">return</span> det_bareis(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;}</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="keywordtype">void</span> DenseMatrix::inv(MatrixBase &amp;result)<span class="keyword"> const</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(result)) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        DenseMatrix &amp;r = down_cast&lt;DenseMatrix &amp;&gt;(result);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        inverse_pivoted_LU(*<span class="keyword">this</span>, r);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="keywordtype">void</span> DenseMatrix::add_matrix(<span class="keyword">const</span> MatrixBase &amp;other, MatrixBase &amp;result)<span class="keyword"> const</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    SYMENGINE_ASSERT(row_ == result.nrows() and col_ == result.ncols());</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(other) and is_a&lt;DenseMatrix&gt;(result)) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keyword">const</span> DenseMatrix &amp;o = down_cast&lt;const DenseMatrix &amp;&gt;(other);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        DenseMatrix &amp;r = down_cast&lt;DenseMatrix &amp;&gt;(result);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        add_dense_dense(*<span class="keyword">this</span>, o, r);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    }</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;}</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keywordtype">void</span> DenseMatrix::mul_matrix(<span class="keyword">const</span> MatrixBase &amp;other, MatrixBase &amp;result)<span class="keyword"> const</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    SYMENGINE_ASSERT(row_ == result.nrows()</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                     and other.ncols() == result.ncols());</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(other) and is_a&lt;DenseMatrix&gt;(result)) {</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keyword">const</span> DenseMatrix &amp;o = down_cast&lt;const DenseMatrix &amp;&gt;(other);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        DenseMatrix &amp;r = down_cast&lt;DenseMatrix &amp;&gt;(result);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        mul_dense_dense(*<span class="keyword">this</span>, o, r);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    }</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;}</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keywordtype">void</span> DenseMatrix::elementwise_mul_matrix(<span class="keyword">const</span> MatrixBase &amp;other,</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                         MatrixBase &amp;result)<span class="keyword"> const</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    SYMENGINE_ASSERT(row_ == result.nrows() and col_ == result.ncols()</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                     and row_ == other.nrows() and col_ == other.ncols());</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(other) and is_a&lt;DenseMatrix&gt;(result)) {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keyword">const</span> DenseMatrix &amp;o = down_cast&lt;const DenseMatrix &amp;&gt;(other);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        DenseMatrix &amp;r = down_cast&lt;DenseMatrix &amp;&gt;(result);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        elementwise_mul_dense_dense(*<span class="keyword">this</span>, o, r);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">// Add a scalar</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="keywordtype">void</span> DenseMatrix::add_scalar(<span class="keyword">const</span> RCP&lt;const Basic&gt; &amp;k,</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                             MatrixBase &amp;result)<span class="keyword"> const</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(result)) {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        DenseMatrix &amp;r = down_cast&lt;DenseMatrix &amp;&gt;(result);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        add_dense_scalar(*<span class="keyword">this</span>, k, r);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;}</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">// Multiply by a scalar</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keywordtype">void</span> DenseMatrix::mul_scalar(<span class="keyword">const</span> RCP&lt;const Basic&gt; &amp;k,</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                             MatrixBase &amp;result)<span class="keyword"> const</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(result)) {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        DenseMatrix &amp;r = down_cast&lt;DenseMatrix &amp;&gt;(result);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        mul_dense_scalar(*<span class="keyword">this</span>, k, r);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    }</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;}</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">// Matrix conjugate</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="keywordtype">void</span> DenseMatrix::conjugate(MatrixBase &amp;result)<span class="keyword"> const</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(result)) {</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        DenseMatrix &amp;r = down_cast&lt;DenseMatrix &amp;&gt;(result);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        conjugate_dense(*<span class="keyword">this</span>, r);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;}</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">// Matrix transpose</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="keywordtype">void</span> DenseMatrix::transpose(MatrixBase &amp;result)<span class="keyword"> const</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(result)) {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        DenseMatrix &amp;r = down_cast&lt;DenseMatrix &amp;&gt;(result);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        transpose_dense(*<span class="keyword">this</span>, r);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;}</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">// Matrix conjugate transpose</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="keywordtype">void</span> DenseMatrix::conjugate_transpose(MatrixBase &amp;result)<span class="keyword"> const</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(result)) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        DenseMatrix &amp;r = down_cast&lt;DenseMatrix &amp;&gt;(result);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        conjugate_transpose_dense(*<span class="keyword">this</span>, r);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;}</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">// Extract out a submatrix</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="keywordtype">void</span> DenseMatrix::submatrix(MatrixBase &amp;result, <span class="keywordtype">unsigned</span> row_start,</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                            <span class="keywordtype">unsigned</span> col_start, <span class="keywordtype">unsigned</span> row_end,</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                            <span class="keywordtype">unsigned</span> col_end, <span class="keywordtype">unsigned</span> row_step,</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                            <span class="keywordtype">unsigned</span> col_step)<span class="keyword"> const</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(result)) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        DenseMatrix &amp;r = down_cast&lt;DenseMatrix &amp;&gt;(result);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        submatrix_dense(*<span class="keyword">this</span>, r, row_start, col_start, row_end, col_end,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                        row_step, col_step);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;}</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">// LU factorization</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="keywordtype">void</span> DenseMatrix::LU(MatrixBase &amp;L, MatrixBase &amp;U)<span class="keyword"> const</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(L) and is_a&lt;DenseMatrix&gt;(U)) {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        DenseMatrix &amp;L_ = down_cast&lt;DenseMatrix &amp;&gt;(L);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        DenseMatrix &amp;U_ = down_cast&lt;DenseMatrix &amp;&gt;(U);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        SymEngine::LU(*<span class="keyword">this</span>, L_, U_);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;}</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">// LDL factorization</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="keywordtype">void</span> DenseMatrix::LDL(MatrixBase &amp;L, MatrixBase &amp;D)<span class="keyword"> const</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(L) and is_a&lt;DenseMatrix&gt;(D)) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        DenseMatrix &amp;L_ = down_cast&lt;DenseMatrix &amp;&gt;(L);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        DenseMatrix &amp;D_ = down_cast&lt;DenseMatrix &amp;&gt;(D);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        SymEngine::LDL(*<span class="keyword">this</span>, L_, D_);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    }</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;}</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">// Solve Ax = b using LU factorization</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="keywordtype">void</span> DenseMatrix::LU_solve(<span class="keyword">const</span> MatrixBase &amp;b, MatrixBase &amp;x)<span class="keyword"> const</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(b) and is_a&lt;DenseMatrix&gt;(x)) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keyword">const</span> DenseMatrix &amp;b_ = down_cast&lt;const DenseMatrix &amp;&gt;(b);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        DenseMatrix &amp;x_ = down_cast&lt;DenseMatrix &amp;&gt;(x);</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        SymEngine::LU_solve(*<span class="keyword">this</span>, b_, x_);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;}</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160; </div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">// Fraction free LU factorization</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="keywordtype">void</span> DenseMatrix::FFLU(MatrixBase &amp;LU)<span class="keyword"> const</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(LU)) {</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        DenseMatrix &amp;LU_ = down_cast&lt;DenseMatrix &amp;&gt;(LU);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        fraction_free_LU(*<span class="keyword">this</span>, LU_);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;}</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">// Fraction free LDU factorization</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="keywordtype">void</span> DenseMatrix::FFLDU(MatrixBase &amp;L, MatrixBase &amp;D, MatrixBase &amp;U)<span class="keyword"> const</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(L) and is_a&lt;DenseMatrix&gt;(D)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        and is_a&lt;DenseMatrix&gt;(U)) {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        DenseMatrix &amp;L_ = down_cast&lt;DenseMatrix &amp;&gt;(L);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        DenseMatrix &amp;D_ = down_cast&lt;DenseMatrix &amp;&gt;(D);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        DenseMatrix &amp;U_ = down_cast&lt;DenseMatrix &amp;&gt;(U);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        fraction_free_LDU(*<span class="keyword">this</span>, L_, D_, U_);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;}</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">// QR factorization</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="keywordtype">void</span> DenseMatrix::QR(MatrixBase &amp;Q, MatrixBase &amp;R)<span class="keyword"> const</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(Q) and is_a&lt;DenseMatrix&gt;(R)) {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        DenseMatrix &amp;Q_ = down_cast&lt;DenseMatrix &amp;&gt;(Q);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        DenseMatrix &amp;R_ = down_cast&lt;DenseMatrix &amp;&gt;(R);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        SymEngine::QR(*<span class="keyword">this</span>, Q_, R_);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;}</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">// Cholesky decomposition</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="keywordtype">void</span> DenseMatrix::cholesky(MatrixBase &amp;L)<span class="keyword"> const</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;DenseMatrix&gt;(L)) {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        DenseMatrix &amp;L_ = down_cast&lt;DenseMatrix &amp;&gt;(L);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        SymEngine::cholesky(*<span class="keyword">this</span>, L_);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;}</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">// ---------------------------- Jacobian -------------------------------------//</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="keywordtype">void</span> jacobian(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> DenseMatrix &amp;x, DenseMatrix &amp;result,</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;              <span class="keywordtype">bool</span> diff_cache)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;{</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    SYMENGINE_ASSERT(A.col_ == 1);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    SYMENGINE_ASSERT(x.col_ == 1);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    SYMENGINE_ASSERT(A.row_ == result.nrows() and x.row_ == result.ncols());</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="keywordtype">bool</span> error = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; result.row_; i++) {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; result.col_; j++) {</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="keywordflow">if</span> (is_a&lt;Symbol&gt;(*(x.m_[j]))) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                <span class="keyword">const</span> RCP&lt;const Symbol&gt; x_</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                    = rcp_static_cast&lt;const Symbol&gt;(x.m_[j]);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                result.m_[i * result.col_ + j] = A.m_[i]-&gt;diff(x_, diff_cache);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="keywordflow">if</span> (error) {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">throw</span> SymEngineException(</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;            <span class="stringliteral">&quot;&#39;x&#39; must contain Symbols only. &quot;</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="stringliteral">&quot;Use sjacobian for SymPy style differentiation&quot;</span>);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;}</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="keywordtype">void</span> sjacobian(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> DenseMatrix &amp;x, DenseMatrix &amp;result,</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;               <span class="keywordtype">bool</span> diff_cache)</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;{</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    SYMENGINE_ASSERT(A.col_ == 1);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    SYMENGINE_ASSERT(x.col_ == 1);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    SYMENGINE_ASSERT(A.row_ == result.nrows() and x.row_ == result.ncols());</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; result.row_; i++) {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; result.col_; j++) {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            <span class="keywordflow">if</span> (is_a&lt;Symbol&gt;(*(x.m_[j]))) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                <span class="keyword">const</span> RCP&lt;const Symbol&gt; x_</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                    = rcp_static_cast&lt;const Symbol&gt;(x.m_[j]);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                result.m_[i * result.col_ + j] = A.m_[i]-&gt;diff(x_, diff_cache);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                <span class="comment">// TODO: Use a dummy symbol</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                <span class="keyword">const</span> RCP&lt;const Symbol&gt; x_ = <a class="code" href="namespaceSymEngine.html#a1f382b48b9cb214e1017d0e11fd3e6d6">symbol</a>(<span class="stringliteral">&quot;x_&quot;</span>);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                result.m_[i * result.col_ + j] = <a class="code" href="namespaceSymEngine.html#ae459921e036f06869a8d53b0f019c0c3">ssubs</a>(</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                    <a class="code" href="namespaceSymEngine.html#ae459921e036f06869a8d53b0f019c0c3">ssubs</a>(A.m_[i], {{x.m_[j], x_}})-&gt;diff(x_, diff_cache),</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                    {{x_, x.m_[j]}});</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;}</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">// ---------------------------- Diff -------------------------------------//</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="keywordtype">void</span> diff(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> RCP&lt;const Symbol&gt; &amp;x, DenseMatrix &amp;result,</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;          <span class="keywordtype">bool</span> diff_cache)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;{</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    SYMENGINE_ASSERT(A.row_ == result.nrows() and A.col_ == result.ncols());</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; result.row_; i++) {</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; result.col_; j++) {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;            result.m_[i * result.col_ + j]</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                = A.m_[i * result.col_ + j]-&gt;diff(x, diff_cache);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;}</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="keywordtype">void</span> sdiff(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> RCP&lt;const Basic&gt; &amp;x, DenseMatrix &amp;result,</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;           <span class="keywordtype">bool</span> diff_cache)</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;{</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    SYMENGINE_ASSERT(A.row_ == result.nrows() and A.col_ == result.ncols());</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor">#pragma omp parallel for</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; result.row_; i++) {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; result.col_; j++) {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            <span class="keywordflow">if</span> (is_a&lt;Symbol&gt;(*x)) {</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                <span class="keyword">const</span> RCP&lt;const Symbol&gt; x_ = rcp_static_cast&lt;const Symbol&gt;(x);</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                result.m_[i * result.col_ + j]</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                    = A.m_[i * result.col_ + j]-&gt;diff(x_, diff_cache);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                <span class="comment">// TODO: Use a dummy symbol</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                <span class="keyword">const</span> RCP&lt;const Symbol&gt; x_ = <a class="code" href="namespaceSymEngine.html#a1f382b48b9cb214e1017d0e11fd3e6d6">symbol</a>(<span class="stringliteral">&quot;_x&quot;</span>);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                result.m_[i * result.col_ + j]</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                    = <a class="code" href="namespaceSymEngine.html#ae459921e036f06869a8d53b0f019c0c3">ssubs</a>(<a class="code" href="namespaceSymEngine.html#ae459921e036f06869a8d53b0f019c0c3">ssubs</a>(A.m_[i * result.col_ + j], {{x, x_}})</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                -&gt;diff(x_, diff_cache),</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                            {{x_, x}});</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;}</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">// ----------------------------- Matrix Conjugate ----------------------------//</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="keywordtype">void</span> conjugate_dense(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;B)</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;{</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    SYMENGINE_ASSERT(B.col_ == A.col_ and B.row_ == A.row_);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; A.row_; i++)</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; A.col_; j++)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            B.m_[i * B.col_ + j] = <a class="code" href="namespaceSymEngine.html#af02f97d82354b66c939ae206f0057edd">conjugate</a>(A.m_[i * A.col_ + j]);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;}</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">// ----------------------------- Matrix Transpose ----------------------------//</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="keywordtype">void</span> transpose_dense(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;B)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;{</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    SYMENGINE_ASSERT(B.row_ == A.col_ and B.col_ == A.row_);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; A.row_; i++)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; A.col_; j++)</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            B.m_[j * B.col_ + i] = A.m_[i * A.col_ + j];</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;}</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">// ----------------------------- Matrix Conjugate Transpose -----------------//</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="keywordtype">void</span> conjugate_transpose_dense(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;B)</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;{</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    SYMENGINE_ASSERT(B.row_ == A.col_ and B.col_ == A.row_);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160; </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; A.row_; i++)</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; A.col_; j++)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            B.m_[j * B.col_ + i] = <a class="code" href="namespaceSymEngine.html#af02f97d82354b66c939ae206f0057edd">conjugate</a>(A.m_[i * A.col_ + j]);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;}</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">// ------------------------------- Submatrix ---------------------------------//</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="keywordtype">void</span> submatrix_dense(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;B, <span class="keywordtype">unsigned</span> row_start,</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                     <span class="keywordtype">unsigned</span> col_start, <span class="keywordtype">unsigned</span> row_end, <span class="keywordtype">unsigned</span> col_end,</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                     <span class="keywordtype">unsigned</span> row_step, <span class="keywordtype">unsigned</span> col_step)</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;{</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    SYMENGINE_ASSERT(row_end &gt;= row_start and col_end &gt;= col_start);</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    SYMENGINE_ASSERT(row_end &lt; A.row_);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    SYMENGINE_ASSERT(col_end &lt; A.col_);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    SYMENGINE_ASSERT(B.row_ == row_end - row_start + 1</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                     and B.col_ == col_end - col_start + 1);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordtype">unsigned</span> row = B.row_, col = B.col_;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; row; i += row_step)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; col; j += col_step)</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            B.m_[i * col + j] = A.m_[(row_start + i) * A.col_ + col_start + j];</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;}</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; </div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">// ------------------------------- Matrix Addition ---------------------------//</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="keywordtype">void</span> add_dense_dense(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> DenseMatrix &amp;B, DenseMatrix &amp;C)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;{</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    SYMENGINE_ASSERT(A.row_ == B.row_ and A.col_ == B.col_ and A.row_ == C.row_</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                     and A.col_ == C.col_);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <span class="keywordtype">unsigned</span> row = A.row_, col = A.col_;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; row; i++) {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; col; j++) {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;            C.m_[i * col + j] = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(A.m_[i * col + j], B.m_[i * col + j]);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        }</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;}</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="keywordtype">void</span> add_dense_scalar(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> RCP&lt;const Basic&gt; &amp;k,</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                      DenseMatrix &amp;B)</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;{</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    SYMENGINE_ASSERT(A.row_ == B.row_ and A.col_ == B.col_);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordtype">unsigned</span> row = A.row_, col = A.col_;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; row; i++) {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; col; j++) {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            B.m_[i * col + j] = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(A.m_[i * col + j], k);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        }</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;}</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">// ------------------------------- Matrix Multiplication ---------------------//</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="keywordtype">void</span> mul_dense_dense(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> DenseMatrix &amp;B, DenseMatrix &amp;C)</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;{</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    SYMENGINE_ASSERT(A.col_ == B.row_ and C.row_ == A.row_</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                     and C.col_ == B.col_);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordtype">unsigned</span> row = A.row_, col = B.col_;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordflow">if</span> (&amp;A != &amp;C and &amp;B != &amp;C) {</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> r = 0; r &lt; row; r++) {</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> c = 0; c &lt; col; c++) {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                C.m_[r * col + c] = zero; <span class="comment">// Integer Zero</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; A.col_; k++)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                    C.m_[r * col + c]</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                        = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(C.m_[r * col + c],</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                              <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[r * A.col_ + k], B.m_[k * col + c]));</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            }</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        DenseMatrix tmp = DenseMatrix(A.row_, B.col_);</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        mul_dense_dense(A, B, tmp);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        C = tmp;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    }</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;}</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="keywordtype">void</span> elementwise_mul_dense_dense(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> DenseMatrix &amp;B,</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                                 DenseMatrix &amp;C)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;{</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    SYMENGINE_ASSERT(A.row_ == B.row_ and A.col_ == B.col_ and A.row_ == C.row_</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                     and A.col_ == C.col_);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordtype">unsigned</span> row = A.row_, col = A.col_;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; row; i++) {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; col; j++) {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;            C.m_[i * col + j] = <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[i * col + j], B.m_[i * col + j]);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    }</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;}</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="keywordtype">void</span> mul_dense_scalar(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> RCP&lt;const Basic&gt; &amp;k,</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                      DenseMatrix &amp;B)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;{</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    SYMENGINE_ASSERT(A.col_ == B.col_ and A.row_ == B.row_);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordtype">unsigned</span> row = A.row_, col = A.col_;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; row; i++) {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; col; j++) {</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            B.m_[i * col + j] = <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[i * col + j], k);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        }</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    }</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;}</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">// ---------------------------- Joining Operations ---------------------------//</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="keywordtype">void</span> DenseMatrix::row_join(<span class="keyword">const</span> DenseMatrix &amp;B)</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;{</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    this-&gt;col_insert(B, col_);</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;}</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="keywordtype">void</span> DenseMatrix::col_join(<span class="keyword">const</span> DenseMatrix &amp;B)</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;{</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    this-&gt;row_insert(B, row_);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;}</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="keywordtype">void</span> DenseMatrix::row_insert(<span class="keyword">const</span> DenseMatrix &amp;B, <span class="keywordtype">unsigned</span> pos)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;{</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    SYMENGINE_ASSERT(col_ == B.col_ and pos &lt;= row_)</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keywordtype">unsigned</span> row = row_, col = col_;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    this-&gt;resize(row_ + B.row_, col_);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = row; i-- &gt; pos;) {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = col; j-- &gt; 0;) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            this-&gt;m_[(i + B.row_) * col + j] = this-&gt;m_[i * col + j];</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; B.row_; i++) {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; col; j++) {</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            this-&gt;m_[(i + pos) * col + j] = B.m_[i * col + j];</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    }</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;}</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="keywordtype">void</span> DenseMatrix::col_insert(<span class="keyword">const</span> DenseMatrix &amp;B, <span class="keywordtype">unsigned</span> pos)</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;{</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    SYMENGINE_ASSERT(row_ == B.row_ and pos &lt;= col_)</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordtype">unsigned</span> row = row_, col = col_;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    this-&gt;resize(row_, col_ + B.col_);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160; </div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = row; i-- &gt; 0;) {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = col; j-- &gt; 0;) {</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <span class="keywordflow">if</span> (j &gt;= pos) {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                this-&gt;m_[i * (col + B.col_) + j + B.col_]</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    = this-&gt;m_[i * col + j];</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                this-&gt;m_[i * (col + B.col_) + j] = this-&gt;m_[i * col + j];</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    }</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; row; i++) {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; B.col_; j++) {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            this-&gt;m_[i * (col + B.col_) + j + pos] = B.m_[i * B.col_ + j];</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;}</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="keywordtype">void</span> DenseMatrix::row_del(<span class="keywordtype">unsigned</span> k)</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;{</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    SYMENGINE_ASSERT(k &lt; row_)</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordflow">if</span> (row_ == 1)</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        this-&gt;resize(0, 0);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = k; i &lt; row_ - 1; i++) {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;            row_exchange_dense(*<span class="keyword">this</span>, i, i + 1);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        this-&gt;resize(row_ - 1, col_);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    }</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;}</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="keywordtype">void</span> DenseMatrix::col_del(<span class="keywordtype">unsigned</span> k)</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;{</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    SYMENGINE_ASSERT(k &lt; col_)</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">if</span> (col_ == 1)</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        this-&gt;resize(0, 0);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <span class="keywordtype">unsigned</span> row = row_, col = col_, m = 0;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; row; i++) {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; col; j++) {</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                <span class="keywordflow">if</span> (j != k) {</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                    this-&gt;m_[m] = this-&gt;m_[i * col + j];</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                    m++;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                }</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            }</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        }</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        this-&gt;resize(row_, col_ - 1);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    }</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;}</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment">// -------------------------------- Row Operations ---------------------------//</span></div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="keywordtype">void</span> row_exchange_dense(DenseMatrix &amp;A, <span class="keywordtype">unsigned</span> i, <span class="keywordtype">unsigned</span> j)</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;{</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    SYMENGINE_ASSERT(i != j and i &lt; A.row_ and j &lt; A.row_);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordtype">unsigned</span> col = A.col_;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; A.col_; k++)</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/swap.html">std::swap</a>(A.m_[i * col + k], A.m_[j * col + k]);</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;}</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="keywordtype">void</span> row_mul_scalar_dense(DenseMatrix &amp;A, <span class="keywordtype">unsigned</span> i, RCP&lt;const Basic&gt; &amp;c)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;{</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    SYMENGINE_ASSERT(i &lt; A.row_);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordtype">unsigned</span> col = A.col_;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; A.col_; j++)</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        A.m_[i * col + j] = <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(c, A.m_[i * col + j]);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;}</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="keywordtype">void</span> row_add_row_dense(DenseMatrix &amp;A, <span class="keywordtype">unsigned</span> i, <span class="keywordtype">unsigned</span> j,</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                       RCP&lt;const Basic&gt; &amp;c)</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;{</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    SYMENGINE_ASSERT(i != j and i &lt; A.row_ and j &lt; A.row_);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordtype">unsigned</span> col = A.col_;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; A.col_; k++)</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        A.m_[i * col + k] = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(A.m_[i * col + k], <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(c, A.m_[j * col + k]));</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;}</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="keywordtype">void</span> permuteFwd(DenseMatrix &amp;A, permutelist &amp;pl)</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;{</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;p : pl) {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        row_exchange_dense(A, p.first, p.second);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    }</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;}</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="comment">// ----------------------------- Column Operations ---------------------------//</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="keywordtype">void</span> column_exchange_dense(DenseMatrix &amp;A, <span class="keywordtype">unsigned</span> i, <span class="keywordtype">unsigned</span> j)</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;{</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    SYMENGINE_ASSERT(i != j and i &lt; A.col_ and j &lt; A.col_);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordtype">unsigned</span> col = A.col_;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; A.row_; k++)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/swap.html">std::swap</a>(A.m_[k * col + i], A.m_[k * col + j]);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;}</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">// ------------------------------ Gaussian Elimination -----------------------//</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="keywordtype">void</span> pivoted_gaussian_elimination(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;B,</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                                  permutelist &amp;pl)</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;{</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    SYMENGINE_ASSERT(A.row_ == B.row_ and A.col_ == B.col_);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordtype">unsigned</span> row = A.row_, col = A.col_;</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keywordtype">unsigned</span> index = 0, i, j, k;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    B.m_ = A.m_;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160; </div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    RCP&lt;const Basic&gt; scale;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160; </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; col - 1; i++) {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keywordflow">if</span> (index == row)</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        k = pivot(B, index, i);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">if</span> (k == row)</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keywordflow">if</span> (k != index) {</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            row_exchange_dense(B, k, index);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            pl.push_back({k, index});</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        }</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        scale = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(one, B.m_[index * col + i]);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        row_mul_scalar_dense(B, index, scale);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="keywordflow">for</span> (j = i + 1; j &lt; row; j++) {</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;            <span class="keywordflow">for</span> (k = i + 1; k &lt; col; k++)</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                B.m_[j * col + k]</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                    = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(B.m_[j * col + k],</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                          <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(B.m_[j * col + i], B.m_[i * col + k]));</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            B.m_[j * col + i] = zero;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        }</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        index++;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;}</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; </div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">// Algorithm 1, page 12, Nakos, G. C., Turner, P. R., Williams, R. M. (1997).</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="comment">// Fraction-free algorithms for linear and polynomial equations.</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="comment">// ACM SIGSAM Bulletin, 31(3), 11–19. doi:10.1145/271130.271133.</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="keywordtype">void</span> fraction_free_gaussian_elimination(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;B)</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;{</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    SYMENGINE_ASSERT(A.row_ == B.row_ and A.col_ == B.col_);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordtype">unsigned</span> col = A.col_;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    B.m_ = A.m_;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; col - 1; i++)</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = i + 1; j &lt; A.row_; j++) {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = i + 1; k &lt; col; k++) {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                B.m_[j * col + k]</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                    = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(B.m_[i * col + i], B.m_[j * col + k]),</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                          <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(B.m_[j * col + i], B.m_[i * col + k]));</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                    B.m_[j * col + k]</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                        = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(B.m_[j * col + k], B.m_[i * col - col + i - 1]);</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            B.m_[j * col + i] = zero;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        }</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;}</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">// Pivoted version of `fraction_free_gaussian_elimination`</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="keywordtype">void</span> pivoted_fraction_free_gaussian_elimination(<span class="keyword">const</span> DenseMatrix &amp;A,</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                                                DenseMatrix &amp;B, permutelist &amp;pl)</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;{</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    SYMENGINE_ASSERT(A.row_ == B.row_ and A.col_ == B.col_);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordtype">unsigned</span> col = A.col_, row = A.row_;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;    <span class="keywordtype">unsigned</span> index = 0, i, k, j;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    B.m_ = A.m_;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160; </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; col - 1; i++) {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="keywordflow">if</span> (index == row)</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        k = pivot(B, index, i);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="keywordflow">if</span> (k == row)</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <span class="keywordflow">if</span> (k != index) {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            row_exchange_dense(B, k, index);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            pl.push_back({k, index});</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160; </div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="keywordflow">for</span> (j = i + 1; j &lt; row; j++) {</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <span class="keywordflow">for</span> (k = i + 1; k &lt; col; k++) {</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                B.m_[j * col + k]</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                    = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(B.m_[i * col + i], B.m_[j * col + k]),</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                          <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(B.m_[j * col + i], B.m_[i * col + k]));</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;                    B.m_[j * col + k]</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;                        = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(B.m_[j * col + k], B.m_[i * col - col + i - 1]);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            }</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            B.m_[j * col + i] = zero;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        }</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160; </div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        index++;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    }</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;}</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="keywordtype">void</span> pivoted_gauss_jordan_elimination(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;B,</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                                      permutelist &amp;pl)</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;{</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    SYMENGINE_ASSERT(A.row_ == B.row_ and A.col_ == B.col_);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160; </div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    <span class="keywordtype">unsigned</span> row = A.row_, col = A.col_;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordtype">unsigned</span> index = 0, i, j, k;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    RCP&lt;const Basic&gt; scale;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    B.m_ = A.m_;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; col; i++) {</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="keywordflow">if</span> (index == row)</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160; </div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        k = pivot(B, index, i);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="keywordflow">if</span> (k == row)</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <span class="keywordflow">if</span> (k != index) {</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            row_exchange_dense(B, k, index);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            pl.push_back({k, index});</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        }</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        scale = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(one, B.m_[index * col + i]);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        row_mul_scalar_dense(B, index, scale);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; row; j++) {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            <span class="keywordflow">if</span> (j == index)</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            scale = <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(minus_one, B.m_[j * col + i]);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            row_add_row_dense(B, j, index, scale);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        }</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        index++;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    }</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;}</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="comment">// Algorithm 2, page 13, Nakos, G. C., Turner, P. R., Williams, R. M. (1997).</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="comment">// Fraction-free algorithms for linear and polynomial equations.</span></div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="comment">// ACM SIGSAM Bulletin, 31(3), 11–19. doi:10.1145/271130.271133.</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="keywordtype">void</span> fraction_free_gauss_jordan_elimination(<span class="keyword">const</span> DenseMatrix &amp;A,</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;                                            DenseMatrix &amp;B)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;{</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    SYMENGINE_ASSERT(A.row_ == B.row_ and A.col_ == B.col_);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160; </div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordtype">unsigned</span> row = A.row_, col = A.col_;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keywordtype">unsigned</span> i, j, k;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    RCP&lt;const Basic&gt; d;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    B.m_ = A.m_;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; col; i++) {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            d = B.m_[i * col - col + i - 1];</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; row; j++)</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            <span class="keywordflow">if</span> (j != i)</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                <span class="keywordflow">for</span> (k = 0; k &lt; col; k++) {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                    <span class="keywordflow">if</span> (k != i) {</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                        B.m_[j * col + k]</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                            = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(B.m_[i * col + i], B.m_[j * col + k]),</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                                  <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(B.m_[j * col + i], B.m_[i * col + k]));</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                        <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                            B.m_[j * col + k] = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(B.m_[j * col + k], d);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                    }</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                }</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; row; j++)</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            <span class="keywordflow">if</span> (j != i)</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                B.m_[j * col + i] = zero;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    }</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;}</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160; </div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="keywordtype">void</span> pivoted_fraction_free_gauss_jordan_elimination(<span class="keyword">const</span> DenseMatrix &amp;A,</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                                                    DenseMatrix &amp;B,</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                                                    permutelist &amp;pl)</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;{</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    SYMENGINE_ASSERT(A.row_ == B.row_ and A.col_ == B.col_);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="keywordtype">unsigned</span> row = A.row_, col = A.col_;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordtype">unsigned</span> index = 0, i, k, j;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    RCP&lt;const Basic&gt; d;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    B.m_ = A.m_;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; col; i++) {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="keywordflow">if</span> (index == row)</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        k = pivot(B, index, i);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="keywordflow">if</span> (k == row)</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="keywordflow">if</span> (k != index) {</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            row_exchange_dense(B, k, index);</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            pl.push_back({k, index});</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        }</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; row; j++) {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            <span class="keywordflow">if</span> (j == index)</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            <span class="keywordflow">for</span> (k = 0; k &lt; col; k++) {</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                <span class="keywordflow">if</span> (k == i)</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                B.m_[j * col + k]</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                    = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(B.m_[index * col + i], B.m_[j * col + k]),</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                          <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(B.m_[j * col + i], B.m_[index * col + k]));</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                <span class="keywordflow">if</span> (index == 0)</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                B.m_[j * col + k] = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(B.m_[j * col + k], d);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            }</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        }</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        d = B.m_[index * col + i];</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160; </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; row; j++) {</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            <span class="keywordflow">if</span> (j == index)</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            B.m_[j * col + i] = zero;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;        }</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        index++;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;}</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="keywordtype">unsigned</span> pivot(DenseMatrix &amp;B, <span class="keywordtype">unsigned</span> r, <span class="keywordtype">unsigned</span> c)</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;{</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = r; k &lt; B.row_; k++) {</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <span class="keywordflow">if</span> (!is_true(<a class="code" href="namespaceSymEngine.html#ab930e860c8b1ff6cd03daff9c60c819a">is_zero</a>(*(B.m_[k * B.col_ + c])))) {</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            <span class="keywordflow">return</span> k;</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        }</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    }</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">return</span> B.row_;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;}</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="keywordtype">void</span> reduced_row_echelon_form(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;b,</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                              vec_uint &amp;pivot_cols, <span class="keywordtype">bool</span> normalize_last)</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;{</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    permutelist pl;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keywordflow">if</span> (normalize_last) {</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        pivoted_fraction_free_gauss_jordan_elimination(A, b, pl);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        pivoted_gauss_jordan_elimination(A, b, pl);</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    }</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="keywordtype">unsigned</span> row = 0;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> col = 0; col &lt; b.col_ &amp;&amp; row &lt; b.row_; col++) {</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <span class="keywordflow">if</span> (is_true(<a class="code" href="namespaceSymEngine.html#ab930e860c8b1ff6cd03daff9c60c819a">is_zero</a>(*b.get(row, col))))</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        pivot_cols.push_back(col);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="keywordflow">if</span> (row == 0 and normalize_last) {</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            RCP&lt;const Basic&gt; m = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(one, b.get(row, col));</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            b.mul_scalar(m, b);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        row++;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    }</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;}</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="comment">// --------------------------- Solve Ax = b  ---------------------------------//</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="comment">// Assuming A is a diagonal square matrix</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="keywordtype">void</span> diagonal_solve(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> DenseMatrix &amp;b, DenseMatrix &amp;x)</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;{</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    SYMENGINE_ASSERT(A.row_ == A.col_);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    SYMENGINE_ASSERT(x.row_ == A.col_ and x.col_ == b.col_);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; </div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> sys = b.col_;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="comment">// No checks are done to see if the diagonal entries are zero</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; sys; k++) {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; A.col_; i++) {</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            x.m_[i * sys + k] = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(b.m_[i * sys + k], A.m_[i * A.col_ + i]);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        }</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    }</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;}</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="keywordtype">void</span> back_substitution(<span class="keyword">const</span> DenseMatrix &amp;U, <span class="keyword">const</span> DenseMatrix &amp;b,</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                       DenseMatrix &amp;x)</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;{</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    SYMENGINE_ASSERT(U.row_ == U.col_);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    SYMENGINE_ASSERT(b.row_ == U.row_);</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    SYMENGINE_ASSERT(x.row_ == U.col_ and x.col_ == b.col_);</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> col = U.col_;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> sys = b.col_;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    x.m_ = b.m_;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160; </div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; sys; k++) {</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = col - 1; i &gt;= 0; i--) {</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = i + 1; j &lt; col; j++)</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;                x.m_[i * sys + k]</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;                    = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(x.m_[i * sys + k],</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;                          <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(U.m_[i * col + j], x.m_[j * sys + k]));</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            x.m_[i * sys + k] = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(x.m_[i * sys + k], U.m_[i * col + i]);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        }</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    }</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;}</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="keywordtype">void</span> forward_substitution(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> DenseMatrix &amp;b,</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                          DenseMatrix &amp;x)</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;{</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    SYMENGINE_ASSERT(A.row_ == A.col_);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    SYMENGINE_ASSERT(b.row_ == A.row_);</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    SYMENGINE_ASSERT(x.row_ == A.col_ and x.col_ == b.col_);</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordtype">unsigned</span> col = A.col_;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> sys = b.col_;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    x.m_ = b.m_;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; b.col_; k++) {</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; col - 1; i++) {</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = i + 1; j &lt; col; j++) {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;                x.m_[j * sys + k]</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                    = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[i * col + i], x.m_[j * sys + k]),</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                          <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[j * col + i], x.m_[i * sys + k]));</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                    x.m_[j * sys + k]</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;                        = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(x.m_[j * sys + k], A.m_[(i - 1) * col + i - 1]);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;            }</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        }</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;}</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="keywordtype">void</span> fraction_free_gaussian_elimination_solve(<span class="keyword">const</span> DenseMatrix &amp;A,</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                                              <span class="keyword">const</span> DenseMatrix &amp;b,</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                                              DenseMatrix &amp;x)</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;{</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    SYMENGINE_ASSERT(A.row_ == A.col_);</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    SYMENGINE_ASSERT(b.row_ == A.row_ and x.row_ == A.row_);</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    SYMENGINE_ASSERT(x.col_ == b.col_);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keywordtype">int</span> i, j, k, col = A.col_, bcol = b.col_;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    DenseMatrix A_ = DenseMatrix(A.row_, A.col_, A.m_);</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    DenseMatrix b_ = DenseMatrix(b.row_, b.col_, b.m_);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; col - 1; i++)</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="keywordflow">for</span> (j = i + 1; j &lt; col; j++) {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;            <span class="keywordflow">for</span> (k = 0; k &lt; bcol; k++) {</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                b_.m_[j * bcol + k]</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                    = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A_.m_[i * col + i], b_.m_[j * bcol + k]),</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                          <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A_.m_[j * col + i], b_.m_[i * bcol + k]));</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                    b_.m_[j * bcol + k] = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(b_.m_[j * bcol + k],</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                                              A_.m_[i * col - col + i - 1]);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;            }</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;            <span class="keywordflow">for</span> (k = i + 1; k &lt; col; k++) {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                A_.m_[j * col + k]</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;                    = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A_.m_[i * col + i], A_.m_[j * col + k]),</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;                          <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A_.m_[j * col + i], A_.m_[i * col + k]));</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;                <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;                    A_.m_[j * col + k]</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                        = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(A_.m_[j * col + k], A_.m_[i * col - col + i - 1]);</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;            }</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;            A_.m_[j * col + i] = zero;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        }</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; col * bcol; i++)</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        x.m_[i] = zero; <span class="comment">// Integer zero;</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    for (k = 0; k &lt; bcol; k++) {</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        <span class="keywordflow">for</span> (i = col - 1; i &gt;= 0; i--) {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            <span class="keywordflow">for</span> (j = i + 1; j &lt; col; j++)</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                b_.m_[i * bcol + k]</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                    = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(b_.m_[i * bcol + k],</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                          <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A_.m_[i * col + j], x.m_[j * bcol + k]));</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            x.m_[i * bcol + k] = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(b_.m_[i * bcol + k], A_.m_[i * col + i]);</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    }</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;}</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="keywordtype">void</span> fraction_free_gauss_jordan_solve(<span class="keyword">const</span> DenseMatrix &amp;A,</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                                      <span class="keyword">const</span> DenseMatrix &amp;b, DenseMatrix &amp;x,</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                                      <span class="keywordtype">bool</span> pivot)</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;{</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    SYMENGINE_ASSERT(A.row_ == A.col_);</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    SYMENGINE_ASSERT(b.row_ == A.row_ and x.row_ == A.row_);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;    SYMENGINE_ASSERT(x.col_ == b.col_);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160; </div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keywordtype">unsigned</span> i, j, k, p, col = A.col_, bcol = b.col_;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    RCP&lt;const Basic&gt; d;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    DenseMatrix A_ = DenseMatrix(A.row_, A.col_, A.m_);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    DenseMatrix b_ = DenseMatrix(b.row_, b.col_, b.m_);</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160; </div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; col; i++) {</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            d = A_.m_[i * col - col + i - 1];</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;        <span class="keywordflow">if</span> (pivot) {</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;            p = i;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            <span class="keywordflow">while</span> (p &lt; col and <a class="code" href="namespaceSymEngine.html#a2861dd1747fa1416cd6ef023ef08fca5">eq</a>(*A_.m_[p * col + i], *zero)) {</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                p++;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            }</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            SYMENGINE_ASSERT(p != col);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            <span class="keywordflow">if</span> (p != i) {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                <span class="comment">// pivot A</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                <span class="keywordflow">for</span> (k = i; k &lt; col; k++) {</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                    <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/swap.html">std::swap</a>(A_.m_[p * col + k], A_.m_[i * col + k]);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                }</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                <span class="keywordflow">for</span> (k = 0; k &lt; bcol; k++) {</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                    <a class="codeRef" href="http://en.cppreference.com/w/cpp/algorithm/swap.html">std::swap</a>(b_.m_[p * bcol + k], b_.m_[i * bcol + k]);</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                }</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            }</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; col; j++)</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;            <span class="keywordflow">if</span> (j != i) {</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                <span class="keywordflow">for</span> (k = 0; k &lt; bcol; k++) {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                    b_.m_[j * bcol + k]</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                        = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A_.m_[i * col + i], b_.m_[j * bcol + k]),</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                              <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A_.m_[j * col + i], b_.m_[i * bcol + k]));</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                    <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                        b_.m_[j * bcol + k] = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(b_.m_[j * bcol + k], d);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                }</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160; </div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                <span class="keywordflow">for</span> (k = 0; k &lt; col; k++) {</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                    <span class="keywordflow">if</span> (k != i) {</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                        A_.m_[j * col + k]</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                            = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A_.m_[i * col + i], A_.m_[j * col + k]),</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                                  <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A_.m_[j * col + i], A_.m_[i * col + k]));</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                        <span class="keywordflow">if</span> (i &gt; 0)</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                            A_.m_[j * col + k] = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(A_.m_[j * col + k], d);</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                    }</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                }</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;            }</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; col; j++)</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;            <span class="keywordflow">if</span> (j != i)</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;                A_.m_[j * col + i] = zero;</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    }</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160; </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    <span class="comment">// No checks are done to see if the diagonal entries are zero</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="keywordflow">for</span> (k = 0; k &lt; bcol; k++)</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; col; i++)</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            x.m_[i * bcol + k] = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(b_.m_[i * bcol + k], A_.m_[i * col + i]);</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;}</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160; </div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="keywordtype">void</span> fraction_free_LU_solve(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> DenseMatrix &amp;b,</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                            DenseMatrix &amp;x)</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;{</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    DenseMatrix LU = DenseMatrix(A.nrows(), A.ncols());</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    DenseMatrix x_ = DenseMatrix(b.nrows(), b.ncols());</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160; </div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    fraction_free_LU(A, LU);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    forward_substitution(LU, b, x_);</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    back_substitution(LU, x_, x);</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;}</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="keywordtype">void</span> LU_solve(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> DenseMatrix &amp;b, DenseMatrix &amp;x)</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;{</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    DenseMatrix L = DenseMatrix(A.nrows(), A.ncols());</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    DenseMatrix U = DenseMatrix(A.nrows(), A.ncols());</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    DenseMatrix x_ = DenseMatrix(b.nrows(), b.ncols());</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160; </div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    LU(A, L, U);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    forward_substitution(L, b, x_);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    back_substitution(U, x_, x);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;}</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160; </div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="keywordtype">void</span> pivoted_LU_solve(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> DenseMatrix &amp;b,</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                      DenseMatrix &amp;x)</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;{</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    DenseMatrix L = DenseMatrix(A.nrows(), A.ncols());</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    DenseMatrix U = DenseMatrix(A.nrows(), A.ncols());</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    DenseMatrix x_ = DenseMatrix(b);</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    permutelist pl;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160; </div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    pivoted_LU(A, L, U, pl);</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    permuteFwd(x_, pl);</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    forward_substitution(L, x_, x_);</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    back_substitution(U, x_, x);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;}</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="keywordtype">void</span> LDL_solve(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> DenseMatrix &amp;b, DenseMatrix &amp;x)</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;{</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    DenseMatrix L = DenseMatrix(A.nrows(), A.ncols());</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    DenseMatrix D = DenseMatrix(A.nrows(), A.ncols());</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    DenseMatrix x_ = DenseMatrix(b.nrows(), b.ncols());</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160; </div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <span class="keywordflow">if</span> (not is_symmetric_dense(A))</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        <span class="keywordflow">throw</span> SymEngineException(<span class="stringliteral">&quot;Matrix must be symmetric&quot;</span>);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160; </div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    LDL(A, L, D);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    forward_substitution(L, b, x);</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    diagonal_solve(D, x, x_);</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    transpose_dense(L, D);</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    back_substitution(D, x_, x);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;}</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160; </div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="comment">// --------------------------- Matrix Decomposition --------------------------//</span></div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160; </div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="comment">// Algorithm 3, page 14, Nakos, G. C., Turner, P. R., Williams, R. M. (1997).</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="comment">// Fraction-free algorithms for linear and polynomial equations.</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="comment">// ACM SIGSAM Bulletin, 31(3), 11–19. doi:10.1145/271130.271133.</span></div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="comment">// This algorithms is not a true factorization of the matrix A(i.e. A != LU))</span></div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="comment">// but can be used to solve linear systems by applying forward and backward</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="comment">// substitutions respectively.</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="keywordtype">void</span> fraction_free_LU(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;LU)</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;{</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    SYMENGINE_ASSERT(A.row_ == A.col_ and LU.row_ == LU.col_</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;                     and A.row_ == LU.row_);</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="keywordtype">unsigned</span> n = A.row_;</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="keywordtype">unsigned</span> i, j, k;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160; </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    LU.m_ = A.m_;</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160; </div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; n - 1; i++)</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;        <span class="keywordflow">for</span> (j = i + 1; j &lt; n; j++)</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;            <span class="keywordflow">for</span> (k = i + 1; k &lt; n; k++) {</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                LU.m_[j * n + k] = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(LU.m_[i * n + i], LU.m_[j * n + k]),</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                                       <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(LU.m_[j * n + i], LU.m_[i * n + k]));</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                <span class="keywordflow">if</span> (i)</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                    LU.m_[j * n + k]</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                        = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(LU.m_[j * n + k], LU.m_[i * n - n + i - 1]);</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            }</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;}</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160; </div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment">// SymPy LUDecomposition algorithm, in</span></div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="comment">// sympy.matrices.matrices.Matrix.LUdecomposition</span></div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="comment">// with no pivoting</span></div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="keywordtype">void</span> LU(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;L, DenseMatrix &amp;U)</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;{</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    SYMENGINE_ASSERT(A.row_ == A.col_ and L.row_ == L.col_</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                     and U.row_ == U.col_);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    SYMENGINE_ASSERT(A.row_ == L.row_ and A.row_ == U.row_);</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160; </div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    <span class="keywordtype">unsigned</span> n = A.row_;</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <span class="keywordtype">unsigned</span> i, j, k;</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    RCP&lt;const Basic&gt; scale;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; </div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    U.m_ = A.m_;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160; </div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; n; j++) {</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; j; i++)</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;            <span class="keywordflow">for</span> (k = 0; k &lt; i; k++)</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;                U.m_[i * n + j] = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(U.m_[i * n + j],</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                                      <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(U.m_[i * n + k], U.m_[k * n + j]));</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160; </div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        <span class="keywordflow">for</span> (i = j; i &lt; n; i++) {</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            <span class="keywordflow">for</span> (k = 0; k &lt; j; k++)</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                U.m_[i * n + j] = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(U.m_[i * n + j],</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                                      <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(U.m_[i * n + k], U.m_[k * n + j]));</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        }</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160; </div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        scale = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(one, U.m_[j * n + j]);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        <span class="keywordflow">for</span> (i = j + 1; i &lt; n; i++)</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            U.m_[i * n + j] = <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(U.m_[i * n + j], scale);</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    }</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160; </div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; i; j++) {</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            L.m_[i * n + j] = U.m_[i * n + j];</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            U.m_[i * n + j] = zero; <span class="comment">// Integer zero</span></div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        }</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        L.m_[i * n + i] = one; <span class="comment">// Integer one</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;        <span class="keywordflow">for</span> (j = i + 1; j &lt; n; j++)</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;            L.m_[i * n + j] = zero; <span class="comment">// Integer zero</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;}</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160; </div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="comment">// SymPy LUDecomposition_Simple algorithm, in</span></div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="comment">// sympy.matrices.matrices.Matrix.LUdecomposition_Simple with pivoting.</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="comment">// P must be an initialized matrix and will be permuted.</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="keywordtype">void</span> pivoted_LU(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;LU, permutelist &amp;pl)</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;{</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    SYMENGINE_ASSERT(A.row_ == A.col_ and LU.row_ == LU.col_);</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    SYMENGINE_ASSERT(A.row_ == LU.row_);</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; </div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="keywordtype">unsigned</span> n = A.row_;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="keywordtype">unsigned</span> i, j, k;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    RCP&lt;const Basic&gt; scale;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordtype">int</span> pivot;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;    LU.m_ = A.m_;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160; </div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    <span class="keywordflow">for</span> (j = 0; j &lt; n; j++) {</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; j; i++)</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;            <span class="keywordflow">for</span> (k = 0; k &lt; i; k++)</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;                LU.m_[i * n + j] = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(LU.m_[i * n + j],</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;                                       <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(LU.m_[i * n + k], LU.m_[k * n + j]));</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        pivot = -1;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        <span class="keywordflow">for</span> (i = j; i &lt; n; i++) {</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            <span class="keywordflow">for</span> (k = 0; k &lt; j; k++) {</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;                LU.m_[i * n + j] = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(LU.m_[i * n + j],</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;                                       <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(LU.m_[i * n + k], LU.m_[k * n + j]));</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;            }</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;            <span class="keywordflow">if</span> (pivot == -1 and !is_true(<a class="code" href="namespaceSymEngine.html#ab930e860c8b1ff6cd03daff9c60c819a">is_zero</a>(*LU.m_[i * n + j])))</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                pivot = i;</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        }</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        <span class="keywordflow">if</span> (pivot == -1)</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            <span class="keywordflow">throw</span> SymEngineException(<span class="stringliteral">&quot;Matrix is rank deficient&quot;</span>);</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        <span class="keywordflow">if</span> (pivot - j != 0) { <span class="comment">// row must be swapped</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;            row_exchange_dense(LU, pivot, j);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;            pl.push_back({pivot, j});</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        }</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        scale = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(one, LU.m_[j * n + j]);</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        <span class="keywordflow">for</span> (i = j + 1; i &lt; n; i++)</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;            LU.m_[i * n + j] = <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(LU.m_[i * n + j], scale);</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    }</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;}</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160; </div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="comment">// SymPy LUDecomposition algorithm, in</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="comment">// sympy.matrices.matrices.Matrix.LUdecomposition_Simple with pivoting.</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="comment">// P must be an initialized matrix and will be permuted.</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="keywordtype">void</span> pivoted_LU(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;L, DenseMatrix &amp;U,</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                permutelist &amp;pl)</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;{</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    SYMENGINE_ASSERT(A.row_ == A.col_ and L.row_ == L.col_</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;                     and U.row_ == U.col_);</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    SYMENGINE_ASSERT(A.row_ == L.row_ and A.row_ == U.row_);</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    pivoted_LU(A, U, pl);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <span class="keywordtype">unsigned</span> n = A.col_;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; n; i++) {</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; i; j++) {</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            L.m_[i * n + j] = U.m_[i * n + j];</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            U.m_[i * n + j] = zero; <span class="comment">// Integer zero</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        }</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        L.m_[i * n + i] = one; <span class="comment">// Integer one</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = i + 1; j &lt; n; j++)</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;            L.m_[i * n + j] = zero; <span class="comment">// Integer zero</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;    }</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;}</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160; </div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment">// SymPy&#39;s fraction free LU decomposition, without pivoting</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="comment">// sympy.matrices.matrices.MatrixBase.LUdecompositionFF</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="comment">// W. Zhou &amp; D.J. Jeffrey, &quot;Fraction-free matrix factors: new forms for LU and</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment">// QR factors&quot;.</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="comment">// Frontiers in Computer Science in China, Vol 2, no. 1, pp. 67-80, 2008.</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="keywordtype">void</span> fraction_free_LDU(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;L, DenseMatrix &amp;D,</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                       DenseMatrix &amp;U)</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;{</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    SYMENGINE_ASSERT(A.row_ == L.row_ and A.row_ == U.row_);</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    SYMENGINE_ASSERT(A.col_ == L.col_ and A.col_ == U.col_);</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160; </div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    <span class="keywordtype">unsigned</span> row = A.row_, col = A.col_;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="keywordtype">unsigned</span> i, j, k;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    RCP&lt;const Basic&gt; old = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(1);</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    U.m_ = A.m_;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160; </div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="comment">// Initialize L</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; row; i++)</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; row; j++)</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;            <span class="keywordflow">if</span> (i != j)</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                L.m_[i * col + j] = zero;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;                L.m_[i * col + i] = one;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160; </div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="comment">// Initialize D</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; row * row; i++)</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        D.m_[i] = zero; <span class="comment">// Integer zero</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160; </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    for (k = 0; k &lt; row - 1; k++) {</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        L.m_[k * col + k] = U.m_[k * col + k];</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        D.m_[k * col + k] = <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(old, U.m_[k * col + k]);</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160; </div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        <span class="keywordflow">for</span> (i = k + 1; i &lt; row; i++) {</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            L.m_[i * col + k] = U.m_[i * col + k];</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;            <span class="keywordflow">for</span> (j = k + 1; j &lt; col; j++)</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                U.m_[i * col + j]</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                    = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(<a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(U.m_[k * col + k], U.m_[i * col + j]),</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                              <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(U.m_[k * col + j], U.m_[i * col + k])),</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;                          old);</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            U.m_[i * col + k] = zero; <span class="comment">// Integer zero</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        }</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        old = U.m_[k * col + k];</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    }</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160; </div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    D.m_[row * col - col + row - 1] = old;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;}</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="comment">// SymPy&#39;s QRecomposition in sympy.matrices.matrices.MatrixBase.QRdecomposition</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">// Rank check is not performed</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="keywordtype">void</span> QR(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;Q, DenseMatrix &amp;R)</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;{</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    <span class="keywordtype">unsigned</span> row = A.row_;</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <span class="keywordtype">unsigned</span> col = A.col_;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    SYMENGINE_ASSERT(Q.row_ == row and Q.col_ == col and R.row_ == col</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;                     and R.col_ == col);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160; </div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    <span class="keywordtype">unsigned</span> i, j, k;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    RCP&lt;const Basic&gt; t;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;RCP&lt;const Basic&gt;</a>&gt; tmp(row);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160; </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <span class="comment">// Initialize Q</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; row * col; i++)</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        Q.m_[i] = zero;</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="comment">// Initialize R</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    for (i = 0; i &lt; col * col; i++)</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        R.m_[i] = zero;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160; </div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    for (j = 0; j &lt; col; j++) {</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="comment">// Use submatrix for this</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; row; k++)</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;            tmp[k] = A.m_[k * col + j];</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        for (i = 0; i &lt; j; i++) {</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;            t = zero;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;            <span class="keywordflow">for</span> (k = 0; k &lt; row; k++)</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;                t = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(t, <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[k * col + j], Q.m_[k * col + i]));</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;            <span class="keywordflow">for</span> (k = 0; k &lt; row; k++)</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                tmp[k] = <a class="code" href="namespaceSymEngine.html#ac104d13f145416cd18c61b0121017eb6">expand</a>(<a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(tmp[k], <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(Q.m_[k * col + i], t)));</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        }</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; </div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;        <span class="comment">// calculate norm</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        t = zero;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; row; k++)</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;            t = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(t, <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/pow.html">pow</a>(tmp[k], <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(2)));</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160; </div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        t = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/pow.html">pow</a>(t, <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(one, <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(2)));</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160; </div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        R.m_[j * col + j] = t;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; row; k++)</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;            Q.m_[k * col + j] = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(tmp[k], t);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; j; i++) {</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;            t = zero;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;            <span class="keywordflow">for</span> (k = 0; k &lt; row; k++)</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;                t = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(t, <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(Q.m_[k * col + i], A.m_[k * col + j]));</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;            R.m_[i * col + j] = t;</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        }</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    }</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;}</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160; </div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="comment">// SymPy&#39;s LDL decomposition, Assuming A is a symmetric, square, positive</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="comment">// definite non singular matrix</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="keywordtype">void</span> LDL(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;L, DenseMatrix &amp;D)</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;{</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    SYMENGINE_ASSERT(A.row_ == A.col_);</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    SYMENGINE_ASSERT(L.row_ == A.row_ and L.col_ == A.row_);</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    SYMENGINE_ASSERT(D.row_ == A.row_ and D.col_ == A.row_);</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160; </div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keywordtype">unsigned</span> col = A.col_;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="keywordtype">unsigned</span> i, k, j;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    RCP&lt;const Basic&gt; sum;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    RCP&lt;const Basic&gt; i2 = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(2);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160; </div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="comment">// Initialize D</span></div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; col; i++)</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; col; j++)</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            D.m_[i * col + j] = zero; <span class="comment">// Integer zero</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160; </div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    <span class="comment">// Initialize L</span></div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    for (i = 0; i &lt; col; i++)</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; col; j++)</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;            L.m_[i * col + j] = (i != j) ? zero : one;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160; </div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; col; i++) {</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; i; j++) {</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;            sum = zero;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            <span class="keywordflow">for</span> (k = 0; k &lt; j; k++)</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                sum = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(sum, <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(L.m_[i * col + k], L.m_[j * col + k]),</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                                   D.m_[k * col + k]));</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;            L.m_[i * col + j]</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                = <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(one, D.m_[j * col + j]), <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(A.m_[i * col + j], sum));</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        }</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        sum = zero;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; i; k++)</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;            sum = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(sum, <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/pow.html">pow</a>(L.m_[i * col + k], i2), D.m_[k * col + k]));</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        D.m_[i * col + i] = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(A.m_[i * col + i], sum);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    }</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;}</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160; </div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="comment">// SymPy&#39;s cholesky decomposition</span></div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="keywordtype">void</span> cholesky(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;L)</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;{</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    SYMENGINE_ASSERT(A.row_ == A.col_);</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    SYMENGINE_ASSERT(L.row_ == A.row_ and L.col_ == A.row_);</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160; </div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="keywordtype">unsigned</span> col = A.col_;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <span class="keywordtype">unsigned</span> i, j, k;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    RCP&lt;const Basic&gt; sum;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    RCP&lt;const Basic&gt; i2 = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(2);</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    RCP&lt;const Basic&gt; half = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(one, i2);</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160; </div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="comment">// Initialize L</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; col; i++)</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; col; j++)</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;            L.m_[i * col + j] = zero;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160; </div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    for (i = 0; i &lt; col; i++) {</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; i; j++) {</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;            sum = zero;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;            <span class="keywordflow">for</span> (k = 0; k &lt; j; k++)</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                sum = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(sum, <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(L.m_[i * col + k], L.m_[j * col + k]));</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160; </div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;            L.m_[i * col + j]</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                = <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(<a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(one, L.m_[j * col + j]), <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(A.m_[i * col + j], sum));</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        }</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        sum = zero;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        <span class="keywordflow">for</span> (k = 0; k &lt; i; k++)</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            sum = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(sum, <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/pow.html">pow</a>(L.m_[i * col + k], i2));</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        L.m_[i * col + i] = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/pow.html">pow</a>(<a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(A.m_[i * col + i], sum), half);</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    }</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;}</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160; </div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="comment">// Matrix Queries</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="keywordtype">bool</span> is_symmetric_dense(<span class="keyword">const</span> DenseMatrix &amp;A)</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;{</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="keywordflow">if</span> (A.col_ != A.row_)</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160; </div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="keywordtype">unsigned</span> col = A.col_;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="keywordtype">bool</span> sym = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160; </div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; col; i++)</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = i + 1; j &lt; col; j++)</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;            <span class="keywordflow">if</span> (not <a class="code" href="namespaceSymEngine.html#a2861dd1747fa1416cd6ef023ef08fca5">eq</a>(*(A.m_[j * col + i]), *(A.m_[i * col + j]))) {</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;                sym = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;            }</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160; </div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="keywordflow">return</span> sym;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;}</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160; </div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="comment">// ----------------------------- Determinant ---------------------------------//</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;RCP&lt;const Basic&gt; det_bareis(<span class="keyword">const</span> DenseMatrix &amp;A)</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;{</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    SYMENGINE_ASSERT(A.row_ == A.col_);</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160; </div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordtype">unsigned</span> n = A.row_;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;    <span class="keywordflow">if</span> (n == 1) {</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        <span class="keywordflow">return</span> A.m_[0];</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n == 2) {</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        <span class="comment">// If A = [[a, b], [c, d]] then det(A) = ad - bc</span></div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[0], A.m_[3]), <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[1], A.m_[2]));</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n == 3) {</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        <span class="comment">// if A = [[a, b, c], [d, e, f], [g, h, i]] then</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <span class="comment">// det(A) = (aei + bfg + cdh) - (ceg + bdi + afh)</span></div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(<a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[0], A.m_[4]), A.m_[8]),</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                           <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[1], A.m_[5]), A.m_[6])),</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                       <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[2], A.m_[3]), A.m_[7])),</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                   <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(<a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[2], A.m_[4]), A.m_[6]),</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                           <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[1], A.m_[3]), A.m_[8])),</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                       <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[0], A.m_[5]), A.m_[7])));</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160; </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        <span class="keywordflow">if</span> (A.is_lower() or A.is_upper()) {</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;            RCP&lt;const Basic&gt; det = A.m_[0];</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 1; i &lt; n; ++i) {</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;                det = <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(det, A.m_[i * n + i]);</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;            }</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;            <span class="keywordflow">return</span> det;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;        }</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160; </div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        DenseMatrix B = DenseMatrix(n, n, A.m_);</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <span class="keywordtype">unsigned</span> i, <a class="code" href="namespaceSymEngine.html#a354804803424321111913a4071ca837e">sign</a> = 1;</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        RCP&lt;const Basic&gt; d;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160; </div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; n - 1; k++) {</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;            <span class="keywordflow">if</span> (is_true(<a class="code" href="namespaceSymEngine.html#ab930e860c8b1ff6cd03daff9c60c819a">is_zero</a>(*B.m_[k * n + k]))) {</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                <span class="keywordflow">for</span> (i = k + 1; i &lt; n; i++)</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                    <span class="keywordflow">if</span> (!is_true(<a class="code" href="namespaceSymEngine.html#ab930e860c8b1ff6cd03daff9c60c819a">is_zero</a>(*B.m_[i * n + k]))) {</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                        row_exchange_dense(B, i, k);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;                        <a class="code" href="namespaceSymEngine.html#a354804803424321111913a4071ca837e">sign</a> *= -1;</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;                    }</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;                <span class="keywordflow">if</span> (i == n)</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;                    <span class="keywordflow">return</span> zero;</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;            }</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;            <span class="keywordflow">for</span> (i = k + 1; i &lt; n; i++) {</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = k + 1; j &lt; n; j++) {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;                    d = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(B.m_[k * n + k], B.m_[i * n + j]),</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                            <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(B.m_[i * n + k], B.m_[k * n + j]));</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;                    <span class="keywordflow">if</span> (k &gt; 0)</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;                        d = <a class="codeRef" href="http://en.cppreference.com/w/cpp/numeric/math/div.html">div</a>(d, B.m_[(k - 1) * n + k - 1]);</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;                    B.m_[i * n + j] = d;</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                }</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;            }</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        }</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160; </div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        <span class="keywordflow">return</span> (sign == 1) ? B.m_[n * n - 1] : <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(minus_one, B.m_[n * n - 1]);</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    }</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;}</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160; </div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="comment">// Returns the coefficients of characterisitc polynomials of leading principal</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="comment">// minors of Matrix A as elements in `polys`. Principal leading minor of kth</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="comment">// order is the submatrix of A obtained by deleting last n-k rows and columns</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="comment">// from A. Here `n` is the dimension of the square matrix A.</span></div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="keywordtype">void</span> berkowitz(<span class="keyword">const</span> DenseMatrix &amp;A, <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;DenseMatrix&gt;</a> &amp;polys)</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;{</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    SYMENGINE_ASSERT(A.row_ == A.col_);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; </div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="keywordtype">unsigned</span> col = A.col_;</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <span class="keywordtype">unsigned</span> i, k, l, m;</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160; </div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;DenseMatrix&gt;</a> items;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;DenseMatrix&gt;</a> transforms;</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;RCP&lt;const Basic&gt;</a>&gt; items_;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160; </div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> n = col; n &gt; 1; n--) {</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        items.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/clear.html">clear</a>();</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        k = n - 1;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;        DenseMatrix T = DenseMatrix(n + 1, n);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        DenseMatrix C = DenseMatrix(k, 1);</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        <span class="comment">// Initialize T and C</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; n * (n + 1); i++)</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;            T.m_[i] = zero;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        for (i = 0; i &lt; k; i++)</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;            C.m_[i] = A.m_[i * col + k];</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        items.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(C);</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160; </div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; n - 2; i++) {</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;            DenseMatrix B = DenseMatrix(k, 1);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;            <span class="keywordflow">for</span> (l = 0; l &lt; k; l++) {</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;                B.m_[l] = zero;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                <span class="keywordflow">for</span> (m = 0; m &lt; k; m++)</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;                    B.m_[l]</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                        = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(B.m_[l], <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[l * col + m], items[i].m_[m]));</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;            }</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            items.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(B);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        }</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160; </div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        items_.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/clear.html">clear</a>();</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; n - 1; i++) {</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;            RCP&lt;const Basic&gt; element = zero;</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;            <span class="keywordflow">for</span> (l = 0; l &lt; k; l++)</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                element = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(element, <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[k * col + l], items[i].m_[l]));</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;            items_.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(minus_one, element));</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;        }</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;        items_.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/insert.html">insert</a>(items_.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(minus_one, A.m_[k * col + k]));</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;        items_.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/insert.html">insert</a>(items_.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/begin.html">begin</a>(), one);</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160; </div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;            <span class="keywordflow">for</span> (l = 0; l &lt; n - i + 1; l++)</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;                T.m_[(i + l) * n + i] = items_[l];</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        }</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160; </div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;        transforms.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(T);</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    }</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160; </div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    polys.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(DenseMatrix(2, 1, {one, <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[0], minus_one)}));</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160; </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; col - 1; i++) {</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        <span class="keywordtype">unsigned</span> t_row = transforms[col - 2 - i].nrows();</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        <span class="keywordtype">unsigned</span> t_col = transforms[col - 2 - i].ncols();</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;        DenseMatrix B = DenseMatrix(t_row, 1);</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160; </div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;        <span class="keywordflow">for</span> (l = 0; l &lt; t_row; l++) {</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;            B.m_[l] = zero;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;            <span class="keywordflow">for</span> (m = 0; m &lt; t_col; m++) {</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                B.m_[l] = <a class="code" href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">add</a>(B.m_[l],</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;                              <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(transforms[col - 2 - i].m_[l * t_col + m],</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;                                  polys[i].m_[m]));</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;                B.m_[l] = <a class="code" href="namespaceSymEngine.html#ac104d13f145416cd18c61b0121017eb6">expand</a>(B.m_[l]);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;            }</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        }</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;        polys.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">push_back</a>(B);</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    }</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;}</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160; </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;RCP&lt;const Basic&gt; det_berkowitz(<span class="keyword">const</span> DenseMatrix &amp;A)</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;{</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;DenseMatrix&gt;</a> polys;</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160; </div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    berkowitz(A, polys);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;    DenseMatrix poly = polys[polys.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() - 1];</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160; </div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;    <span class="keywordflow">if</span> (polys.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() % 2 == 1)</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(minus_one, poly.get(poly.nrows() - 1, 0));</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160; </div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="keywordflow">return</span> poly.get(poly.nrows() - 1, 0);</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;}</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160; </div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;<span class="keywordtype">void</span> char_poly(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;B)</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;{</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    SYMENGINE_ASSERT(B.ncols() == 1 and B.nrows() == A.nrows() + 1);</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    SYMENGINE_ASSERT(A.nrows() == A.ncols());</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160; </div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector&lt;DenseMatrix&gt;</a> polys;</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160; </div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    berkowitz(A, polys);</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    B = polys[polys.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector/size.html">size</a>() - 1];</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;}</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160; </div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="keywordtype">void</span> inverse_fraction_free_LU(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;B)</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;{</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    SYMENGINE_ASSERT(A.row_ == A.col_ and B.row_ == B.col_</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                     and B.row_ == A.row_);</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160; </div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <span class="keywordtype">unsigned</span> n = A.row_, i;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    DenseMatrix LU = DenseMatrix(n, n);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    DenseMatrix e = DenseMatrix(n, 1);</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    DenseMatrix x = DenseMatrix(n, 1);</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    DenseMatrix x_ = DenseMatrix(n, 1);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160; </div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="comment">// Initialize matrices</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; n * n; i++) {</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        LU.m_[i] = zero;</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        B.m_[i] = zero;</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    }</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        e.m_[i] = zero;</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;        x.m_[i] = zero;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        x_.m_[i] = zero;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    }</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160; </div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    fraction_free_LU(A, LU);</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160; </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    <span class="comment">// We solve AX_{i} = e_{i} for i = 1, 2, .. n and combine the row vectors</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    <span class="comment">// X_{1}, X_{2}, ... X_{n} to form the inverse of A. Here, e_{i}&#39;s are the</span></div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    <span class="comment">// elements of the standard basis.</span></div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; n; j++) {</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;        e.m_[j] = one;</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160; </div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        forward_substitution(LU, e, x_);</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        back_substitution(LU, x_, x);</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160; </div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;            B.m_[i * n + j] = x.m_[i];</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160; </div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        e.m_[j] = zero;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    }</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;}</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160; </div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="keywordtype">void</span> inverse_LU(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;B)</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;{</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;    SYMENGINE_ASSERT(A.row_ == A.col_ and B.row_ == B.col_</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;                     and B.row_ == A.row_);</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    DenseMatrix e = DenseMatrix(A.row_, A.col_);</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    eye(e);</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    LU_solve(A, e, B);</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;}</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160; </div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="keywordtype">void</span> inverse_pivoted_LU(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;B)</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;{</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    SYMENGINE_ASSERT(A.row_ == A.col_ and B.row_ == B.col_</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;                     and B.row_ == A.row_);</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    DenseMatrix e = DenseMatrix(A.row_, A.col_);</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    eye(e);</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    pivoted_LU_solve(A, e, B);</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;}</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160; </div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="keywordtype">void</span> inverse_gauss_jordan(<span class="keyword">const</span> DenseMatrix &amp;A, DenseMatrix &amp;B)</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;{</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    SYMENGINE_ASSERT(A.row_ == A.col_ and B.row_ == B.col_</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;                     and B.row_ == A.row_);</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160; </div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <span class="keywordtype">unsigned</span> n = A.row_;</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    DenseMatrix e = DenseMatrix(n, n);</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160; </div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <span class="comment">// Initialize matrices</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; n; i++)</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; n; j++) {</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;            <span class="keywordflow">if</span> (i != j) {</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                e.m_[i * n + j] = zero;</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;                e.m_[i * n + i] = one;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;            }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;            B.m_[i * n + j] = zero;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        }</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;    fraction_free_gauss_jordan_solve(A, e, B);</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;}</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160; </div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="comment">// ----------------------- Vector-specific Methods --------------------------//</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160; </div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="keywordtype">void</span> dot(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> DenseMatrix &amp;B, DenseMatrix &amp;C)</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;{</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <span class="keywordflow">if</span> (A.col_ == B.row_) {</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        <span class="keywordflow">if</span> (B.col_ != 1) {</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;            DenseMatrix tmp1 = DenseMatrix(A.col_, A.row_);</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;            A.transpose(tmp1);</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;            DenseMatrix tmp2 = DenseMatrix(B.col_, B.row_);</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;            B.transpose(tmp2);</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;            C.resize(tmp1.row_, tmp2.col_);</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;            mul_dense_dense(tmp1, tmp2, C);</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;            C.resize(A.row_, B.col_);</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;            mul_dense_dense(A, B, C);</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        }</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        C.resize(1, C.row_ * C.col_);</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (A.col_ == B.col_) {</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        DenseMatrix tmp2 = DenseMatrix(B.col_, B.row_);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        B.transpose(tmp2);</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        dot(A, tmp2, C);</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (A.row_ == B.row_) {</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        DenseMatrix tmp1 = DenseMatrix(A.col_, A.row_);</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;        A.transpose(tmp1);</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        dot(tmp1, B, C);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        <span class="keywordflow">throw</span> SymEngineException(<span class="stringliteral">&quot;Dimensions incorrect for dot product&quot;</span>);</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    }</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;}</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160; </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;<span class="keywordtype">void</span> cross(<span class="keyword">const</span> DenseMatrix &amp;A, <span class="keyword">const</span> DenseMatrix &amp;B, DenseMatrix &amp;C)</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;{</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    SYMENGINE_ASSERT((A.row_ * A.col_ == 3 and B.row_ * B.col_ == 3)</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;                     and (A.row_ == C.row_ and A.col_ == C.col_));</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160; </div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    C.m_[0] = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[1], B.m_[2]), <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[2], B.m_[1]));</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;    C.m_[1] = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[2], B.m_[0]), <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[0], B.m_[2]));</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    C.m_[2] = <a class="code" href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">sub</a>(<a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[0], B.m_[1]), <a class="code" href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">mul</a>(A.m_[1], B.m_[0]));</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;}</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160; </div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;RCP&lt;const Set&gt; eigen_values(<span class="keyword">const</span> DenseMatrix &amp;A)</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;{</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;    <span class="keywordtype">unsigned</span> n = A.nrows();</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    <span class="keywordflow">if</span> (A.is_lower() or A.is_upper()) {</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;        RCP&lt;const Set&gt; eigenvals = <a class="code" href="namespaceSymEngine.html#a2eb0d05b781ff2948b07f612f83a82bc">emptyset</a>();</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        set_basic x;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; n; ++i) {</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;            x.<a class="codeRef" href="http://en.cppreference.com/w/cpp/container/set/insert.html">insert</a>(A.get(i, i));</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        }</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        eigenvals = <a class="code" href="namespaceSymEngine.html#abbdc2f1f3c92c9560d10a5b7998e33e3">finiteset</a>(x);</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;        <span class="keywordflow">return</span> eigenvals;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    }</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160; </div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    DenseMatrix B = DenseMatrix(A.nrows() + 1, 1);</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;    char_poly(A, B);</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    map_int_Expr coeffs;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    <span class="keyword">auto</span> nr = A.nrows();</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt;= nr; i++)</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        <a class="code" href="namespaceSymEngine.html#a8a0fa36d4fbff063bb37b9893c4e6354">insert</a>(coeffs, nr - i, B.get(i, 0));</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    <span class="keyword">auto</span> lambda = <a class="code" href="namespaceSymEngine.html#a1f382b48b9cb214e1017d0e11fd3e6d6">symbol</a>(<span class="stringliteral">&quot;lambda&quot;</span>);</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    <span class="keywordflow">return</span> solve_poly(uexpr_poly(lambda, coeffs), lambda);</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;}</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160; </div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="comment">// ------------------------- NumPy-like functions ----------------------------//</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160; </div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="comment">// Mimic `eye` function in NumPy</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;<span class="keywordtype">void</span> eye(DenseMatrix &amp;A, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;{</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <span class="keywordflow">if</span> ((k &gt;= 0 and (<span class="keywordtype">unsigned</span>) k &gt;= A.col_) or k + A.row_ &lt;= 0) {</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        zeros(A);</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    }</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160; </div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    vec_basic v = vec_basic(k &gt; 0 ? A.col_ - k : A.row_ + k, one);</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160; </div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    diag(A, v, k);</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;}</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160; </div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="comment">// Create diagonal matrices directly</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;<span class="keywordtype">void</span> diag(DenseMatrix &amp;A, vec_basic &amp;v, <span class="keywordtype">int</span> k)</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;{</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    SYMENGINE_ASSERT(v.size() &gt; 0);</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160; </div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <span class="keywordtype">unsigned</span> k_ = std::abs(k);</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160; </div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    <span class="keywordflow">if</span> (k &gt;= 0) {</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; A.row_; i++) {</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; A.col_; j++) {</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;                <span class="keywordflow">if</span> (j != (<span class="keywordtype">unsigned</span>)k) {</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                    A.m_[i * A.col_ + j] = zero;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;                    A.m_[i * A.col_ + j] = v[k - k_];</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                }</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;            }</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;            k++;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        }</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        k = -k;</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160; </div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; A.col_; j++) {</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; A.row_; i++) {</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                <span class="keywordflow">if</span> (i != (<span class="keywordtype">unsigned</span>)k) {</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                    A.m_[i * A.col_ + j] = zero;</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                    A.m_[i * A.col_ + j] = v[k - k_];</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                }</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;            }</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;            k++;</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        }</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    }</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;}</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160; </div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment">// Create a matrix filled with ones</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="keywordtype">void</span> ones(DenseMatrix &amp;A)</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;{</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; A.row_ * A.col_; i++) {</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        A.m_[i] = one;</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    }</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;}</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160; </div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment">// Create a matrix filled with zeros</span></div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="keywordtype">void</span> zeros(DenseMatrix &amp;A)</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;{</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; A.row_ * A.col_; i++) {</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        A.m_[i] = zero;</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    }</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;}</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160; </div>
<div class="line"><a name="l02062"></a><span class="lineno"><a class="line" href="classSymEngine_1_1DenseMatrix.html#adb2d3ba5dd8f5e79dff551efe8fd1be1"> 2062</a></span>&#160;<a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> DenseMatrix::dumps()<span class="keyword"> const</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="preprocessor">#if HAVE_SYMENGINE_RTTI</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostringstream.html">std::ostringstream</a> oss;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> major = SYMENGINE_MAJOR_VERSION;</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> minor = SYMENGINE_MINOR_VERSION;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    <a class="code" href="classSymEngine_1_1RCPBasicAwareOutputArchive.html">RCPBasicAwareOutputArchive&lt;cereal::PortableBinaryOutputArchive&gt;</a>{oss}(</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        major, minor, row_, col_, m_);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;    <span class="keywordflow">return</span> oss.<a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_ostringstream/str.html">str</a>();</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    <span class="keywordflow">throw</span> NotImplementedError(<span class="stringliteral">&quot;Serialization not implemented in no-rtti mode&quot;</span>);</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;}</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160; </div>
<div class="line"><a name="l02076"></a><span class="lineno"><a class="line" href="classSymEngine_1_1DenseMatrix.html#aa2a78b6ae52c80319f67464d2d696b1e"> 2076</a></span>&#160;<a class="code" href="classSymEngine_1_1DenseMatrix.html">DenseMatrix</a> DenseMatrix::loads(<span class="keyword">const</span> <a class="codeRef" href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a> &amp;serialized)</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;{</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="preprocessor">#if HAVE_SYMENGINE_RTTI</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> major, minor;</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="keywordtype">unsigned</span> row, col;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/container/vector.html">vec_basic</a> obj;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <a class="codeRef" href="http://en.cppreference.com/w/cpp/io/basic_istringstream.html">std::istringstream</a> iss(serialized);</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    <a class="code" href="classSymEngine_1_1RCPBasicAwareInputArchive.html">RCPBasicAwareInputArchive&lt;cereal::PortableBinaryInputArchive&gt;</a> iarchive{iss};</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    iarchive(major, minor);</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    <span class="keywordflow">if</span> (major != SYMENGINE_MAJOR_VERSION or minor != SYMENGINE_MINOR_VERSION) {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        <span class="keywordflow">throw</span> SerializationError(StreamFmt()</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;                                 &lt;&lt; <span class="stringliteral">&quot;SymEngine-&quot;</span> &lt;&lt; SYMENGINE_MAJOR_VERSION</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                                 &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; SYMENGINE_MINOR_VERSION</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                                 &lt;&lt; <span class="stringliteral">&quot; was asked to deserialize an object &quot;</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                                 &lt;&lt; <span class="stringliteral">&quot;created using SymEngine-&quot;</span> &lt;&lt; major &lt;&lt; <span class="stringliteral">&quot;.&quot;</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                                 &lt;&lt; minor &lt;&lt; <span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    }</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    iarchive(row, col, obj);</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSymEngine_1_1DenseMatrix.html">DenseMatrix</a>(row, col, <a class="codeRef" href="http://en.cppreference.com/w/cpp/utility/move.html">std::move</a>(obj));</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;    <span class="keywordflow">throw</span> NotImplementedError(<span class="stringliteral">&quot;Serialization not implemented in no-rtti mode&quot;</span>);</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;}</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160; </div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;} <span class="comment">// namespace SymEngine</span></div>
<div class="ttc" id="aadd_8h_html"><div class="ttname"><a href="add_8h.html">add.h</a></div><div class="ttdoc">Classes and functions relating to the binary operation of addition.</div></div>
<div class="ttc" id="abasic_istringstream_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_istringstream.html">std::istringstream</a></div></div>
<div class="ttc" id="abasic_ostringstream_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ostringstream.html">std::ostringstream</a></div></div>
<div class="ttc" id="abasic_string_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/string/basic_string.html">std::string</a></div></div>
<div class="ttc" id="abegin_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/begin.html">std::vector::begin</a></div><div class="ttdeci">T begin(T... args)</div></div>
<div class="ttc" id="aclassSymEngine_1_1Add_html_a55dff9563772a56967626d9697b4f6a3"><div class="ttname"><a href="classSymEngine_1_1Add.html#a55dff9563772a56967626d9697b4f6a3">SymEngine::Add::sub</a></div><div class="ttdeci">RCP&lt; const Basic &gt; sub(const RCP&lt; const Basic &gt; &amp;a, const RCP&lt; const Basic &gt; &amp;b)</div><div class="ttdoc">Substracts b from a.</div><div class="ttdef"><b>Definition:</b> <a href="add_8cpp_source.html#l00495">add.cpp:495</a></div></div>
<div class="ttc" id="aclassSymEngine_1_1Add_html_ab2c2fd8b576973746d871681781e7130"><div class="ttname"><a href="classSymEngine_1_1Add.html#ab2c2fd8b576973746d871681781e7130">SymEngine::Add::add</a></div><div class="ttdeci">RCP&lt; const Basic &gt; add(const RCP&lt; const Basic &gt; &amp;a, const RCP&lt; const Basic &gt; &amp;b)</div><div class="ttdoc">Adds two objects (safely).</div><div class="ttdef"><b>Definition:</b> <a href="add_8cpp_source.html#l00425">add.cpp:425</a></div></div>
<div class="ttc" id="aclassSymEngine_1_1DenseMatrix_html"><div class="ttname"><a href="classSymEngine_1_1DenseMatrix.html">SymEngine::DenseMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix_8h_source.html#l00111">matrix.h:112</a></div></div>
<div class="ttc" id="aclassSymEngine_1_1RCPBasicAwareInputArchive_html"><div class="ttname"><a href="classSymEngine_1_1RCPBasicAwareInputArchive.html">SymEngine::RCPBasicAwareInputArchive</a></div><div class="ttdef"><b>Definition:</b> <a href="serialize-cereal_8h_source.html#l00068">serialize-cereal.h:69</a></div></div>
<div class="ttc" id="aclassSymEngine_1_1RCPBasicAwareOutputArchive_html"><div class="ttname"><a href="classSymEngine_1_1RCPBasicAwareOutputArchive.html">SymEngine::RCPBasicAwareOutputArchive</a></div><div class="ttdef"><b>Definition:</b> <a href="serialize-cereal_8h_source.html#l00029">serialize-cereal.h:30</a></div></div>
<div class="ttc" id="aclear_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/clear.html">std::vector::clear</a></div><div class="ttdeci">T clear(T... args)</div></div>
<div class="ttc" id="adiv_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/numeric/math/div.html">std::div</a></div><div class="ttdeci">T div(T... args)</div></div>
<div class="ttc" id="afunctions_8h_html"><div class="ttname"><a href="functions_8h.html">functions.h</a></div></div>
<div class="ttc" id="aget_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/memory/unique_ptr/get.html">std::unique_ptr::get</a></div><div class="ttdeci">T get(T... args)</div></div>
<div class="ttc" id="ainsert_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/insert.html">std::vector::insert</a></div><div class="ttdeci">T insert(T... args)</div></div>
<div class="ttc" id="amove_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/utility/move.html">std::move</a></div><div class="ttdeci">T move(T... args)</div></div>
<div class="ttc" id="anamespaceSymEngine_html"><div class="ttname"><a href="namespaceSymEngine.html">SymEngine</a></div><div class="ttdoc">Main namespace for SymEngine package.</div><div class="ttdef"><b>Definition:</b> <a href="add_8cpp_source.html#l00018">add.cpp:19</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a17c4fb234fb676cbdcd3e5b19a559356"><div class="ttname"><a href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">SymEngine::integer</a></div><div class="ttdeci">std::enable_if&lt; std::is_integral&lt; T &gt;::value, RCP&lt; const Integer &gt; &gt;::type integer(T i)</div><div class="ttdef"><b>Definition:</b> <a href="integer_8h_source.html#l00197">integer.h:197</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a1998df939d1b28e0356a43f33433d9d3"><div class="ttname"><a href="namespaceSymEngine.html#a1998df939d1b28e0356a43f33433d9d3">SymEngine::is_number_and_zero</a></div><div class="ttdeci">bool is_number_and_zero(const Basic &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="number_8h_source.html#l00139">number.h:139</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a1f382b48b9cb214e1017d0e11fd3e6d6"><div class="ttname"><a href="namespaceSymEngine.html#a1f382b48b9cb214e1017d0e11fd3e6d6">SymEngine::symbol</a></div><div class="ttdeci">RCP&lt; const Symbol &gt; symbol(const std::string &amp;name)</div><div class="ttdoc">inline version to return Symbol</div><div class="ttdef"><b>Definition:</b> <a href="symbol_8h_source.html#l00082">symbol.h:82</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a2861dd1747fa1416cd6ef023ef08fca5"><div class="ttname"><a href="namespaceSymEngine.html#a2861dd1747fa1416cd6ef023ef08fca5">SymEngine::eq</a></div><div class="ttdeci">bool eq(const Basic &amp;a, const Basic &amp;b)</div><div class="ttdoc">Checks equality for a and b</div><div class="ttdef"><b>Definition:</b> <a href="basic-inl_8h_source.html#l00021">basic-inl.h:21</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a2eb0d05b781ff2948b07f612f83a82bc"><div class="ttname"><a href="namespaceSymEngine.html#a2eb0d05b781ff2948b07f612f83a82bc">SymEngine::emptyset</a></div><div class="ttdeci">RCP&lt; const EmptySet &gt; emptyset()</div><div class="ttdef"><b>Definition:</b> <a href="sets_8h_source.html#l00590">sets.h:590</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a354804803424321111913a4071ca837e"><div class="ttname"><a href="namespaceSymEngine.html#a354804803424321111913a4071ca837e">SymEngine::sign</a></div><div class="ttdeci">RCP&lt; const Basic &gt; sign(const RCP&lt; const Basic &gt; &amp;arg)</div><div class="ttdoc">Canonicalize Sign.</div><div class="ttdef"><b>Definition:</b> <a href="functions_8cpp_source.html#l00527">functions.cpp:527</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a3deecb23288ff261b9534dbe7291cf7b"><div class="ttname"><a href="namespaceSymEngine.html#a3deecb23288ff261b9534dbe7291cf7b">SymEngine::abs</a></div><div class="ttdeci">RCP&lt; const Basic &gt; abs(const RCP&lt; const Basic &gt; &amp;arg)</div><div class="ttdoc">Canonicalize Abs:</div><div class="ttdef"><b>Definition:</b> <a href="functions_8cpp_source.html#l03492">functions.cpp:3492</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a896396e3101c37df65e7a2b46fc7cadd"><div class="ttname"><a href="namespaceSymEngine.html#a896396e3101c37df65e7a2b46fc7cadd">SymEngine::mul</a></div><div class="ttdeci">RCP&lt; const Basic &gt; mul(const RCP&lt; const Basic &gt; &amp;a, const RCP&lt; const Basic &gt; &amp;b)</div><div class="ttdoc">Multiplication.</div><div class="ttdef"><b>Definition:</b> <a href="mul_8cpp_source.html#l00352">mul.cpp:352</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a8a0fa36d4fbff063bb37b9893c4e6354"><div class="ttname"><a href="namespaceSymEngine.html#a8a0fa36d4fbff063bb37b9893c4e6354">SymEngine::insert</a></div><div class="ttdeci">void insert(T1 &amp;m, const T2 &amp;first, const T3 &amp;second)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8h_source.html#l00083">dict.h:83</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_ab930e860c8b1ff6cd03daff9c60c819a"><div class="ttname"><a href="namespaceSymEngine.html#ab930e860c8b1ff6cd03daff9c60c819a">SymEngine::is_zero</a></div><div class="ttdeci">tribool is_zero(const Basic &amp;b, const Assumptions *assumptions=nullptr)</div><div class="ttdoc">Check if a number is zero.</div><div class="ttdef"><b>Definition:</b> <a href="test__visitors_8cpp_source.html#l00082">test_visitors.cpp:82</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_abbdc2f1f3c92c9560d10a5b7998e33e3"><div class="ttname"><a href="namespaceSymEngine.html#abbdc2f1f3c92c9560d10a5b7998e33e3">SymEngine::finiteset</a></div><div class="ttdeci">RCP&lt; const Set &gt; finiteset(const set_basic &amp;container)</div><div class="ttdef"><b>Definition:</b> <a href="sets_8h_source.html#l00602">sets.h:602</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_ac104d13f145416cd18c61b0121017eb6"><div class="ttname"><a href="namespaceSymEngine.html#ac104d13f145416cd18c61b0121017eb6">SymEngine::expand</a></div><div class="ttdeci">RCP&lt; const Basic &gt; expand(const RCP&lt; const Basic &gt; &amp;self, bool deep=true)</div><div class="ttdoc">Expands self</div><div class="ttdef"><b>Definition:</b> <a href="expand_8cpp_source.html#l00369">expand.cpp:369</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_ae459921e036f06869a8d53b0f019c0c3"><div class="ttname"><a href="namespaceSymEngine.html#ae459921e036f06869a8d53b0f019c0c3">SymEngine::ssubs</a></div><div class="ttdeci">RCP&lt; const Basic &gt; ssubs(const RCP&lt; const Basic &gt; &amp;x, const map_basic_basic &amp;subs_dict, bool cache=true)</div><div class="ttdoc">SymPy compatible subs.</div><div class="ttdef"><b>Definition:</b> <a href="subs_8h_source.html#l00559">subs.h:559</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_af02f97d82354b66c939ae206f0057edd"><div class="ttname"><a href="namespaceSymEngine.html#af02f97d82354b66c939ae206f0057edd">SymEngine::conjugate</a></div><div class="ttdeci">RCP&lt; const Basic &gt; conjugate(const RCP&lt; const Basic &gt; &amp;arg)</div><div class="ttdoc">Canonicalize Conjugate.</div><div class="ttdef"><b>Definition:</b> <a href="functions_8cpp_source.html#l00149">functions.cpp:149</a></div></div>
<div class="ttc" id="anumber_8h_html"><div class="ttname"><a href="number_8h.html">number.h</a></div></div>
<div class="ttc" id="apow_8h_html"><div class="ttname"><a href="pow_8h.html">pow.h</a></div></div>
<div class="ttc" id="apow_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/numeric/math/pow.html">std::pow</a></div><div class="ttdeci">T pow(T... args)</div></div>
<div class="ttc" id="apush_back_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/push_back.html">std::vector::push_back</a></div><div class="ttdeci">T push_back(T... args)</div></div>
<div class="ttc" id="asize_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector/size.html">std::vector::size</a></div><div class="ttdeci">T size(T... args)</div></div>
<div class="ttc" id="asolve_8h_html"><div class="ttname"><a href="solve_8h.html">solve.h</a></div></div>
<div class="ttc" id="astr_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/io/basic_ostringstream/str.html">std::ostringstream::str</a></div><div class="ttdeci">T str(T... args)</div></div>
<div class="ttc" id="aswap_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/algorithm/swap.html">std::swap</a></div><div class="ttdeci">T swap(T... args)</div></div>
<div class="ttc" id="aunique_ptr_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/memory/unique_ptr.html">std::unique_ptr</a></div></div>
<div class="ttc" id="avector_html"><div class="ttname"><a href="http://en.cppreference.com/w/cpp/container/vector.html">std::vector</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div class="footer">
<hr class="footline"/><address class="footline"><small>
    Generated by&#160;<a href="https://www.doxygen.org/index.html">Doxygen 1.9.1</a> and the <a class="outlink" href="https://github.com/HaoZeke/doxyYoda">doxyYoda theme</a>
</small></address>
</div>
</div>
</body>
</html>
