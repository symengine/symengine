<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SymEngine C++ API: /home/runner/work/symengine/symengine/symengine/ntheory.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: {
    fontCache: 'global'
  }
  loader: { load: ["[tex]/unicode", "[tex]/ams"] },
  tex: {
    packages: { "[+]": ["unicode", "ams"] },
    tags: "ams",
  },
};
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
</script>
<!-- <link href="doxygen.css" rel="stylesheet" type="text/css" /> -->
<link href="doxyYoda.min.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" >
$(document).ready(function() {
     $(".fragment").wrap("<details class='code-details'></details>");
     $(".code-details").append("<summary>Code</summary>");
 }
)
</script>
</head>
<body>
<div class="grid-contents">
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<nav class="title_area">
<span class="project_info">SymEngine C++ API </span>
</nav>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_5f3c0b4b33d21f966cb3219df2063971.html">symengine</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">ntheory.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;valarray&gt;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;iterator&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;symengine/prime_sieve.h&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="ntheory_8h.html">symengine/ntheory.h</a>&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="rational_8h.html">symengine/rational.h</a>&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="add_8h.html">symengine/add.h</a>&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="mul_8h.html">symengine/mul.h</a>&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="pow_8h.html">symengine/pow.h</a>&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#ifdef HAVE_SYMENGINE_ECM</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;ecm.h&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// HAVE_SYMENGINE_ECM</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#ifdef HAVE_SYMENGINE_PRIMESIEVE</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;primesieve.hpp&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// HAVE_SYMENGINE_PRIMESIEVE</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#ifdef HAVE_SYMENGINE_ARB</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;mpfr.h&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;flint/fmpq.h&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;arb.h&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;bernoulli.h&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// HAVE_SYMENGINE_ARB</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#ifndef HAVE_SYMENGINE_GMP</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;boost/random/uniform_int.hpp&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;boost/random/mersenne_twister.hpp&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;boost/random.hpp&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// !HAVE_SYMENGINE_GMP</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceSymEngine.html">SymEngine</a></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// Basic number theoretic functions</span></div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a23e7d19677dfaf17bce40fd767860bfd">   32</a></span>&#160;RCP&lt;const Integer&gt; <a class="code" href="namespaceSymEngine.html#a23e7d19677dfaf17bce40fd767860bfd">gcd</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;a, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;b)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;{</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    integer_class g;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    mp_gcd(g, a.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), b.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>());</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(g));</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#abb07748aa4b318e5fb3cfc942dc7dafa">   39</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceSymEngine.html#abb07748aa4b318e5fb3cfc942dc7dafa">gcd_ext</a>(<span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;g, <span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;s,</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;             <span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;t, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;a,</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;             <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;b)</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;{</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    integer_class g_, s_, t_;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    mp_gcdext(g_, s_, t_, a.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), b.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>());</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    *g = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(g_));</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    *s = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(s_));</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    *t = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(t_));</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a6f8ad0107dc645c6ce7249c600385705">   50</a></span>&#160;RCP&lt;const Integer&gt; <a class="code" href="namespaceSymEngine.html#a6f8ad0107dc645c6ce7249c600385705">lcm</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;a, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;b)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    integer_class c;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    mp_lcm(c, a.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), b.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>());</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(c));</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a63b1ae053d374fb5602e1b03c236374c">   57</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceSymEngine.html#a63b1ae053d374fb5602e1b03c236374c">mod_inverse</a>(<span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;b, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;a,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;m)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;{</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">int</span> ret_val;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    integer_class inv_t;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    ret_val = mp_invert(inv_t, a.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), m.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>());</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    *b = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(inv_t));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">return</span> ret_val;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">   67</a></span>&#160;RCP&lt;const Integer&gt; <a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;d)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;{</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>() % d.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>());</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a5c23fd54b05baea713287388f27dd7dc">   72</a></span>&#160;RCP&lt;const Integer&gt; <a class="code" href="namespaceSymEngine.html#a5c23fd54b05baea713287388f27dd7dc">quotient</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;d)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;{</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>() / d.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>());</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#acde8c189ba1160ef22f427dec4701ded">   77</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceSymEngine.html#acde8c189ba1160ef22f427dec4701ded">quotient_mod</a>(<span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;q,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                  <span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;r, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;d)</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;{</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    integer_class _q, _r;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    mp_tdiv_qr(_q, _r, n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), d.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>());</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    *q = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(_q));</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    *r = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(_r));</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a5ac9764d835e82d5fdd4ab4cc36e11e1">   87</a></span>&#160;RCP&lt;const Integer&gt; <a class="code" href="namespaceSymEngine.html#a5ac9764d835e82d5fdd4ab4cc36e11e1">mod_f</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;d)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;{</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    integer_class q;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    mp_fdiv_r(q, n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), d.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>());</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(q));</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a450c28d700cf56dd4aae461c4ccdf602">   94</a></span>&#160;RCP&lt;const Integer&gt; <a class="code" href="namespaceSymEngine.html#a450c28d700cf56dd4aae461c4ccdf602">quotient_f</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;d)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;{</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    integer_class q;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    mp_fdiv_q(q, n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), d.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>());</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(q));</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a88a7c4cbf086869ae2c0c4bc9d181787">  101</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceSymEngine.html#a88a7c4cbf086869ae2c0c4bc9d181787">quotient_mod_f</a>(<span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;q,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                    <span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;r, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;d)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;{</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    integer_class _q, _r;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    mp_fdiv_qr(_q, _r, n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), d.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>());</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    *q = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(_q));</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    *r = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(_r));</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;}</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a4f08f9f6ba6fa0107e98940ca32249ca">  111</a></span>&#160;RCP&lt;const Integer&gt; <a class="code" href="namespaceSymEngine.html#a4f08f9f6ba6fa0107e98940ca32249ca">fibonacci</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;{</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    integer_class f;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    mp_fib_ui(f, n);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(f));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a140e1990268bd87d976940e2bb7ae461">  118</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceSymEngine.html#a140e1990268bd87d976940e2bb7ae461">fibonacci2</a>(<span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;g,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                <span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;s, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n)</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    integer_class g_t;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    integer_class s_t;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    mp_fib2_ui(g_t, s_t, n);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    *g = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(g_t));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    *s = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(s_t));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;}</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a40dcbecd5d0d50dbd7d997a5c800ae81">  128</a></span>&#160;RCP&lt;const Integer&gt; <a class="code" href="namespaceSymEngine.html#a40dcbecd5d0d50dbd7d997a5c800ae81">lucas</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;{</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    integer_class f;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    mp_lucnum_ui(f, n);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(f));</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#aff0d65ef819e6ee1328757e4acf3fb1e">  135</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceSymEngine.html#aff0d65ef819e6ee1328757e4acf3fb1e">lucas2</a>(<span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;g, <span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;s,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n)</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;{</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    integer_class g_t;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    integer_class s_t;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    mp_lucnum2_ui(g_t, s_t, n);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    *g = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(g_t));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    *s = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(s_t));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">// Binomial Coefficient</span></div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a732c7e01c607133ae54abd236d22d302">  146</a></span>&#160;RCP&lt;const Integer&gt; <a class="code" href="namespaceSymEngine.html#a732c7e01c607133ae54abd236d22d302">binomial</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> k)</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    integer_class f;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    mp_bin_ui(f, n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), k);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(f));</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;}</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">// Factorial</span></div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#ab01d70c771fdccc3c700fcd579272282">  154</a></span>&#160;RCP&lt;const Integer&gt; <a class="code" href="namespaceSymEngine.html#ab01d70c771fdccc3c700fcd579272282">factorial</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;{</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    integer_class f;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    mp_fac_ui(f, n);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(f));</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">// Returns true if `b` divides `a` without reminder</span></div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a0a30b2ef42d2d4605920f28e80b65e04">  162</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceSymEngine.html#a0a30b2ef42d2d4605920f28e80b65e04">divides</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;a, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;b)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;{</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keywordflow">return</span> mp_divisible_p(a.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), b.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>()) != 0;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;}</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">// Prime functions</span></div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#aa6868f339e15596c02c68e1d02f0a461">  168</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceSymEngine.html#aa6868f339e15596c02c68e1d02f0a461">probab_prime_p</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;a, <span class="keywordtype">unsigned</span> reps)</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;{</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">return</span> mp_probab_prime_p(a.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), reps);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;}</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a12011da4b72858d9a6134ba420e4575a">  173</a></span>&#160;RCP&lt;const Integer&gt; <a class="code" href="namespaceSymEngine.html#a12011da4b72858d9a6134ba420e4575a">nextprime</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;a)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;{</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    integer_class c;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    mp_nextprime(c, a.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>());</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(c));</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;}</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keyword">namespace</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;{</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">// Factoring by Trial division using primes only</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keywordtype">int</span> _factor_trial_division_sieve(integer_class &amp;<a class="code" href="namespaceSymEngine.html#aaf56a84de825e1940da213fd1ae6ff65">factor</a>, <span class="keyword">const</span> integer_class &amp;N)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;{</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    integer_class sqrtN = mp_sqrt(N);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> limit = mp_get_ui(sqrtN);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> (limit &gt; std::numeric_limits&lt;unsigned&gt;::max())</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">throw</span> SymEngineException(<span class="stringliteral">&quot;N too large to factor&quot;</span>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    Sieve::iterator pi(numeric_cast&lt;unsigned&gt;(limit));</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">unsigned</span> p;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">while</span> ((p = pi.next_prime()) &lt;= limit) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">if</span> (N % p == 0) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <a class="code" href="namespaceSymEngine.html#aaf56a84de825e1940da213fd1ae6ff65">factor</a> = p;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;}</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">// Factor using lehman method.</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="keywordtype">int</span> _factor_lehman_method(integer_class &amp;rop, <span class="keyword">const</span> integer_class &amp;n)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;{</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (n &lt; 21)</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">throw</span> SymEngineException(<span class="stringliteral">&quot;Require n &gt;= 21 to use lehman method&quot;</span>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">int</span> ret_val = 0;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    integer_class u_bound;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    mp_root(u_bound, n, 3);</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    u_bound = u_bound + 1;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    Sieve::iterator pi(numeric_cast&lt;unsigned&gt;(mp_get_ui(u_bound)));</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordtype">unsigned</span> p;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">while</span> ((p = pi.next_prime()) &lt;= mp_get_ui(u_bound)) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">if</span> (n % p == 0) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            rop = n / p;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            ret_val = 1;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span> (not ret_val) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        integer_class k, a, b, l;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        k = 1;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">while</span> (k &lt;= u_bound) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            a = mp_sqrt(4 * k * n);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            mp_root(b, n, 6);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            mp_root(l, k, 2);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            b = b / (4 * l);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            b = b + a;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordflow">while</span> (a &lt;= b) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                l = a * a - 4 * k * n;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <span class="keywordflow">if</span> (mp_perfect_square_p(l)) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                    b = a + mp_sqrt(l);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                    mp_gcd(rop, n, b);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                    ret_val = 1;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                a = a + 1;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="keywordflow">if</span> (ret_val)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            k = k + 1;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">return</span> ret_val;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;}</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;} <span class="comment">// anonymous namespace</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#adeea01ccd116f965ae18ccc76e43f7b7">  254</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceSymEngine.html#adeea01ccd116f965ae18ccc76e43f7b7">factor_lehman_method</a>(<span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;f, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n)</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;{</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordtype">int</span> ret_val;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    integer_class rop;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    ret_val = _factor_lehman_method(rop, n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>());</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    *f = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(rop));</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">return</span> ret_val;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keyword">namespace</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">// Factor using Pollard&#39;s p-1 method</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keywordtype">int</span> _factor_pollard_pm1_method(integer_class &amp;rop, <span class="keyword">const</span> integer_class &amp;n,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                               <span class="keyword">const</span> integer_class &amp;c, <span class="keywordtype">unsigned</span> B)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;{</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">if</span> (n &lt; 4 or B &lt; 3)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">throw</span> SymEngineException(</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="stringliteral">&quot;Require n &gt; 3 and B &gt; 2 to use Pollard&#39;s p-1 method&quot;</span>);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    integer_class m, _c;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    _c = c;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    Sieve::iterator pi(B);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="keywordtype">unsigned</span> p;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">while</span> ((p = pi.next_prime()) &lt;= B) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        m = 1;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="comment">// calculate log(p, B), this can be improved</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">while</span> (m &lt;= B / p) {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            m = m * p;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        mp_powm(_c, _c, m, n);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    _c = _c - 1;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    mp_gcd(rop, _c, n);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">if</span> (rop == 1 or rop == n)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;} <span class="comment">// anonymous namespace</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#aa62e9ba2232d0f8ec009f760cabf1451">  297</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceSymEngine.html#aa62e9ba2232d0f8ec009f760cabf1451">factor_pollard_pm1_method</a>(<span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;f,</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                              <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n, <span class="keywordtype">unsigned</span> B, <span class="keywordtype">unsigned</span> retries)</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;{</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordtype">int</span> ret_val = 0;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    integer_class rop, nm4, c;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <a class="code" href="classSymEngine_1_1mp__randstate.html">mp_randstate</a> state;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    nm4 = n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>() - 4;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; retries and ret_val == 0; ++i) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        state.urandomint(c, nm4);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        c += 2;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        ret_val = _factor_pollard_pm1_method(rop, n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), c, B);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; </div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">if</span> (ret_val != 0)</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        *f = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(rop));</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">return</span> ret_val;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;}</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="keyword">namespace</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;{</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">// Factor using Pollard&#39;s rho method</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keywordtype">int</span> _factor_pollard_rho_method(integer_class &amp;rop, <span class="keyword">const</span> integer_class &amp;n,</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                               <span class="keyword">const</span> integer_class &amp;a, <span class="keyword">const</span> integer_class &amp;s,</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                               <span class="keywordtype">unsigned</span> steps = 10000)</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;{</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span> (n &lt; 5)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">throw</span> SymEngineException(<span class="stringliteral">&quot;Require n &gt; 4 to use pollard&#39;s-rho method&quot;</span>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    integer_class u, v, g, m;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    u = s;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    v = s;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; steps; ++i) {</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        u = (u * u + a) % n;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        v = (v * v + a) % n;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        v = (v * v + a) % n;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        m = u - v;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        mp_gcd(g, m, n);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">if</span> (g == n)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">if</span> (g == 1)</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        rop = g;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;} <span class="comment">// namespace</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#aacc34ee92ca82122fd45ca21233dcd7c">  349</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceSymEngine.html#aacc34ee92ca82122fd45ca21233dcd7c">factor_pollard_rho_method</a>(<span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;f,</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                              <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n, <span class="keywordtype">unsigned</span> retries)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;{</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordtype">int</span> ret_val = 0;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    integer_class rop, nm1, nm4, a, s;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <a class="code" href="classSymEngine_1_1mp__randstate.html">mp_randstate</a> state;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    nm1 = n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>() - 1;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    nm4 = n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>() - 4;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; retries and ret_val == 0; ++i) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        state.urandomint(a, nm1);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        state.urandomint(s, nm4);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        s += 1;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        ret_val = _factor_pollard_rho_method(rop, n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), a, s);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">if</span> (ret_val != 0)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        *f = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(rop));</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">return</span> ret_val;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;}</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">// Factorization</span></div>
<div class="line"><a name="l00371"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#aaf56a84de825e1940da213fd1ae6ff65">  371</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceSymEngine.html#aaf56a84de825e1940da213fd1ae6ff65">factor</a>(<span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;f, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n, <span class="keywordtype">double</span> B1)</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;{</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keywordtype">int</span> ret_val = 0;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    integer_class _n, _f;</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    _n = n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>();</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor">#ifdef HAVE_SYMENGINE_ECM</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">if</span> (mp_perfect_power_p(_n)) {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i = 1;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        integer_class m, rem;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        rem = 1; <span class="comment">// Any non zero number</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        m = 2;   <span class="comment">// set `m` to 2**i, i = 1 at the begining</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="comment">// calculate log2n, this can be improved</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">for</span> (; m &lt; _n; ++i)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            m = m * 2;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="comment">// eventually `rem` = 0 zero as `n` is a perfect power. `f_t` will</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment">// be set to a factor of `n` when that happens</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">while</span> (i &gt; 1 and rem != 0) {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            mp_rootrem(_f, rem, _n, i);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            --i;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        ret_val = 1;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">if</span> (mp_probab_prime_p(_n, 25) &gt; 0) { <span class="comment">// most probably, n is a prime</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            ret_val = 0;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            _f = _n;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 10 and not ret_val; ++i)</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                ret_val = ecm_factor(get_mpz_t(_f), get_mpz_t(_n), B1, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            mp_demote(_f);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="keywordflow">if</span> (not ret_val)</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                <span class="keywordflow">throw</span> SymEngineException(</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                    <span class="stringliteral">&quot;ECM failed to factor the given number&quot;</span>);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">// B1 is discarded if gmp-ecm is not installed</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    ret_val = _factor_trial_division_sieve(_f, _n);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// HAVE_SYMENGINE_ECM</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    *f = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(_f));</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">return</span> ret_val;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;}</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a9b0de2f5516a819ee48b54f78ab23804">  422</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceSymEngine.html#a9b0de2f5516a819ee48b54f78ab23804">factor_trial_division</a>(<span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;f, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;{</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordtype">int</span> ret_val;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    integer_class <a class="code" href="namespaceSymEngine.html#aaf56a84de825e1940da213fd1ae6ff65">factor</a>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    ret_val = _factor_trial_division_sieve(<a class="code" href="namespaceSymEngine.html#aaf56a84de825e1940da213fd1ae6ff65">factor</a>, n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>());</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span> (ret_val == 1)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        *f = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(<a class="code" href="namespaceSymEngine.html#aaf56a84de825e1940da213fd1ae6ff65">factor</a>));</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">return</span> ret_val;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;}</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a6079112c36b3646e3a7f3cad0d31bc0b">  432</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceSymEngine.html#a6079112c36b3646e3a7f3cad0d31bc0b">prime_factors</a>(std::vector&lt;RCP&lt;const Integer&gt;&gt; &amp;prime_list,</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                   <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;{</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    integer_class sqrtN;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    integer_class _n = n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>();</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">if</span> (_n == 0)</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">if</span> (_n &lt; 0)</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        _n *= -1;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    sqrtN = mp_sqrt(_n);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keyword">auto</span> limit = mp_get_ui(sqrtN);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> (not mp_fits_ulong_p(sqrtN)</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        or limit &gt; std::numeric_limits&lt;unsigned&gt;::max())</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">throw</span> SymEngineException(<span class="stringliteral">&quot;N too large to factor&quot;</span>);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="classSymEngine_1_1Sieve_1_1iterator.html">Sieve::iterator</a> pi(numeric_cast&lt;unsigned&gt;(limit));</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="keywordtype">unsigned</span> p;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">while</span> ((p = pi.next_prime()) &lt;= limit) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">while</span> (_n % p == 0) {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;            prime_list.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(p));</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            _n = _n / p;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">if</span> (_n == 1)</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">if</span> (not(_n == 1))</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        prime_list.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(_n)));</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;}</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a20b4c6e1fb93393611e75807245f6a9b">  462</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceSymEngine.html#a20b4c6e1fb93393611e75807245f6a9b">prime_factor_multiplicities</a>(map_integer_uint &amp;primes_mul, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n)</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;{</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    integer_class sqrtN;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    integer_class _n = n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>();</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordtype">unsigned</span> count;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">if</span> (_n == 0)</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordflow">if</span> (_n &lt; 0)</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        _n *= -1;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    sqrtN = mp_sqrt(_n);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keyword">auto</span> limit = mp_get_ui(sqrtN);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">if</span> (not mp_fits_ulong_p(sqrtN)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        or limit &gt; std::numeric_limits&lt;unsigned&gt;::max())</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <span class="keywordflow">throw</span> SymEngineException(<span class="stringliteral">&quot;N too large to factor&quot;</span>);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <a class="code" href="classSymEngine_1_1Sieve_1_1iterator.html">Sieve::iterator</a> pi(numeric_cast&lt;unsigned&gt;(limit));</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordtype">unsigned</span> p;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">while</span> ((p = pi.next_prime()) &lt;= limit) {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        count = 0;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordflow">while</span> (_n % p == 0) { <span class="comment">// when a prime factor is found, we divide</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            ++count;          <span class="comment">// _n by that prime as much as we can</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            _n = _n / p;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        }</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keywordflow">if</span> (count &gt; 0) {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            <a class="code" href="namespaceSymEngine.html#a8a0fa36d4fbff063bb37b9893c4e6354">insert</a>(primes_mul, <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(p), count);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            <span class="keywordflow">if</span> (_n == 1)</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">if</span> (not(_n == 1))</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <a class="code" href="namespaceSymEngine.html#a8a0fa36d4fbff063bb37b9893c4e6354">insert</a>(primes_mul, <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(_n)), 1);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;}</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#ac68c11cddc00aaff59929b12e4f3cc8a">  496</a></span>&#160;RCP&lt;const Number&gt; <a class="code" href="namespaceSymEngine.html#ac68c11cddc00aaff59929b12e4f3cc8a">bernoulli</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n)</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;{</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor">#ifdef HAVE_SYMENGINE_ARB</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    fmpq_t res;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    fmpq_init(res);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    bernoulli_fmpq_ui(res, n);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    mpq_t a;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    mpq_init(a);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    fmpq_get_mpq(a, res);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    rational_class b(a);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    fmpq_clear(res);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    mpq_clear(a);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSymEngine_1_1Rational.html#a0bbb6880b55f4db457f8183b5db400ff">Rational::from_mpq</a>(std::move(b));</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="comment">// TODO: implement a faster algorithm</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    std::vector&lt;rational_class&gt; v(n + 1);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> m = 0; m &lt;= n; ++m) {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        v[m] = rational_class(1u, m + 1);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = m; j &gt;= 1; --j) {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            v[j - 1] = j * (v[j - 1] - v[j]);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    }</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSymEngine_1_1Rational.html#a0bbb6880b55f4db457f8183b5db400ff">Rational::from_mpq</a>(v[0]);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;}</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#addac89ed5ce6ed7617f90f7473a91214">  523</a></span>&#160;RCP&lt;const Number&gt; <a class="code" href="namespaceSymEngine.html#addac89ed5ce6ed7617f90f7473a91214">harmonic</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> n, <span class="keywordtype">long</span> m)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;{</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    rational_class res(0);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">if</span> (m == 1) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 1; i &lt;= n; ++i) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            res += rational_class(1u, i);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classSymEngine_1_1Rational.html#a0bbb6880b55f4db457f8183b5db400ff">Rational::from_mpq</a>(res);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 1; i &lt;= n; ++i) {</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="keywordflow">if</span> (m &gt; 0) {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                rational_class t(1u, i);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">#if SYMENGINE_INTEGER_CLASS != SYMENGINE_BOOSTMP</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                mp_pow_ui(get_den(t), get_den(t), m);</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                mp_pow_ui(t, t, m);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                res += t;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                integer_class t(i);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                mp_pow_ui(t, t, <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span><span class="keyword">&gt;</span>(-m));</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                res += t;</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classSymEngine_1_1Rational.html#a0bbb6880b55f4db457f8183b5db400ff">Rational::from_mpq</a>(res);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;}</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">// References : Cohen H., A course in computational algebraic number theory</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">// (1996), page 21.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#aad612bc5c47da71cc70cfb11b5ef6344">  553</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceSymEngine.html#aad612bc5c47da71cc70cfb11b5ef6344">crt</a>(<span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;R,</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;         <span class="keyword">const</span> std::vector&lt;RCP&lt;const Integer&gt;&gt; &amp;rem,</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;         <span class="keyword">const</span> std::vector&lt;RCP&lt;const Integer&gt;&gt; &amp;<a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>)</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;{</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>.size() &gt; rem.size())</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">throw</span> SymEngineException(<span class="stringliteral">&quot;Too few remainders&quot;</span>);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>.size() == 0)</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordflow">throw</span> SymEngineException(<span class="stringliteral">&quot;Moduli vector cannot be empty&quot;</span>);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    integer_class m, r, g, s, t;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    m = <a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>[0]-&gt;as_integer_class();</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    r = rem[0]-&gt;as_integer_class();</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 1; i &lt; <a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>.size(); ++i) {</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        mp_gcdext(g, s, t, m, <a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>[i]-&gt;as_integer_class());</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <span class="comment">// g = s * m + t * mod[i]</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        t = rem[i]-&gt;as_integer_class() - r;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keywordflow">if</span> (not mp_divisible_p(t, g))</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;        r += m * s * (t / g); <span class="comment">// r += m * (m**-1 mod[i]/g)* (rem[i] - r) / g</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        m *= <a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>[i]-&gt;as_integer_class() / g;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        mp_fdiv_r(r, r, m);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    *R = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(r));</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;}</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="keyword">namespace</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;{</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">// Crt over a cartesian product of vectors (Assuming that moduli are pairwise</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">// relatively prime).</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="keywordtype">void</span> _crt_cartesian(std::vector&lt;RCP&lt;const Integer&gt;&gt; &amp;R,</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                    <span class="keyword">const</span> std::vector&lt;std::vector&lt;RCP&lt;const Integer&gt;&gt;&gt; &amp;rem,</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                    <span class="keyword">const</span> std::vector&lt;RCP&lt;const Integer&gt;&gt; &amp;<a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;{</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>.size() &gt; rem.size())</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="keywordflow">throw</span> SymEngineException(<span class="stringliteral">&quot;Too few remainders&quot;</span>);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>.size() == 0)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keywordflow">throw</span> SymEngineException(<span class="stringliteral">&quot;Moduli vector cannot be empty&quot;</span>);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    integer_class m, _m, r, s, t;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    m = <a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>[0]-&gt;as_integer_class();</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    R = rem[0];</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 1; i &lt; <a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>.size(); ++i) {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        std::vector&lt;RCP&lt;const Integer&gt;&gt; rem2;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        mp_invert(s, m, <a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>[i]-&gt;as_integer_class());</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        _m = m;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        m *= <a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>[i]-&gt;as_integer_class();</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;elem : R) {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;_k : rem[i]) {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                r = elem-&gt;as_integer_class();</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                r += _m * s * (_k-&gt;as_integer_class() - r);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                mp_fdiv_r(r, r, m);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                rem2.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(r));</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            }</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        R = rem2;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;}</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160; </div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment">// Tests whether n is a prime power and finds a prime p and e such that n =</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment">// p**e.</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="keywordtype">bool</span> _prime_power(integer_class &amp;p, integer_class &amp;e, <span class="keyword">const</span> integer_class &amp;n)</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;{</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">if</span> (n &lt; 2)</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    integer_class _n = n, temp;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    e = 1;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordtype">unsigned</span> i = 2;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">while</span> (mp_perfect_power_p(_n) and _n &gt;= 2) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="keywordflow">if</span> (mp_root(temp, _n, i)) {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            e *= i;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            _n = temp;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            ++i;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">if</span> (mp_probab_prime_p(_n, 25)) {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        p = _n;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;}</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">// Computes a primitive root modulo p**e or 2*p**e where p is an odd prime.</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">// References : Cohen H., A course in computational algebraic number theory</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">// (2009), pages 25-27.</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="keywordtype">void</span> _primitive_root(integer_class &amp;g, <span class="keyword">const</span> integer_class &amp;p,</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                     <span class="keyword">const</span> integer_class &amp;e, <span class="keywordtype">bool</span> even = <span class="keyword">false</span>)</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;{</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    std::vector&lt;RCP&lt;const Integer&gt;&gt; primes;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="namespaceSymEngine.html#a6079112c36b3646e3a7f3cad0d31bc0b">prime_factors</a>(primes, *<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(p - 1));</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    integer_class t;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    g = 2;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">while</span> (g &lt; p) {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keywordtype">bool</span> root = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;it : primes) {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            t = it-&gt;as_integer_class();</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            t = (p - 1) / t;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            mp_powm(t, g, t, p);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            <span class="keywordflow">if</span> (t == 1) { <span class="comment">// If g**(p-1)/q is 1 then g is not a primitive root.</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                root = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">if</span> (root)</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        ++g;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordflow">if</span> (e &gt; 1) {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        t = p * p;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        integer_class pm1 = p - 1;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        mp_powm(t, g, pm1, t);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">if</span> (t == 1) { <span class="comment">// If g**(p-1) mod (p**2) == 1 then g + p is a primitive</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                      <span class="comment">// root.</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            g += p;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    }</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordflow">if</span> (even and g % 2 == 0) {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        mp_pow_ui(t, p, mp_get_ui(e));</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        g += t; <span class="comment">// If g is even then root of 2*p**e is g + p**e.</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    }</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;}</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;} <span class="comment">// anonymous namespace</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a2628a45ea0c2c4bb536a594b34ad6e3d">  681</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceSymEngine.html#a2628a45ea0c2c4bb536a594b34ad6e3d">primitive_root</a>(<span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;g, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n)</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;{</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    integer_class _n = n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>();</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordflow">if</span> (_n &lt; 0)</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        _n = -_n;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">if</span> (_n &lt;= 1)</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">if</span> (_n &lt; 5) {</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        *g = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(_n - 1);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordtype">bool</span> even = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordflow">if</span> (_n % 2 == 0) {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="keywordflow">if</span> (_n % 4 == 0) {</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// If n mod 4 == 0 and n &gt; 4, then no primitive roots.</span></div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        _n /= 2;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        even = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    }</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    integer_class p, e;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordflow">if</span> (not _prime_power(p, e, _n))</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    _primitive_root(_n, p, e, even);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    *g = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(_n));</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;}</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="keyword">namespace</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;{</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">// Computes primitive roots modulo p**e or 2*p**e where p is an odd prime.</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">// References :</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">// [1] Cohen H., A course in computational algebraic number theory (1996), pages</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">// 25-27.</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">// [2] Hackman P., Elementary number theory (2009), page 28.</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="keywordtype">void</span> _primitive_root_list(std::vector&lt;RCP&lt;const Integer&gt;&gt; &amp;roots,</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                          <span class="keyword">const</span> integer_class &amp;p, <span class="keyword">const</span> integer_class &amp;e,</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                          <span class="keywordtype">bool</span> even = <span class="keyword">false</span>)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;{</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    integer_class g, h, d, t, pe2, n, pm1;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    _primitive_root(g, p, integer_class(1),</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                    <span class="keyword">false</span>); <span class="comment">// Find one primitive root for p.</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    h = 1;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    pm1 = p - 1;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="comment">// Generate other primitive roots for p. h = g**i and gcd(i, p-1) = 1.</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">// Ref[2]</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    mp_pow_ui(n, p, mp_get_ui(e));</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i = 1; i &lt; p; ++i) {</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        h *= g;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        h %= p;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        mp_gcd(d, pm1, integer_class(i));</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="keywordflow">if</span> (d == 1) {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            <span class="keywordflow">if</span> (e == 1) {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                <span class="keywordflow">if</span> (even and h % 2 == 0)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                    roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(h + n));</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                    roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(h));</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                integer_class pp = p * p;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                <span class="comment">// Find d such that (h + d*p)**(p-1) mod (p**2) == 1. Ref[1]</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <span class="comment">// h**(p-1) - 1 = d*p*h**(p-2)</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                <span class="comment">// d = (h - h**(2-p)) / p</span></div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                t = 2 - p;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                mp_powm(d, h, t, pp);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                d = ((h - d) / p + p) % p;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                t = h;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                <span class="comment">// t = h + i * p + j * p * p and i != d</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                mp_pow_ui(pe2, p, mp_get_ui(e) - 2);</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j = 0; j &lt; pe2; ++j) {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i = 0; i &lt; p; ++i) {</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                        <span class="keywordflow">if</span> (i != d) {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                            <span class="keywordflow">if</span> (even and t % 2 == 0)</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                                roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(t + n));</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                                roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(t));</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                        }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                        t += p;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                    }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    }</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;} <span class="comment">//_primitive_root_list</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;} <span class="comment">// anonymous namespace</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a969eb0905c46f6486a1b7437aa9d3d63">  765</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceSymEngine.html#a969eb0905c46f6486a1b7437aa9d3d63">primitive_root_list</a>(std::vector&lt;RCP&lt;const Integer&gt;&gt; &amp;roots,</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                         <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;{</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    integer_class _n = n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>();</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keywordflow">if</span> (_n &lt; 0)</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        _n = -_n;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordflow">if</span> (_n &lt;= 1)</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">if</span> (_n &lt; 5) {</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(_n - 1));</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordtype">bool</span> even = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="keywordflow">if</span> (_n % 2 == 0) {</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <span class="keywordflow">if</span> (_n % 4 == 0) {</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="keywordflow">return</span>; <span class="comment">// If n%4 == 0 and n &gt; 4, then no primitive roots.</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        }</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        _n /= 2;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        even = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    integer_class p, e;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">if</span> (not _prime_power(p, e, _n))</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    _primitive_root_list(roots, p, e, even);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    std::sort(roots.begin(), roots.end(), <a class="code" href="structSymEngine_1_1RCPIntegerKeyLess.html">SymEngine::RCPIntegerKeyLess</a>());</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;}</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#aaaad36e43b863bfbad83ed2d98f01992">  793</a></span>&#160;RCP&lt;const Integer&gt; <a class="code" href="namespaceSymEngine.html#aaaad36e43b863bfbad83ed2d98f01992">totient</a>(<span class="keyword">const</span> RCP&lt;const Integer&gt; &amp;n)</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;{</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordflow">if</span> (n-&gt;is_zero())</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(1);</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    integer_class phi = n-&gt;as_integer_class(), p;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordflow">if</span> (phi &lt; 0)</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        phi = -phi;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    map_integer_uint prime_mul;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <a class="code" href="namespaceSymEngine.html#a20b4c6e1fb93393611e75807245f6a9b">prime_factor_multiplicities</a>(prime_mul, *n);</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;it : prime_mul) {</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        p = it.first-&gt;as_integer_class();</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        mp_divexact(phi, phi, p);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <span class="comment">// phi is exactly divisible by p.</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        phi *= p - 1;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(phi));</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;}</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#ab6a14bcfb29bbbda65be7ac9bd75083d">  813</a></span>&#160;RCP&lt;const Integer&gt; <a class="code" href="namespaceSymEngine.html#ab6a14bcfb29bbbda65be7ac9bd75083d">carmichael</a>(<span class="keyword">const</span> RCP&lt;const Integer&gt; &amp;n)</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;{</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="keywordflow">if</span> (n-&gt;is_zero())</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(1);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    map_integer_uint prime_mul;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    integer_class lambda, t, p;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordtype">unsigned</span> multiplicity;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <a class="code" href="namespaceSymEngine.html#a20b4c6e1fb93393611e75807245f6a9b">prime_factor_multiplicities</a>(prime_mul, *n);</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    lambda = 1;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;it : prime_mul) {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        p = it.first-&gt;as_integer_class();</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        multiplicity = it.second;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="keywordflow">if</span> (p == 2</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            and multiplicity</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                    &gt; 2) { <span class="comment">// For powers of 2 greater than 4 divide by 2.</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            multiplicity--;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        }</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        t = p - 1;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        mp_lcm(lambda, lambda, t);</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        mp_pow_ui(t, p, multiplicity - 1);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="comment">// lambda and p are relatively prime.</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        lambda = lambda * t;</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    }</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(lambda));</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;}</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="comment">// References : Cohen H., A course in computational algebraic number theory</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="comment">// (1996), page 25.</span></div>
<div class="line"><a name="l00843"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a78cd7d9fe5866ae1cf7f2adf78940c15">  843</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceSymEngine.html#a78cd7d9fe5866ae1cf7f2adf78940c15">multiplicative_order</a>(<span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;o,</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                          <span class="keyword">const</span> RCP&lt;const Integer&gt; &amp;a,</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                          <span class="keyword">const</span> RCP&lt;const Integer&gt; &amp;n)</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;{</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;    integer_class order, p, t;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    integer_class _a = a-&gt;as_integer_class(),</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                  _n = mp_abs(n-&gt;as_integer_class());</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    mp_gcd(t, _a, _n);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">if</span> (t != 1)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    RCP&lt;const Integer&gt; lambda = <a class="code" href="namespaceSymEngine.html#ab6a14bcfb29bbbda65be7ac9bd75083d">carmichael</a>(n);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    map_integer_uint prime_mul;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <a class="code" href="namespaceSymEngine.html#a20b4c6e1fb93393611e75807245f6a9b">prime_factor_multiplicities</a>(prime_mul, *lambda);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    _a %= _n;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    order = lambda-&gt;as_integer_class();</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;it : prime_mul) {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        p = it.first-&gt;as_integer_class();</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        mp_pow_ui(t, p, it.second);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        mp_divexact(order, order, t);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        mp_powm(t, _a, order, _n);</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordflow">while</span> (t != 1) {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            mp_powm(t, t, p, _n);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            order *= p;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        }</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    }</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    *o = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(order));</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;}</div>
<div class="line"><a name="l00873"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#ad78c8d7a599848f762f200bbe99f087e">  873</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceSymEngine.html#ad78c8d7a599848f762f200bbe99f087e">legendre</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;a, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;{</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="keywordflow">return</span> mp_legendre(a.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>());</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;}</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a6928d852848970a56a53e5f4482bf528">  878</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceSymEngine.html#a6928d852848970a56a53e5f4482bf528">jacobi</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;a, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n)</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;{</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">return</span> mp_jacobi(a.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>());</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;}</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a133cec803e9dbba163ce363a413a8a83">  883</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceSymEngine.html#a133cec803e9dbba163ce363a413a8a83">kronecker</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;a, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n)</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;{</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">return</span> mp_kronecker(a.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>());</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;}</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="keyword">namespace</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;{</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="keywordtype">bool</span> _sqrt_mod_tonelli_shanks(integer_class &amp;rop, <span class="keyword">const</span> integer_class &amp;a,</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                              <span class="keyword">const</span> integer_class &amp;p)</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;{</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    mp_randstate state;</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    integer_class n, y, b, q, pm1, t(1);</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    pm1 = p - 1;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordtype">unsigned</span> e, m;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    e = numeric_cast&lt;unsigned&gt;(mp_scan1(pm1));</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    q = pm1 &gt;&gt; e; <span class="comment">// p - 1 = 2**e*q</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    <span class="keywordflow">while</span> (t != -1) {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        state.urandomint(n, p);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        t = mp_legendre(n, p);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    }</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    mp_powm(y, n, q, p); <span class="comment">// y = n**q mod p</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    mp_powm(b, a, q, p); <span class="comment">// b = a**q mod p</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    t = (q + 1) / 2;</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    mp_powm(rop, a, t, p); <span class="comment">// rop = a**((q + 1) / 2) mod p</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <span class="keywordflow">while</span> (b != 1) {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        m = 0;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        t = b;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordflow">while</span> (t != 1) {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            mp_powm(t, t, integer_class(2), p);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            ++m; <span class="comment">// t = t**2 = b**2**(m)</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keywordflow">if</span> (m == e)</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        mp_pow_ui(q, integer_class(2), e - m - 1); <span class="comment">// q = 2**(e - m - 1)</span></div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        mp_powm(t, y, q, p);                       <span class="comment">// t = y**(2**(e - m - 1))</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        mp_powm(y, t, integer_class(2), p);        <span class="comment">// y = t**2</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        e = m;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        rop = (rop * t) % p;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        b = (b * y) % p;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    }</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;}</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="keywordtype">bool</span> _sqrt_mod_prime(integer_class &amp;rop, <span class="keyword">const</span> integer_class &amp;a,</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                     <span class="keyword">const</span> integer_class &amp;p)</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;{</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <span class="keywordflow">if</span> (p == 2) {</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        rop = a % p;</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordtype">int</span> l = mp_legendre(a, p);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    integer_class t;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordflow">if</span> (l == -1) {</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (l == 0) {</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        rop = 0;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p % 4 == 3) {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        t = (p + 1) / 4;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        mp_powm(rop, a, t, p);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (p % 8 == 5) {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        t = (p - 1) / 4;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        mp_powm(t, a, t, p);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        <span class="keywordflow">if</span> (t == 1) {</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            t = (p + 3) / 8;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            mp_powm(rop, a, t, p);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            t = (p - 5) / 8;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            integer_class t1 = 4 * a;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;            mp_powm(t, t1, t, p);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            rop = (2 * a * t) % p;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        <span class="keywordflow">if</span> (p &lt; 10000) { <span class="comment">// If p &lt; 10000, brute force is faster.</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            integer_class sq = integer_class(1), _a;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            mp_fdiv_r(_a, a, p);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 1; i &lt; p; ++i) {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                <span class="keywordflow">if</span> (sq == _a) {</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                    rop = i;</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                }</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                sq += 2 * i + 1;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                mp_fdiv_r(sq, sq, p);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            <span class="keywordflow">return</span> _sqrt_mod_tonelli_shanks(rop, a, p);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        }</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    }</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;}</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160; </div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">// References : Menezes, Alfred J., Paul C. Van Oorschot, and Scott A. Vanstone.</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">// Handbook of applied cryptography. CRC press, 2010. pages 104 - 108</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">// Calculates log = x mod q**k where g**x == a mod p and order(g, p) = n.</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="keywordtype">void</span> _discrete_log(integer_class &amp;<a class="code" href="namespaceSymEngine.html#aa9a8ead88fadfd214371b73a3a0f34fb">log</a>, <span class="keyword">const</span> integer_class &amp;a,</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                   <span class="keyword">const</span> integer_class &amp;g, <span class="keyword">const</span> integer_class &amp;n,</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                   <span class="keyword">const</span> integer_class &amp;q, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;k,</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                   <span class="keyword">const</span> integer_class &amp;p)</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;{</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <a class="code" href="namespaceSymEngine.html#aa9a8ead88fadfd214371b73a3a0f34fb">log</a> = 0;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    integer_class <a class="code" href="namespaceSymEngine.html#a5427bd85fc080a17d0718a7d97353a49">gamma</a> = a, alpha, _n, t, <a class="code" href="namespaceSymEngine.html#a2203e9e82d8b995e95ba5ce0efe5fe0c">beta</a>, qj(1), m, l;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    _n = n / q;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    mp_powm(alpha, g, _n, p);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    mp_sqrtrem(m, t, q);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">if</span> (t != 0)</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        ++m; <span class="comment">// m = ceiling(sqrt(q)).</span></div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    map_integer_uint</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        table; <span class="comment">// Table for lookup in baby-step giant-step algorithm</span></div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    integer_class alpha_j(1), d, s;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    s = -m;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    mp_powm(s, alpha, s, p);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; m; ++j) {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <a class="code" href="namespaceSymEngine.html#a8a0fa36d4fbff063bb37b9893c4e6354">insert</a>(table, <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(alpha_j), j);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        alpha_j = (alpha_j * alpha) % p;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    }</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j = 0; j &lt; k; ++j) { <span class="comment">// Pohlig-Hellman</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        mp_powm(<a class="code" href="namespaceSymEngine.html#a2203e9e82d8b995e95ba5ce0efe5fe0c">beta</a>, <a class="code" href="namespaceSymEngine.html#a5427bd85fc080a17d0718a7d97353a49">gamma</a>, _n, p);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="comment">// Baby-step giant-step algorithm for l = log_alpha(beta)</span></div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        d = <a class="code" href="namespaceSymEngine.html#a2203e9e82d8b995e95ba5ce0efe5fe0c">beta</a>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; not found &amp;&amp; i &lt; m; ++i) {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            <span class="keywordflow">if</span> (table.find(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(d)) != table.end()) {</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                l = i * m + table[<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(d)];</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                found = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            }</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;            d = (d * s) % p;</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        _n /= q;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        t = -l * qj;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <a class="code" href="namespaceSymEngine.html#aa9a8ead88fadfd214371b73a3a0f34fb">log</a> -= t;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        mp_powm(t, g, t, p);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <a class="code" href="namespaceSymEngine.html#a5427bd85fc080a17d0718a7d97353a49">gamma</a> *= t; <span class="comment">// gamma *= g ** (-l * (q ** j))</span></div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        qj *= q;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;}</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">// References : Johnston A., A generalised qth root algorithm.</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="comment">// Solution for x**n == a mod p**k where a != 0 mod p and p is an odd prime.</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="keywordtype">bool</span> _nthroot_mod1(std::vector&lt;RCP&lt;const Integer&gt;&gt; &amp;roots,</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                   <span class="keyword">const</span> integer_class &amp;a, <span class="keyword">const</span> integer_class &amp;n,</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                   <span class="keyword">const</span> integer_class &amp;p, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> k,</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                   <span class="keywordtype">bool</span> all_roots = <span class="keyword">false</span>)</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;{</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    integer_class _n, r, root, s, t, g(0), pk, m, phi;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    mp_pow_ui(pk, p, k);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    phi = pk * (p - 1) / p;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    mp_gcd(m, phi, n);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    t = phi / m;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    mp_powm(t, a, t, pk);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="comment">// Check whether a**(phi / gcd(phi, n)) == 1 mod p**k.</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">if</span> (t != 1) {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    }</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="comment">// Solve x**n == a mod p first.</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    t = p - 1;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    mp_gcdext(_n, r, s, n, t);</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    <span class="keywordflow">if</span> (r &lt; 0) {</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        mp_fdiv_r(r, r, t / _n);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    }</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    mp_powm(s, a, r, p);</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160; </div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="comment">// Solve x**(_n) == s mod p where _n | p - 1.</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <span class="keywordflow">if</span> (_n == 1) {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;        root = s;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_n == 2) {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        _sqrt_mod_prime(root, s, p);</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    } <span class="keywordflow">else</span> { <span class="comment">// Ref[1]</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        map_integer_uint prime_mul;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <a class="code" href="namespaceSymEngine.html#a20b4c6e1fb93393611e75807245f6a9b">prime_factor_multiplicities</a>(prime_mul, *<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(_n));</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        integer_class h, q, qt, z, v, x, s1 = s;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        _primitive_root(g, p, integer_class(2));</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <span class="keywordtype">unsigned</span> c;</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;it : prime_mul) {</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            q = it.first-&gt;as_integer_class();</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            mp_pow_ui(qt, q, it.second);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            h = (p - 1) / q;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;            c = 1;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;            <span class="keywordflow">while</span> (h % q == 0) {</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                ++c;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                h /= q;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            }</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            mp_invert(t, h, qt);</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;            z = t * -h;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            x = (1 + z) / qt;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            mp_powm(v, s1, x, p);</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160; </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            <span class="keywordflow">if</span> (c == it.second) {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                s1 = v;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                mp_powm(x, s1, h, p);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                t = h * qt;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                mp_powm(r, g, t, p);</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                mp_pow_ui(qt, q, c - it.second);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                _discrete_log(t, x, r, qt, q, c - it.second, p);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                t = -z * t;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                mp_powm(r, g, t, p);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                v *= r;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                mp_fdiv_r(v, v, p);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                s1 = v;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;            }</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        }</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        root = s1;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    r = n;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <span class="keywordtype">unsigned</span> c = 0;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">while</span> (r % p == 0) {</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        mp_divexact(r, r, p);</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        ++c;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    }</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160; </div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    <span class="comment">// Solve s == x**r mod p**k where (x**r)**(p**c)) == a mod p**k</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    integer_class pc = n / r, pd = pc * p;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="keywordflow">if</span> (c &gt;= 1) {</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        mp_powm(s, root, r, p);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        <span class="comment">// s == root**r mod p. Since s**(p**c) == 1 == a mod p**(c + 1), lift</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        <span class="comment">// until p**k.</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = c + 2; d &lt;= k; ++d) {</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            t = 1 - pc;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;            pd *= p;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            mp_powm(t, s, t, pd);</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            t = (a * t - s) / pc;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;            s += t;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        }</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        s = a;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    }</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    <span class="comment">// Solve x**r == s mod p**k given that root**r == s mod p and r % p != 0.</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    integer_class u;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    pd = p;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = 2; d &lt; 2 * k; d *= 2) { <span class="comment">// Hensel lifting</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        t = r - 1;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        pd *= pd;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        <span class="keywordflow">if</span> (d &gt; k)</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;            pd = pk;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        mp_powm(u, root, t, pd);</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        t = r * u;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        mp_invert(t, t, pd);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        root += (s - u * root) * t;</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        mp_fdiv_r(root, root, pd);</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    }</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <span class="keywordflow">if</span> (m != 1 and all_roots) {</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="comment">// All roots are generated by root*(g**(phi / gcd(phi , n)))**j</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="keywordflow">if</span> (n == 2) {</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;            t = -1;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            <span class="keywordflow">if</span> (g == 0)</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;                _primitive_root(g, p, integer_class(2));</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            t = phi / m;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            mp_powm(t, g, t, pk);</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        }</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; m; ++j) {</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;            roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(root));</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            root *= t;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            mp_fdiv_r(root, root, pk);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        }</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(root));</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;    }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;}</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160; </div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment">// Checks if Solution for x**n == a mod p**k exists where a != 0 mod p and p is</span></div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="comment">// an odd prime.</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="keywordtype">bool</span> _is_nthroot_mod1(<span class="keyword">const</span> integer_class &amp;a, <span class="keyword">const</span> integer_class &amp;n,</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;                      <span class="keyword">const</span> integer_class &amp;p, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> k)</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;{</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    integer_class t, pk, m, phi;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    mp_pow_ui(pk, p, k);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    phi = pk * (p - 1) / p;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    mp_gcd(m, phi, n);</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    t = phi / m;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    mp_powm(t, a, t, pk);</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    <span class="comment">// Check whether a**(phi / gcd(phi, n)) == 1 mod p**k.</span></div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keywordflow">if</span> (t != 1) {</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    }</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;}</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="comment">// Solution for x**n == a mod p**k.</span></div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="keywordtype">bool</span> _nthroot_mod_prime_power(std::vector&lt;RCP&lt;const Integer&gt;&gt; &amp;roots,</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                              <span class="keyword">const</span> integer_class &amp;a, <span class="keyword">const</span> integer_class &amp;n,</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                              <span class="keyword">const</span> integer_class &amp;p, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> k,</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                              <span class="keywordtype">bool</span> all_roots = <span class="keyword">false</span>)</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;{</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    integer_class pk, root;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    std::vector&lt;RCP&lt;const Integer&gt;&gt; _roots;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">if</span> (a % p != 0) {</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        <span class="keywordflow">if</span> (p == 2) {</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            integer_class r = n, t, s, pc, pj;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;            pk = integer_class(1) &lt;&lt; k;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;            <span class="keywordtype">unsigned</span> c = numeric_cast&lt;unsigned&gt;(mp_scan1(n));</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;            r = n &gt;&gt; c; <span class="comment">// n = 2**c * r where r is odd.</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;            <span class="comment">// Handle special cases of k = 1 and k = 2.</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;            <span class="keywordflow">if</span> (k == 1) {</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(1));</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;            }</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;            <span class="keywordflow">if</span> (k == 2) {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                <span class="keywordflow">if</span> (c &gt; 0 and a % 4 == 3) {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;                }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;                roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(a % 4));</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                <span class="keywordflow">if</span> (all_roots and c &gt; 0)</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                    roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(3));</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;            }</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;            <span class="keywordflow">if</span> (c &gt;= k - 2) {</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                c = k - 2; <span class="comment">// Since x**(2**c) == x**(2**(k - 2)) mod 2**k, let c</span></div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                           <span class="comment">// = k - 2.</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            }</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            t = integer_class(1) &lt;&lt; (k - 2);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;            pc = integer_class(1) &lt;&lt; c;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160; </div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;            mp_invert(s, r, t);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;            <span class="keywordflow">if</span> (c == 0) {</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                <span class="comment">// x**r == a mod 2**k and x**2**(k - 2) == 1 mod 2**k, implies</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                <span class="comment">// x**(r * s) == x == a**s mod 2**k.</span></div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                mp_powm(root, a, s, pk);</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(root));</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;            }</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;            <span class="comment">// First, solve for y**2**c == a mod 2**k where y == x**r</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;            t = integer_class(1) &lt;&lt; (c + 2);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;            mp_fdiv_r(t, a, t);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;            <span class="comment">// Check for a == y**2**c == 1 mod 2**(c + 2).</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;            <span class="keywordflow">if</span> (t != 1)</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;            root = 1;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;            pj = pc * 4;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            <span class="comment">// 1 is a root of x**2**c == 1 mod 2**(c + 2). Lift till 2**k.</span></div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = c + 2; j &lt; k; ++j) {</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;                pj *= 2;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;                mp_powm(t, root, pc, pj);</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;                t -= a;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                <span class="keywordflow">if</span> (t % pj != 0)</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                    <span class="comment">// Add 2**(j - c).</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                    root += integer_class(1) &lt;&lt; (j - c);</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;            }</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;            <span class="comment">// Solve x**r == root mod 2**k.</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;            mp_powm(root, root, s, pk);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            <span class="keywordflow">if</span> (all_roots) {</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;                <span class="comment">// All roots are generated by, root * (j * (2**(k - c) +/- 1)).</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                t = pk / pc * root;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; 2; ++i) {</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j = 0; j &lt; pc; ++j) {</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                        roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(root));</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;                        root += t;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                    }</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                    root = t - root;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                }</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(root));</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            }</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            <span class="keywordflow">return</span> _nthroot_mod1(roots, a, n, p, k, all_roots);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        }</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        integer_class _a;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        mp_pow_ui(pk, p, k);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        _a = a % pk;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="keywordtype">unsigned</span> m;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        integer_class pm;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        <span class="keywordflow">if</span> (_a == 0) {</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            <span class="keywordflow">if</span> (not all_roots) {</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;                roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(0));</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;            }</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            _roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(0));</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            <span class="keywordflow">if</span> (n &gt;= k)</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                m = k - 1;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                m = numeric_cast&lt;unsigned&gt;(k - 1 - (k - 1) / mp_get_ui(n));</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;            mp_pow_ui(pm, p, m);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            <span class="keywordtype">unsigned</span> r = 1;</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;            mp_divexact(_a, _a, p);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;            <span class="keywordflow">while</span> (_a % p == 0) {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                mp_divexact(_a, _a, p);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                ++r;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            }</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;            <span class="keywordflow">if</span> (r &lt; n or r % n != 0</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                or not _nthroot_mod_prime_power(_roots, _a, n, p, k - r,</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                                                all_roots)) {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            }</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            m = numeric_cast&lt;unsigned&gt;(r / mp_get_ui(n));</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            mp_pow_ui(pm, p, m);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;            <span class="keywordflow">if</span> (not all_roots) {</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                roots.push_back(</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                    <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(_roots.back()-&gt;as_integer_class() * pm));</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;            }</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;it : _roots) {</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                it = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(it-&gt;as_integer_class() * pm);</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;            m = numeric_cast&lt;unsigned&gt;(r - r / mp_get_ui(n));</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;            mp_pow_ui(pm, p, m);</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        }</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        integer_class pkm;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        mp_pow_ui(pkm, p, k - m);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;it : _roots) {</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;            root = it-&gt;as_integer_class();</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i = 0; i &lt; pm; ++i) {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;                roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(root));</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;                root += pkm;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;            }</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        }</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    }</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;}</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;} <span class="comment">// anonymous namespace</span></div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160; </div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="comment">// Returns whether Solution for x**n == a mod p**k exists or not</span></div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="keywordtype">bool</span> _is_nthroot_mod_prime_power(<span class="keyword">const</span> integer_class &amp;a, <span class="keyword">const</span> integer_class &amp;n,</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;                                 <span class="keyword">const</span> integer_class &amp;p, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> k)</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;{</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    integer_class pk;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <span class="keywordflow">if</span> (a % p != 0) {</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        <span class="keywordflow">if</span> (p == 2) {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            integer_class t;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            <span class="keywordtype">unsigned</span> c = numeric_cast&lt;unsigned&gt;(mp_scan1(n));</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;            <span class="comment">// Handle special cases of k = 1 and k = 2.</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;            <span class="keywordflow">if</span> (k == 1) {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            }</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            <span class="keywordflow">if</span> (k == 2) {</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                <span class="keywordflow">if</span> (c &gt; 0 and a % 4 == 3) {</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                }</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            }</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;            <span class="keywordflow">if</span> (c &gt;= k - 2) {</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                c = k - 2; <span class="comment">// Since x**(2**c) == x**(2**(k - 2)) mod 2**k, let c</span></div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;                           <span class="comment">// = k - 2.</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;            }</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            <span class="keywordflow">if</span> (c == 0) {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                <span class="comment">// x**r == a mod 2**k and x**2**(k - 2) == 1 mod 2**k, implies</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;                <span class="comment">// x**(r * s) == x == a**s mod 2**k.</span></div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            }</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160; </div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            <span class="comment">// First, solve for y**2**c == a mod 2**k where y == x**r</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;            t = integer_class(1) &lt;&lt; (c + 2);</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;            mp_fdiv_r(t, a, t);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;            <span class="comment">// Check for a == y**2**c == 1 mod 2**(c + 2).</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;            <span class="keywordflow">if</span> (t != 1)</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;            <span class="keywordflow">return</span> _is_nthroot_mod1(a, n, p, k);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;        }</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        integer_class _a;</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        mp_pow_ui(pk, p, k);</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;        _a = a % pk;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        integer_class pm;</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;        <span class="keywordflow">if</span> (_a == 0) {</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            <span class="keywordtype">unsigned</span> r = 1;</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            mp_divexact(_a, _a, p);</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            <span class="keywordflow">while</span> (_a % p == 0) {</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                mp_divexact(_a, _a, p);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                ++r;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            }</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;            <span class="keywordflow">if</span> (r &lt; n or r % n != 0</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;                or not _is_nthroot_mod_prime_power(_a, n, p, k - r)) {</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;            }</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;        }</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    }</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;}</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; </div>
<div class="line"><a name="l01372"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a2586dc7e8e62544f230928bd693d3f01"> 1372</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceSymEngine.html#a2586dc7e8e62544f230928bd693d3f01">nthroot_mod</a>(<span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;root,</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                 <span class="keyword">const</span> RCP&lt;const Integer&gt; &amp;a, <span class="keyword">const</span> RCP&lt;const Integer&gt; &amp;n,</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                 <span class="keyword">const</span> RCP&lt;const Integer&gt; &amp;<a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>)</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;{</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>-&gt;as_integer_class() &lt;= 0) {</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>-&gt;as_integer_class() == 1) {</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        *root = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(0);</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    }</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    map_integer_uint prime_mul;</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <a class="code" href="namespaceSymEngine.html#a20b4c6e1fb93393611e75807245f6a9b">prime_factor_multiplicities</a>(prime_mul, *<a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>);</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    std::vector&lt;RCP&lt;const Integer&gt;&gt; moduli;</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordtype">bool</span> ret_val;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    std::vector&lt;RCP&lt;const Integer&gt;&gt; rem;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;it : prime_mul) {</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        integer_class _mod;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        mp_pow_ui(_mod, it.first-&gt;as_integer_class(), it.second);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        moduli.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(_mod)));</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        ret_val = _nthroot_mod_prime_power(</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;            rem, a-&gt;as_integer_class(), n-&gt;as_integer_class(),</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;            it.first-&gt;as_integer_class(), it.second, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;        <span class="keywordflow">if</span> (not ret_val)</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    }</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <a class="code" href="namespaceSymEngine.html#aad612bc5c47da71cc70cfb11b5ef6344">crt</a>(root, rem, moduli);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;}</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160; </div>
<div class="line"><a name="l01402"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a45dbcfb187e36f525090486594bea367"> 1402</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceSymEngine.html#a45dbcfb187e36f525090486594bea367">nthroot_mod_list</a>(std::vector&lt;RCP&lt;const Integer&gt;&gt; &amp;roots,</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;                      <span class="keyword">const</span> RCP&lt;const Integer&gt; &amp;a, <span class="keyword">const</span> RCP&lt;const Integer&gt; &amp;n,</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;                      <span class="keyword">const</span> RCP&lt;const Integer&gt; &amp;m)</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;{</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordflow">if</span> (m-&gt;as_integer_class() &lt;= 0) {</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m-&gt;as_integer_class() == 1) {</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        roots.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(0));</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    }</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    map_integer_uint prime_mul;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <a class="code" href="namespaceSymEngine.html#a20b4c6e1fb93393611e75807245f6a9b">prime_factor_multiplicities</a>(prime_mul, *m);</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    std::vector&lt;RCP&lt;const Integer&gt;&gt; moduli;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <span class="keywordtype">bool</span> ret_val;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    std::vector&lt;std::vector&lt;RCP&lt;const Integer&gt;&gt;&gt; rem;</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;it : prime_mul) {</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        integer_class _mod;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        mp_pow_ui(_mod, it.first-&gt;as_integer_class(), it.second);</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        moduli.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(_mod)));</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        std::vector&lt;RCP&lt;const Integer&gt;&gt; rem1;</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        ret_val = _nthroot_mod_prime_power(</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;            rem1, a-&gt;as_integer_class(), n-&gt;as_integer_class(),</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            it.first-&gt;as_integer_class(), it.second, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <span class="keywordflow">if</span> (not ret_val)</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        rem.push_back(rem1);</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    _crt_cartesian(roots, rem, moduli);</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    std::sort(roots.begin(), roots.end(), <a class="code" href="structSymEngine_1_1RCPIntegerKeyLess.html">SymEngine::RCPIntegerKeyLess</a>());</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;}</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; </div>
<div class="line"><a name="l01434"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a0ccb150bd495468ac62cba08268da1ed"> 1434</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceSymEngine.html#a0ccb150bd495468ac62cba08268da1ed">powermod</a>(<span class="keyword">const</span> Ptr&lt;RCP&lt;const Integer&gt;&gt; &amp;powm, <span class="keyword">const</span> RCP&lt;const Integer&gt; &amp;a,</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;              <span class="keyword">const</span> RCP&lt;const Number&gt; &amp;b, <span class="keyword">const</span> RCP&lt;const Integer&gt; &amp;m)</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;{</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;Integer&gt;(*b)) {</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        integer_class t = down_cast&lt;const Integer &amp;&gt;(*b).as_integer_class();</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        <span class="keywordflow">if</span> (b-&gt;is_negative())</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            t *= -1;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        mp_powm(t, a-&gt;as_integer_class(), t, m-&gt;as_integer_class());</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        <span class="keywordflow">if</span> (b-&gt;is_negative()) {</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;            <span class="keywordtype">bool</span> ret_val = mp_invert(t, t, m-&gt;as_integer_class());</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;            <span class="keywordflow">if</span> (not ret_val)</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        *powm = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(t));</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_a&lt;Rational&gt;(*b)) {</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;        RCP&lt;const Integer&gt; num, den, r;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;        <a class="code" href="namespaceSymEngine.html#a099fdf0478ebd3ed479f40ddb04f0315">get_num_den</a>(down_cast&lt;const Rational &amp;&gt;(*b), outArg(num), outArg(den));</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        <span class="keywordflow">if</span> (den-&gt;is_negative()) {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;            den = den-&gt;mulint(*minus_one);</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            num = num-&gt;mulint(*minus_one);</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        }</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        integer_class t = mp_abs(num-&gt;as_integer_class());</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        mp_powm(t, a-&gt;as_integer_class(), t, m-&gt;as_integer_class());</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        <span class="keywordflow">if</span> (num-&gt;is_negative()) {</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            <span class="keywordtype">bool</span> ret_val = mp_invert(t, t, m-&gt;as_integer_class());</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;            <span class="keywordflow">if</span> (not ret_val)</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;        r = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(t));</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="namespaceSymEngine.html#a2586dc7e8e62544f230928bd693d3f01">nthroot_mod</a>(powm, r, den, m);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    }</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;}</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#ac1ca4e052e1ed84f11dd83c9b32f547e"> 1469</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceSymEngine.html#ac1ca4e052e1ed84f11dd83c9b32f547e">powermod_list</a>(std::vector&lt;RCP&lt;const Integer&gt;&gt; &amp;pows,</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                   <span class="keyword">const</span> RCP&lt;const Integer&gt; &amp;a, <span class="keyword">const</span> RCP&lt;const Number&gt; &amp;b,</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;                   <span class="keyword">const</span> RCP&lt;const Integer&gt; &amp;m)</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;{</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="keywordflow">if</span> (is_a&lt;Integer&gt;(*b)) {</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        integer_class t</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            = mp_abs(down_cast&lt;const Integer &amp;&gt;(*b).as_integer_class());</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        mp_powm(t, a-&gt;as_integer_class(), t, m-&gt;as_integer_class());</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <span class="keywordflow">if</span> (b-&gt;is_negative()) {</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;            <span class="keywordtype">bool</span> ret_val = mp_invert(t, t, m-&gt;as_integer_class());</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            <span class="keywordflow">if</span> (not ret_val)</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;        }</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        pows.push_back(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(std::move(t)));</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (is_a&lt;Rational&gt;(*b)) {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        RCP&lt;const Integer&gt; num, den, r;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        <a class="code" href="namespaceSymEngine.html#a099fdf0478ebd3ed479f40ddb04f0315">get_num_den</a>(down_cast&lt;const Rational &amp;&gt;(*b), outArg(num), outArg(den));</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        <span class="keywordflow">if</span> (den-&gt;is_negative()) {</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;            den = den-&gt;mulint(*<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(-1));</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            num = num-&gt;mulint(*<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(-1));</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        }</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;        integer_class t = num-&gt;as_integer_class();</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;        <span class="keywordflow">if</span> (num-&gt;is_negative())</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;            t *= -1;</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;        mp_powm(t, a-&gt;as_integer_class(), t, m-&gt;as_integer_class());</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <span class="keywordflow">if</span> (num-&gt;is_negative()) {</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            <span class="keywordtype">bool</span> ret_val = mp_invert(t, t, m-&gt;as_integer_class());</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            <span class="keywordflow">if</span> (not ret_val)</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        }</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;        r = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(t);</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        <a class="code" href="namespaceSymEngine.html#a45dbcfb187e36f525090486594bea367">nthroot_mod_list</a>(pows, r, den, m);</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    }</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;}</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160; </div>
<div class="line"><a name="l01504"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a64d29f29e5080fa28f30bda2ae2464b9"> 1504</a></span>&#160;vec_integer_class <a class="code" href="namespaceSymEngine.html#a64d29f29e5080fa28f30bda2ae2464b9">quadratic_residues</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;a)</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;{</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="comment">        Returns the list of quadratic residues.</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">        Example</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="comment">        ========</span></div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="comment">        &gt;&gt;&gt; quadratic_residues(7)</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment">        [0, 1, 2, 4]</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160; </div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="keywordflow">if</span> (a.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>() &lt; 1) {</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        <span class="keywordflow">throw</span> SymEngineException(<span class="stringliteral">&quot;quadratic_residues: Input must be &gt; 0&quot;</span>);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    vec_integer_class residue;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="keywordflow">for</span> (integer_class i = integer_class(0); i &lt;= a.<a class="code" href="classSymEngine_1_1Integer.html#adb7bd5a47f20ae0aac9e7e82b2a4e29c">as_int</a>() / 2; i++) {</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        residue.push_back((i * i) % a.<a class="code" href="classSymEngine_1_1Integer.html#adb7bd5a47f20ae0aac9e7e82b2a4e29c">as_int</a>());</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    }</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160; </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    sort(residue.begin(), residue.end());</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    residue.erase(unique(residue.begin(), residue.end()), residue.end());</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160; </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="keywordflow">return</span> residue;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;}</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160; </div>
<div class="line"><a name="l01529"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a57af64eb932629159a77ed9f517bcfab"> 1529</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceSymEngine.html#a57af64eb932629159a77ed9f517bcfab">is_quad_residue</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;a, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;p)</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;{</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="comment">    Returns true if ``a`` (mod ``p``) is in the set of squares mod ``p``,</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="comment">    i.e a % p in set([i**2 % p for i in range(p)]). If ``p`` is an odd but</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="comment">    not prime, an iterative method is used to make the determination.</span></div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160; </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    integer_class p2 = p.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>();</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    <span class="keywordflow">if</span> (p2 == 0)</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        <span class="keywordflow">throw</span> SymEngineException(</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            <span class="stringliteral">&quot;is_quad_residue: Second parameter must be non-zero&quot;</span>);</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <span class="keywordflow">if</span> (p2 &lt; 0)</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        p2 = -p2;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    integer_class a_final = a.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>();</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <span class="keywordflow">if</span> (a.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>() &gt;= p2 || a.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>() &lt; 0)</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;        mp_fdiv_r(a_final, a.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), p2);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    <span class="keywordflow">if</span> (a_final &lt; 2)</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160; </div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespaceSymEngine.html#aa6868f339e15596c02c68e1d02f0a461">probab_prime_p</a>(*<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(p2))) {</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        <span class="keywordflow">if</span> ((p2 % 2 == 1) &amp;&amp; <a class="code" href="namespaceSymEngine.html#a6928d852848970a56a53e5f4482bf528">jacobi</a>(*<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(a_final), p) == -1)</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;        <span class="keyword">const</span> RCP&lt;const Integer&gt; a1 = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(a_final);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        <span class="keyword">const</span> RCP&lt;const Integer&gt; p1 = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(p2);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160; </div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        map_integer_uint prime_mul;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        <a class="code" href="namespaceSymEngine.html#a20b4c6e1fb93393611e75807245f6a9b">prime_factor_multiplicities</a>(prime_mul, *p1);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        <span class="keywordtype">bool</span> ret_val;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160; </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;it : prime_mul) {</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;            ret_val = _is_nthroot_mod_prime_power(</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                a1-&gt;as_integer_class(), <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(2)-&gt;as_integer_class(),</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                it.first-&gt;as_integer_class(), it.second);</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;            <span class="keywordflow">if</span> (not ret_val)</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        }</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    }</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; </div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <span class="keywordflow">return</span> mp_legendre(a_final, p2) == 1;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;}</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#aab51c36e32ea0584604a1195a85fe6de"> 1573</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="namespaceSymEngine.html#aab51c36e32ea0584604a1195a85fe6de">is_nth_residue</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;a, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;n, <span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;<a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>)</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="comment">Returns true if ``a`` (mod ``mod``) is in the set of nth powers mod ``mod``,</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="comment">i.e a % mod in set([i**n % mod for i in range(mod)]).</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;{</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    integer_class _mod = <a class="code" href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">mod</a>.as_integer_class();</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160; </div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="keywordflow">if</span> (_mod == 0) {</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (_mod == 1) {</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    }</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160; </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <span class="keywordflow">if</span> (_mod &lt; 0)</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        _mod = -(_mod);</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160; </div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    RCP&lt;const Integer&gt; mod2 = <a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(_mod);</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    map_integer_uint prime_mul;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <a class="code" href="namespaceSymEngine.html#a20b4c6e1fb93393611e75807245f6a9b">prime_factor_multiplicities</a>(prime_mul, *mod2);</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    <span class="keywordtype">bool</span> ret_val;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160; </div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;it : prime_mul) {</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        ret_val = _is_nthroot_mod_prime_power(</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;            a.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(), n.<a class="code" href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">as_integer_class</a>(),</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;            it.first-&gt;as_integer_class(), it.second);</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        <span class="keywordflow">if</span> (not ret_val)</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    }</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;}</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160; </div>
<div class="line"><a name="l01605"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a310f9f699f41cff255e29fb6013e3f40"> 1605</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="namespaceSymEngine.html#a310f9f699f41cff255e29fb6013e3f40">mobius</a>(<span class="keyword">const</span> <a class="code" href="classSymEngine_1_1Integer.html">Integer</a> &amp;a)</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;{</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <span class="keywordflow">if</span> (a.<a class="code" href="classSymEngine_1_1Integer.html#adb7bd5a47f20ae0aac9e7e82b2a4e29c">as_int</a>() &lt;= 0) {</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        <span class="keywordflow">throw</span> SymEngineException(<span class="stringliteral">&quot;mobius: Integer &lt;= 0&quot;</span>);</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    }</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    map_integer_uint prime_mul;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="keywordtype">bool</span> is_square_free = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <a class="code" href="namespaceSymEngine.html#a20b4c6e1fb93393611e75807245f6a9b">prime_factor_multiplicities</a>(prime_mul, a);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    <span class="keyword">auto</span> num_prime_factors = prime_mul.size();</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;it : prime_mul) {</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        <span class="keywordtype">int</span> p_freq = it.second;</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        <span class="keywordflow">if</span> (p_freq &gt; 1) {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;            is_square_free = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        }</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    }</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;    <span class="keywordflow">if</span> (!is_square_free) {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_prime_factors % 2 == 0) {</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;        <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    }</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;}</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160; </div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="keywordtype">long</span> mertens(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> a)</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;{</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="keywordtype">long</span> mertens = 0;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i = 1; i &lt;= a; ++i) {</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        mertens += <a class="code" href="namespaceSymEngine.html#a310f9f699f41cff255e29fb6013e3f40">mobius</a>(*(<a class="code" href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">integer</a>(i)));</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    }</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="keywordflow">return</span> mertens;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;}</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160; </div>
<div class="line"><a name="l01649"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a059db1524923226319eb7245f03f1d65"> 1649</a></span>&#160;integer_class <a class="code" href="namespaceSymEngine.html#a059db1524923226319eb7245f03f1d65">mp_polygonal_number</a>(<span class="keyword">const</span> integer_class &amp;s,</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                                  <span class="keyword">const</span> integer_class &amp;n)</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;{</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="keyword">auto</span> res = ((s - 2) * n * n - (s - 4) * n) / 2;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;}</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160; </div>
<div class="line"><a name="l01666"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#abcb2e3a9648b190ce406481f00c46121"> 1666</a></span>&#160;integer_class <a class="code" href="namespaceSymEngine.html#abcb2e3a9648b190ce406481f00c46121">mp_principal_polygonal_root</a>(<span class="keyword">const</span> integer_class &amp;s,</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                                          <span class="keyword">const</span> integer_class &amp;x)</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;{</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    integer_class tmp;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    mp_pow_ui(tmp, s - 4, 2);</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    integer_class root = mp_sqrt(8 * x * (s - 2) + tmp);</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    integer_class n = (root + s - 4) / (2 * (s - 2));</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keywordflow">return</span> n;</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;}</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160; </div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;std::pair&lt;integer_class, integer_class&gt;</div>
<div class="line"><a name="l01677"></a><span class="lineno"><a class="line" href="namespaceSymEngine.html#a92cbc295ca4ec5d6b0b9ea4da2def010"> 1677</a></span>&#160;<a class="code" href="namespaceSymEngine.html#a92cbc295ca4ec5d6b0b9ea4da2def010">mp_perfect_power_decomposition</a>(<span class="keyword">const</span> integer_class &amp;n, <span class="keywordtype">bool</span> lowest_exponent)</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;{</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="comment">// From</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    <span class="comment">// https://codegolf.stackexchange.com/questions/1935/fastest-algorithm-for-decomposing-a-perfect-power</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> p = 2;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    integer_class intone, i, j, m, res;</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    intone = 1;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    std::pair&lt;integer_class, integer_class&gt; respair;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    respair = std::make_pair(n, intone);</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160; </div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    <span class="keywordflow">while</span> ((intone &lt;&lt; p) &lt;= n) {</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;        i = 2;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;        j = n;</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        <span class="keywordflow">while</span> (j &gt; i + 1) {</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;            m = (i + j) / 2;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;            mp_pow_ui(res, m, p);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;            <span class="keywordflow">if</span> (res &gt; n)</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                j = m;</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                i = m;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        }</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        mp_pow_ui(res, i, p);</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        <span class="keywordflow">if</span> (res == n) {</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;            respair = std::make_pair(i, p);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;            <span class="keywordflow">if</span> (lowest_exponent) {</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                <span class="keywordflow">return</span> respair;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;            }</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;        }</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;        p++;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;    }</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keywordflow">return</span> respair;</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;}</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160; </div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;} <span class="comment">// namespace SymEngine</span></div>
<div class="ttc" id="aadd_8h_html"><div class="ttname"><a href="add_8h.html">add.h</a></div><div class="ttdoc">Classes and functions relating to the binary operation of addition.</div></div>
<div class="ttc" id="aclassSymEngine_1_1Integer_html"><div class="ttname"><a href="classSymEngine_1_1Integer.html">SymEngine::Integer</a></div><div class="ttdoc">Integer Class.</div><div class="ttdef"><b>Definition:</b> <a href="integer_8h_source.html#l00018">integer.h:19</a></div></div>
<div class="ttc" id="aclassSymEngine_1_1Integer_html_a562351860ae5f8d8bf1c84905caa00fc"><div class="ttname"><a href="classSymEngine_1_1Integer.html#a562351860ae5f8d8bf1c84905caa00fc">SymEngine::Integer::as_integer_class</a></div><div class="ttdeci">const integer_class &amp; as_integer_class() const</div><div class="ttdoc">Convert to integer_class.</div><div class="ttdef"><b>Definition:</b> <a href="integer_8h_source.html#l00045">integer.h:45</a></div></div>
<div class="ttc" id="aclassSymEngine_1_1Integer_html_adb7bd5a47f20ae0aac9e7e82b2a4e29c"><div class="ttname"><a href="classSymEngine_1_1Integer.html#adb7bd5a47f20ae0aac9e7e82b2a4e29c">SymEngine::Integer::as_int</a></div><div class="ttdeci">signed long int as_int() const</div><div class="ttdoc">Convert to int, raise an exception if it does not fit.</div><div class="ttdef"><b>Definition:</b> <a href="integer_8cpp_source.html#l00034">integer.cpp:34</a></div></div>
<div class="ttc" id="aclassSymEngine_1_1Rational_html_a0bbb6880b55f4db457f8183b5db400ff"><div class="ttname"><a href="classSymEngine_1_1Rational.html#a0bbb6880b55f4db457f8183b5db400ff">SymEngine::Rational::from_mpq</a></div><div class="ttdeci">static RCP&lt; const Number &gt; from_mpq(const rational_class &amp;i)</div><div class="ttdef"><b>Definition:</b> <a href="rational_8cpp_source.html#l00023">rational.cpp:23</a></div></div>
<div class="ttc" id="aclassSymEngine_1_1Sieve_1_1iterator_html"><div class="ttname"><a href="classSymEngine_1_1Sieve_1_1iterator.html">SymEngine::Sieve::iterator</a></div><div class="ttdef"><b>Definition:</b> <a href="prime__sieve_8h_source.html#l00043">prime_sieve.h:44</a></div></div>
<div class="ttc" id="aclassSymEngine_1_1mp__randstate_html"><div class="ttname"><a href="classSymEngine_1_1mp__randstate.html">SymEngine::mp_randstate</a></div><div class="ttdef"><b>Definition:</b> <a href="mp__class_8h_source.html#l01225">mp_class.h:1226</a></div></div>
<div class="ttc" id="amul_8h_html"><div class="ttname"><a href="mul_8h.html">mul.h</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html"><div class="ttname"><a href="namespaceSymEngine.html">SymEngine</a></div><div class="ttdoc">Main namespace for SymEngine package.</div><div class="ttdef"><b>Definition:</b> <a href="add_8cpp_source.html#l00018">add.cpp:19</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a059db1524923226319eb7245f03f1d65"><div class="ttname"><a href="namespaceSymEngine.html#a059db1524923226319eb7245f03f1d65">SymEngine::mp_polygonal_number</a></div><div class="ttdeci">integer_class mp_polygonal_number(const integer_class &amp;s, const integer_class &amp;n)</div><div class="ttdoc">Numeric calculation of the n:th s-gonal number.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l01649">ntheory.cpp:1649</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a099fdf0478ebd3ed479f40ddb04f0315"><div class="ttname"><a href="namespaceSymEngine.html#a099fdf0478ebd3ed479f40ddb04f0315">SymEngine::get_num_den</a></div><div class="ttdeci">void get_num_den(const Rational &amp;rat, const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;num, const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;den)</div><div class="ttdoc">returns the num and den of rational rat as RCP&lt;const Integer&gt;</div><div class="ttdef"><b>Definition:</b> <a href="rational_8cpp_source.html#l00130">rational.cpp:130</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a0a30b2ef42d2d4605920f28e80b65e04"><div class="ttname"><a href="namespaceSymEngine.html#a0a30b2ef42d2d4605920f28e80b65e04">SymEngine::divides</a></div><div class="ttdeci">bool divides(const Integer &amp;a, const Integer &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00162">ntheory.cpp:162</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a0ccb150bd495468ac62cba08268da1ed"><div class="ttname"><a href="namespaceSymEngine.html#a0ccb150bd495468ac62cba08268da1ed">SymEngine::powermod</a></div><div class="ttdeci">bool powermod(const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;powm, const RCP&lt; const Integer &gt; &amp;a, const RCP&lt; const Number &gt; &amp;b, const RCP&lt; const Integer &gt; &amp;m)</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l01434">ntheory.cpp:1434</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a12011da4b72858d9a6134ba420e4575a"><div class="ttname"><a href="namespaceSymEngine.html#a12011da4b72858d9a6134ba420e4575a">SymEngine::nextprime</a></div><div class="ttdeci">RCP&lt; const Integer &gt; nextprime(const Integer &amp;a)</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00173">ntheory.cpp:173</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a133cec803e9dbba163ce363a413a8a83"><div class="ttname"><a href="namespaceSymEngine.html#a133cec803e9dbba163ce363a413a8a83">SymEngine::kronecker</a></div><div class="ttdeci">int kronecker(const Integer &amp;a, const Integer &amp;n)</div><div class="ttdoc">Kronecker Function.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00883">ntheory.cpp:883</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a140e1990268bd87d976940e2bb7ae461"><div class="ttname"><a href="namespaceSymEngine.html#a140e1990268bd87d976940e2bb7ae461">SymEngine::fibonacci2</a></div><div class="ttdeci">void fibonacci2(const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;g, const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;s, unsigned long n)</div><div class="ttdoc">Fibonacci n and n-1.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00118">ntheory.cpp:118</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a17c4fb234fb676cbdcd3e5b19a559356"><div class="ttname"><a href="namespaceSymEngine.html#a17c4fb234fb676cbdcd3e5b19a559356">SymEngine::integer</a></div><div class="ttdeci">std::enable_if&lt; std::is_integral&lt; T &gt;::value, RCP&lt; const Integer &gt; &gt;::type integer(T i)</div><div class="ttdef"><b>Definition:</b> <a href="integer_8h_source.html#l00197">integer.h:197</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a20b4c6e1fb93393611e75807245f6a9b"><div class="ttname"><a href="namespaceSymEngine.html#a20b4c6e1fb93393611e75807245f6a9b">SymEngine::prime_factor_multiplicities</a></div><div class="ttdeci">void prime_factor_multiplicities(map_integer_uint &amp;primes_mul, const Integer &amp;n)</div><div class="ttdoc">Find multiplicities of prime factors of n</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00462">ntheory.cpp:462</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a2203e9e82d8b995e95ba5ce0efe5fe0c"><div class="ttname"><a href="namespaceSymEngine.html#a2203e9e82d8b995e95ba5ce0efe5fe0c">SymEngine::beta</a></div><div class="ttdeci">RCP&lt; const Basic &gt; beta(const RCP&lt; const Basic &gt; &amp;x, const RCP&lt; const Basic &gt; &amp;y)</div><div class="ttdoc">Canonicalize Beta:</div><div class="ttdef"><b>Definition:</b> <a href="functions_8cpp_source.html#l03283">functions.cpp:3283</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a23e7d19677dfaf17bce40fd767860bfd"><div class="ttname"><a href="namespaceSymEngine.html#a23e7d19677dfaf17bce40fd767860bfd">SymEngine::gcd</a></div><div class="ttdeci">RCP&lt; const Integer &gt; gcd(const Integer &amp;a, const Integer &amp;b)</div><div class="ttdoc">Greatest Common Divisor.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00032">ntheory.cpp:32</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a2586dc7e8e62544f230928bd693d3f01"><div class="ttname"><a href="namespaceSymEngine.html#a2586dc7e8e62544f230928bd693d3f01">SymEngine::nthroot_mod</a></div><div class="ttdeci">bool nthroot_mod(const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;root, const RCP&lt; const Integer &gt; &amp;a, const RCP&lt; const Integer &gt; &amp;n, const RCP&lt; const Integer &gt; &amp;mod)</div><div class="ttdoc">A solution to x**n == a mod m. Return false if none exists.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l01372">ntheory.cpp:1372</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a2628a45ea0c2c4bb536a594b34ad6e3d"><div class="ttname"><a href="namespaceSymEngine.html#a2628a45ea0c2c4bb536a594b34ad6e3d">SymEngine::primitive_root</a></div><div class="ttdeci">bool primitive_root(const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;g, const Integer &amp;n)</div><div class="ttdoc">Computes a primitive root. Returns false if no primitive root exists.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00681">ntheory.cpp:681</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a2cee70993b6160daf2870c1a5dc0a532"><div class="ttname"><a href="namespaceSymEngine.html#a2cee70993b6160daf2870c1a5dc0a532">SymEngine::mod</a></div><div class="ttdeci">RCP&lt; const Integer &gt; mod(const Integer &amp;n, const Integer &amp;d)</div><div class="ttdoc">modulo round toward zero</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00067">ntheory.cpp:67</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a310f9f699f41cff255e29fb6013e3f40"><div class="ttname"><a href="namespaceSymEngine.html#a310f9f699f41cff255e29fb6013e3f40">SymEngine::mobius</a></div><div class="ttdeci">int mobius(const Integer &amp;a)</div><div class="ttdoc">Mobius Function.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l01605">ntheory.cpp:1605</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a40dcbecd5d0d50dbd7d997a5c800ae81"><div class="ttname"><a href="namespaceSymEngine.html#a40dcbecd5d0d50dbd7d997a5c800ae81">SymEngine::lucas</a></div><div class="ttdeci">RCP&lt; const Integer &gt; lucas(unsigned long n)</div><div class="ttdoc">Lucas number.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00128">ntheory.cpp:128</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a450c28d700cf56dd4aae461c4ccdf602"><div class="ttname"><a href="namespaceSymEngine.html#a450c28d700cf56dd4aae461c4ccdf602">SymEngine::quotient_f</a></div><div class="ttdeci">RCP&lt; const Integer &gt; quotient_f(const Integer &amp;n, const Integer &amp;d)</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00094">ntheory.cpp:94</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a45dbcfb187e36f525090486594bea367"><div class="ttname"><a href="namespaceSymEngine.html#a45dbcfb187e36f525090486594bea367">SymEngine::nthroot_mod_list</a></div><div class="ttdeci">void nthroot_mod_list(std::vector&lt; RCP&lt; const Integer &gt;&gt; &amp;roots, const RCP&lt; const Integer &gt; &amp;a, const RCP&lt; const Integer &gt; &amp;n, const RCP&lt; const Integer &gt; &amp;m)</div><div class="ttdoc">All Solutions to x**n == a mod m. Return false if none exists.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l01402">ntheory.cpp:1402</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a4f08f9f6ba6fa0107e98940ca32249ca"><div class="ttname"><a href="namespaceSymEngine.html#a4f08f9f6ba6fa0107e98940ca32249ca">SymEngine::fibonacci</a></div><div class="ttdeci">RCP&lt; const Integer &gt; fibonacci(unsigned long n)</div><div class="ttdoc">Fibonacci number.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00111">ntheory.cpp:111</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a5427bd85fc080a17d0718a7d97353a49"><div class="ttname"><a href="namespaceSymEngine.html#a5427bd85fc080a17d0718a7d97353a49">SymEngine::gamma</a></div><div class="ttdeci">RCP&lt; const Basic &gt; gamma(const RCP&lt; const Basic &gt; &amp;arg)</div><div class="ttdoc">Canonicalize Gamma:</div><div class="ttdef"><b>Definition:</b> <a href="functions_8cpp_source.html#l03014">functions.cpp:3014</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a57af64eb932629159a77ed9f517bcfab"><div class="ttname"><a href="namespaceSymEngine.html#a57af64eb932629159a77ed9f517bcfab">SymEngine::is_quad_residue</a></div><div class="ttdeci">bool is_quad_residue(const Integer &amp;a, const Integer &amp;p)</div><div class="ttdoc">Returns true if 'a' is a quadratic residue of 'p'.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l01529">ntheory.cpp:1529</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a5ac9764d835e82d5fdd4ab4cc36e11e1"><div class="ttname"><a href="namespaceSymEngine.html#a5ac9764d835e82d5fdd4ab4cc36e11e1">SymEngine::mod_f</a></div><div class="ttdeci">RCP&lt; const Integer &gt; mod_f(const Integer &amp;n, const Integer &amp;d)</div><div class="ttdoc">modulo round toward -inf</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00087">ntheory.cpp:87</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a5c23fd54b05baea713287388f27dd7dc"><div class="ttname"><a href="namespaceSymEngine.html#a5c23fd54b05baea713287388f27dd7dc">SymEngine::quotient</a></div><div class="ttdeci">RCP&lt; const Integer &gt; quotient(const Integer &amp;n, const Integer &amp;d)</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00072">ntheory.cpp:72</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a6079112c36b3646e3a7f3cad0d31bc0b"><div class="ttname"><a href="namespaceSymEngine.html#a6079112c36b3646e3a7f3cad0d31bc0b">SymEngine::prime_factors</a></div><div class="ttdeci">void prime_factors(std::vector&lt; RCP&lt; const Integer &gt;&gt; &amp;prime_list, const Integer &amp;n)</div><div class="ttdoc">Find prime factors of n</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00432">ntheory.cpp:432</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a63b1ae053d374fb5602e1b03c236374c"><div class="ttname"><a href="namespaceSymEngine.html#a63b1ae053d374fb5602e1b03c236374c">SymEngine::mod_inverse</a></div><div class="ttdeci">int mod_inverse(const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;b, const Integer &amp;a, const Integer &amp;m)</div><div class="ttdoc">inverse modulo</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00057">ntheory.cpp:57</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a64d29f29e5080fa28f30bda2ae2464b9"><div class="ttname"><a href="namespaceSymEngine.html#a64d29f29e5080fa28f30bda2ae2464b9">SymEngine::quadratic_residues</a></div><div class="ttdeci">vec_integer_class quadratic_residues(const Integer &amp;a)</div><div class="ttdoc">Finds all Quadratic Residues of a Positive Integer.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l01504">ntheory.cpp:1504</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a6928d852848970a56a53e5f4482bf528"><div class="ttname"><a href="namespaceSymEngine.html#a6928d852848970a56a53e5f4482bf528">SymEngine::jacobi</a></div><div class="ttdeci">int jacobi(const Integer &amp;a, const Integer &amp;n)</div><div class="ttdoc">Jacobi Function.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00878">ntheory.cpp:878</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a6f8ad0107dc645c6ce7249c600385705"><div class="ttname"><a href="namespaceSymEngine.html#a6f8ad0107dc645c6ce7249c600385705">SymEngine::lcm</a></div><div class="ttdeci">RCP&lt; const Integer &gt; lcm(const Integer &amp;a, const Integer &amp;b)</div><div class="ttdoc">Least Common Multiple.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00050">ntheory.cpp:50</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a732c7e01c607133ae54abd236d22d302"><div class="ttname"><a href="namespaceSymEngine.html#a732c7e01c607133ae54abd236d22d302">SymEngine::binomial</a></div><div class="ttdeci">RCP&lt; const Integer &gt; binomial(const Integer &amp;n, unsigned long k)</div><div class="ttdoc">Binomial Coefficient.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00146">ntheory.cpp:146</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a78cd7d9fe5866ae1cf7f2adf78940c15"><div class="ttname"><a href="namespaceSymEngine.html#a78cd7d9fe5866ae1cf7f2adf78940c15">SymEngine::multiplicative_order</a></div><div class="ttdeci">bool multiplicative_order(const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;o, const RCP&lt; const Integer &gt; &amp;a, const RCP&lt; const Integer &gt; &amp;n)</div><div class="ttdoc">Multiplicative order. Return false if order does not exist.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00843">ntheory.cpp:843</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a88a7c4cbf086869ae2c0c4bc9d181787"><div class="ttname"><a href="namespaceSymEngine.html#a88a7c4cbf086869ae2c0c4bc9d181787">SymEngine::quotient_mod_f</a></div><div class="ttdeci">void quotient_mod_f(const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;q, const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;r, const Integer &amp;n, const Integer &amp;d)</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00101">ntheory.cpp:101</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a8a0fa36d4fbff063bb37b9893c4e6354"><div class="ttname"><a href="namespaceSymEngine.html#a8a0fa36d4fbff063bb37b9893c4e6354">SymEngine::insert</a></div><div class="ttdeci">void insert(T1 &amp;m, const T2 &amp;first, const T3 &amp;second)</div><div class="ttdef"><b>Definition:</b> <a href="dict_8h_source.html#l00083">dict.h:83</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a92cbc295ca4ec5d6b0b9ea4da2def010"><div class="ttname"><a href="namespaceSymEngine.html#a92cbc295ca4ec5d6b0b9ea4da2def010">SymEngine::mp_perfect_power_decomposition</a></div><div class="ttdeci">std::pair&lt; integer_class, integer_class &gt; mp_perfect_power_decomposition(const integer_class &amp;n, bool lowest_exponent)</div><div class="ttdoc">Decompose a positive integer into perfect powers.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l01677">ntheory.cpp:1677</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a969eb0905c46f6486a1b7437aa9d3d63"><div class="ttname"><a href="namespaceSymEngine.html#a969eb0905c46f6486a1b7437aa9d3d63">SymEngine::primitive_root_list</a></div><div class="ttdeci">void primitive_root_list(std::vector&lt; RCP&lt; const Integer &gt;&gt; &amp;roots, const Integer &amp;n)</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00765">ntheory.cpp:765</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_a9b0de2f5516a819ee48b54f78ab23804"><div class="ttname"><a href="namespaceSymEngine.html#a9b0de2f5516a819ee48b54f78ab23804">SymEngine::factor_trial_division</a></div><div class="ttdeci">int factor_trial_division(const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;f, const Integer &amp;n)</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00422">ntheory.cpp:422</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_aa62e9ba2232d0f8ec009f760cabf1451"><div class="ttname"><a href="namespaceSymEngine.html#aa62e9ba2232d0f8ec009f760cabf1451">SymEngine::factor_pollard_pm1_method</a></div><div class="ttdeci">int factor_pollard_pm1_method(const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;f, const Integer &amp;n, unsigned B, unsigned retries)</div><div class="ttdoc">Factor using Pollard's p-1 method.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00297">ntheory.cpp:297</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_aa6868f339e15596c02c68e1d02f0a461"><div class="ttname"><a href="namespaceSymEngine.html#aa6868f339e15596c02c68e1d02f0a461">SymEngine::probab_prime_p</a></div><div class="ttdeci">int probab_prime_p(const Integer &amp;a, unsigned reps)</div><div class="ttdoc">Probabilistic Prime.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00168">ntheory.cpp:168</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_aa9a8ead88fadfd214371b73a3a0f34fb"><div class="ttname"><a href="namespaceSymEngine.html#aa9a8ead88fadfd214371b73a3a0f34fb">SymEngine::log</a></div><div class="ttdeci">RCP&lt; const Basic &gt; log(const RCP&lt; const Basic &gt; &amp;arg)</div><div class="ttdoc">Returns the Natural Logarithm from argument arg</div><div class="ttdef"><b>Definition:</b> <a href="functions_8cpp_source.html#l01774">functions.cpp:1774</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_aaaad36e43b863bfbad83ed2d98f01992"><div class="ttname"><a href="namespaceSymEngine.html#aaaad36e43b863bfbad83ed2d98f01992">SymEngine::totient</a></div><div class="ttdeci">RCP&lt; const Integer &gt; totient(const RCP&lt; const Integer &gt; &amp;n)</div><div class="ttdoc">Euler's totient function.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00793">ntheory.cpp:793</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_aab51c36e32ea0584604a1195a85fe6de"><div class="ttname"><a href="namespaceSymEngine.html#aab51c36e32ea0584604a1195a85fe6de">SymEngine::is_nth_residue</a></div><div class="ttdeci">bool is_nth_residue(const Integer &amp;a, const Integer &amp;n, const Integer &amp;mod)</div><div class="ttdoc">Returns true if 'a' is a nth power residue of 'mod'.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l01573">ntheory.cpp:1573</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_aacc34ee92ca82122fd45ca21233dcd7c"><div class="ttname"><a href="namespaceSymEngine.html#aacc34ee92ca82122fd45ca21233dcd7c">SymEngine::factor_pollard_rho_method</a></div><div class="ttdeci">int factor_pollard_rho_method(const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;f, const Integer &amp;n, unsigned retries)</div><div class="ttdoc">Factor using Pollard's rho methods.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00349">ntheory.cpp:349</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_aad612bc5c47da71cc70cfb11b5ef6344"><div class="ttname"><a href="namespaceSymEngine.html#aad612bc5c47da71cc70cfb11b5ef6344">SymEngine::crt</a></div><div class="ttdeci">bool crt(const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;R, const std::vector&lt; RCP&lt; const Integer &gt;&gt; &amp;rem, const std::vector&lt; RCP&lt; const Integer &gt;&gt; &amp;mod)</div><div class="ttdoc">Chinese remainder function. Return true when a solution exists.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00553">ntheory.cpp:553</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_aaf56a84de825e1940da213fd1ae6ff65"><div class="ttname"><a href="namespaceSymEngine.html#aaf56a84de825e1940da213fd1ae6ff65">SymEngine::factor</a></div><div class="ttdeci">int factor(const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;f, const Integer &amp;n, double B1)</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00371">ntheory.cpp:371</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_ab01d70c771fdccc3c700fcd579272282"><div class="ttname"><a href="namespaceSymEngine.html#ab01d70c771fdccc3c700fcd579272282">SymEngine::factorial</a></div><div class="ttdeci">RCP&lt; const Integer &gt; factorial(unsigned long n)</div><div class="ttdoc">Factorial.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00154">ntheory.cpp:154</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_ab6a14bcfb29bbbda65be7ac9bd75083d"><div class="ttname"><a href="namespaceSymEngine.html#ab6a14bcfb29bbbda65be7ac9bd75083d">SymEngine::carmichael</a></div><div class="ttdeci">RCP&lt; const Integer &gt; carmichael(const RCP&lt; const Integer &gt; &amp;n)</div><div class="ttdoc">Carmichael function.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00813">ntheory.cpp:813</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_abb07748aa4b318e5fb3cfc942dc7dafa"><div class="ttname"><a href="namespaceSymEngine.html#abb07748aa4b318e5fb3cfc942dc7dafa">SymEngine::gcd_ext</a></div><div class="ttdeci">void gcd_ext(const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;g, const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;s, const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;t, const Integer &amp;a, const Integer &amp;b)</div><div class="ttdoc">Extended GCD.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00039">ntheory.cpp:39</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_abcb2e3a9648b190ce406481f00c46121"><div class="ttname"><a href="namespaceSymEngine.html#abcb2e3a9648b190ce406481f00c46121">SymEngine::mp_principal_polygonal_root</a></div><div class="ttdeci">integer_class mp_principal_polygonal_root(const integer_class &amp;s, const integer_class &amp;x)</div><div class="ttdoc">Numeric calculation of the principal s-gonal root of x.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l01666">ntheory.cpp:1666</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_ac1ca4e052e1ed84f11dd83c9b32f547e"><div class="ttname"><a href="namespaceSymEngine.html#ac1ca4e052e1ed84f11dd83c9b32f547e">SymEngine::powermod_list</a></div><div class="ttdeci">void powermod_list(std::vector&lt; RCP&lt; const Integer &gt;&gt; &amp;pows, const RCP&lt; const Integer &gt; &amp;a, const RCP&lt; const Number &gt; &amp;b, const RCP&lt; const Integer &gt; &amp;m)</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l01469">ntheory.cpp:1469</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_ac68c11cddc00aaff59929b12e4f3cc8a"><div class="ttname"><a href="namespaceSymEngine.html#ac68c11cddc00aaff59929b12e4f3cc8a">SymEngine::bernoulli</a></div><div class="ttdeci">RCP&lt; const Number &gt; bernoulli(unsigned long n)</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00496">ntheory.cpp:496</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_acde8c189ba1160ef22f427dec4701ded"><div class="ttname"><a href="namespaceSymEngine.html#acde8c189ba1160ef22f427dec4701ded">SymEngine::quotient_mod</a></div><div class="ttdeci">void quotient_mod(const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;q, const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;r, const Integer &amp;n, const Integer &amp;d)</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00077">ntheory.cpp:77</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_ad78c8d7a599848f762f200bbe99f087e"><div class="ttname"><a href="namespaceSymEngine.html#ad78c8d7a599848f762f200bbe99f087e">SymEngine::legendre</a></div><div class="ttdeci">int legendre(const Integer &amp;a, const Integer &amp;n)</div><div class="ttdoc">Legendre Function.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00873">ntheory.cpp:873</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_addac89ed5ce6ed7617f90f7473a91214"><div class="ttname"><a href="namespaceSymEngine.html#addac89ed5ce6ed7617f90f7473a91214">SymEngine::harmonic</a></div><div class="ttdeci">RCP&lt; const Number &gt; harmonic(unsigned long n, long m)</div><div class="ttdoc">Computes the sum of the inverses of the first perfect mth powers.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00523">ntheory.cpp:523</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_adeea01ccd116f965ae18ccc76e43f7b7"><div class="ttname"><a href="namespaceSymEngine.html#adeea01ccd116f965ae18ccc76e43f7b7">SymEngine::factor_lehman_method</a></div><div class="ttdeci">int factor_lehman_method(const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;f, const Integer &amp;n)</div><div class="ttdoc">Factor using lehman's methods.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00254">ntheory.cpp:254</a></div></div>
<div class="ttc" id="anamespaceSymEngine_html_aff0d65ef819e6ee1328757e4acf3fb1e"><div class="ttname"><a href="namespaceSymEngine.html#aff0d65ef819e6ee1328757e4acf3fb1e">SymEngine::lucas2</a></div><div class="ttdeci">void lucas2(const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;g, const Ptr&lt; RCP&lt; const Integer &gt;&gt; &amp;s, unsigned long n)</div><div class="ttdoc">Lucas number n and n-1.</div><div class="ttdef"><b>Definition:</b> <a href="ntheory_8cpp_source.html#l00135">ntheory.cpp:135</a></div></div>
<div class="ttc" id="antheory_8h_html"><div class="ttname"><a href="ntheory_8h.html">ntheory.h</a></div></div>
<div class="ttc" id="apow_8h_html"><div class="ttname"><a href="pow_8h.html">pow.h</a></div></div>
<div class="ttc" id="arational_8h_html"><div class="ttname"><a href="rational_8h.html">rational.h</a></div></div>
<div class="ttc" id="astructSymEngine_1_1RCPIntegerKeyLess_html"><div class="ttname"><a href="structSymEngine_1_1RCPIntegerKeyLess.html">SymEngine::RCPIntegerKeyLess</a></div><div class="ttdoc">less operator (&lt;) for Integers</div><div class="ttdef"><b>Definition:</b> <a href="integer_8h_source.html#l00185">integer.h:185</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- Copyright 2020 Rohit Goswami <rog32@hi.is>
     Licensed under the Apache License, Version 2.0 (the "License");
     you may not use this file except in compliance with the License.
     You may obtain a copy of the License at
     http://www.apache.org/licenses/LICENSE-2.0
     Unless required by applicable law or agreed to in writing, software
     distributed under the License is distributed on an "AS IS" BASIS,
     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     See the License for the specific language governing permissions and
     limitations under the License. -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div class="footer">
<hr class="footline"/><address class="footline"><small>
    Generated by&#160;<a href="https://www.doxygen.org/index.html">Doxygen 1.9.1</a> and the <a class="outlink" href="https://github.com/HaoZeke/doxyYoda">doxyYoda theme</a>
</small></address>
</div>
</div>
</body>
</html>
